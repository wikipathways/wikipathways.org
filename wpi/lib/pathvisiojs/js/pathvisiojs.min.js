function RGBColor(a){a=a.toString(),this.ok=!1,"#"==a.charAt(0)&&(a=a.substr(1,6)),a=a.replace(/ /g,""),a=a.toLowerCase();var b={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var c in b)a==c&&(a=b[c]);for(var d=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],e=0;e<d.length;e++){var f=d[e].re,g=d[e].process,h=f.exec(a);h&&(channels=g(h),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);return 1==a.length&&(a="0"+a),1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),"#"+a+b+c},this.getHelpXML=function(){for(var a=new Array,c=0;c<d.length;c++)for(var e=d[c].example,f=0;f<e.length;f++)a[a.length]=e[f];for(var g in b)a[a.length]=g;var h=document.createElement("ul");h.setAttribute("id","rgbcolor-examples");for(var c=0;c<a.length;c++)try{var i=document.createElement("li"),j=new RGBColor(a[c]),k=document.createElement("div");k.style.cssText="margin: 3px; border: 1px solid black; background:"+j.toHex()+"; color:"+j.toHex(),k.appendChild(document.createTextNode("test"));var l=document.createTextNode(" "+a[c]+" -> "+j.toRGB()+" -> "+j.toHex());i.appendChild(k),i.appendChild(l),h.appendChild(i)}catch(m){}return h}}!function(a){"function"==typeof define?define(a):"function"==typeof YUI?YUI.add("es5-sham",a):a()}(function(){function a(a){try{return a.sentinel=0,0===Object.getOwnPropertyDescriptor(a,"sentinel").value}catch(b){}}function b(a){try{return Object.defineProperty(a,"sentinel",{}),"sentinel"in a}catch(b){}}var c,d,e,f,g,h=Function.prototype.call,i=Object.prototype,j=h.bind(i.hasOwnProperty);if((g=j(i,"__defineGetter__"))&&(c=h.bind(i.__defineGetter__),d=h.bind(i.__defineSetter__),e=h.bind(i.__lookupGetter__),f=h.bind(i.__lookupSetter__)),Object.getPrototypeOf||(Object.getPrototypeOf=function(a){return a.__proto__||(a.constructor?a.constructor.prototype:i)}),Object.defineProperty){var k=a({}),l="undefined"==typeof document||a(document.createElement("div"));if(!l||!k)var m=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||m){var n="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(a,b){if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError(n+a);if(m)try{return m.call(Object,a,b)}catch(c){}if(j(a,b)){var d={enumerable:!0,configurable:!0};if(g){var h=a.__proto__;a.__proto__=i;var k=e(a,b),l=f(a,b);if(a.__proto__=h,k||l)return k&&(d.get=k),l&&(d.set=l),d}return d.value=a[b],d.writable=!0,d}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(a){return Object.keys(a)}),!Object.create){var o,p=null===Object.prototype.__proto__;o=p||"undefined"==typeof document?function(){return{__proto__:null}}:function(){function a(){}var b=document.createElement("iframe"),c=document.body||document.documentElement;b.style.display="none",c.appendChild(b),b.src="javascript:";var d=b.contentWindow.Object.prototype;return c.removeChild(b),b=null,delete d.constructor,delete d.hasOwnProperty,delete d.propertyIsEnumerable,delete d.isPrototypeOf,delete d.toLocaleString,delete d.toString,delete d.valueOf,d.__proto__=null,a.prototype=d,o=function(){return new a},new a},Object.create=function(a,b){function c(){}var d;if(null===a)d=o();else{if("object"!=typeof a&&"function"!=typeof a)throw new TypeError("Object prototype may only be an Object or null");c.prototype=a,d=new c,d.__proto__=a}return void 0!==b&&Object.defineProperties(d,b),d}}if(Object.defineProperty){var q=b({}),r="undefined"==typeof document||b(document.createElement("div"));if(!q||!r)var s=Object.defineProperty,t=Object.defineProperties}if(!Object.defineProperty||s){var u="Property description must be an object: ",v="Object.defineProperty called on non-object: ",w="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(a,b,h){if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError(v+a);if("object"!=typeof h&&"function"!=typeof h||null===h)throw new TypeError(u+h);if(s)try{return s.call(Object,a,b,h)}catch(k){}if(j(h,"value"))if(g&&(e(a,b)||f(a,b))){var l=a.__proto__;a.__proto__=i,delete a[b],a[b]=h.value,a.__proto__=l}else a[b]=h.value;else{if(!g)throw new TypeError(w);j(h,"get")&&c(a,b,h.get),j(h,"set")&&d(a,b,h.set)}return a}}(!Object.defineProperties||t)&&(Object.defineProperties=function(a,b){if(t)try{return t.call(Object,a,b)}catch(c){}for(var d in b)j(b,d)&&"__proto__"!=d&&Object.defineProperty(a,d,b[d]);return a}),Object.seal||(Object.seal=function(a){return a}),Object.freeze||(Object.freeze=function(a){return a});try{Object.freeze(function(){})}catch(x){Object.freeze=function(a){return function(b){return"function"==typeof b?b:a(b)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(a){return a}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(a){if(Object(a)!==a)throw new TypeError;for(var b="";j(a,b);)b+="?";a[b]=!0;var c=j(a,b);return delete a[b],c})}),function(){function a(a,b,c){var d=b&&c||0,e=0;for(b=b||[],a.toLowerCase().replace(/[0-9a-f]{2}/g,function(a){16>e&&(b[d+e++]=m[a])});16>e;)b[d+e++]=0;return b}function b(a,b){var c=b||0,d=l;return d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]}function c(a,c,d){var e=c&&d||0,f=c||[];a=a||{};var g=null!=a.clockseq?a.clockseq:q,h=null!=a.msecs?a.msecs:(new Date).getTime(),i=null!=a.nsecs?a.nsecs:s+1,j=h-r+(i-s)/1e4;if(0>j&&null==a.clockseq&&(g=g+1&16383),(0>j||h>r)&&null==a.nsecs&&(i=0),i>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");r=h,s=i,q=g,h+=122192928e5;var k=(1e4*(268435455&h)+i)%4294967296;f[e++]=k>>>24&255,f[e++]=k>>>16&255,f[e++]=k>>>8&255,f[e++]=255&k;var l=h/4294967296*1e4&268435455;f[e++]=l>>>8&255,f[e++]=255&l,f[e++]=l>>>24&15|16,f[e++]=l>>>16&255,f[e++]=g>>>8|128,f[e++]=255&g;for(var m=a.node||p,n=0;6>n;n++)f[e+n]=m[n];return c?c:b(f)}function d(a,c,d){var f=c&&d||0;"string"==typeof a&&(c="binary"==a?new k(16):null,a=null),a=a||{};var g=a.random||(a.rng||e)();if(g[6]=15&g[6]|64,g[8]=63&g[8]|128,c)for(var h=0;16>h;h++)c[f+h]=g[h];return c||b(g)}var e,f=this;if("function"==typeof require)try{var g=require("crypto").randomBytes;e=g&&function(){return g(16)}}catch(h){}if(!e&&f.crypto&&crypto.getRandomValues){var i=new Uint8Array(16);e=function(){return crypto.getRandomValues(i),i}}if(!e){var j=new Array(16);e=function(){for(var a,b=0;16>b;b++)0===(3&b)&&(a=4294967296*Math.random()),j[b]=a>>>((3&b)<<3)&255;return j}}for(var k="function"==typeof Buffer?Buffer:Array,l=[],m={},n=0;256>n;n++)l[n]=(n+256).toString(16).substr(1),m[l[n]]=n;var o=e(),p=[1|o[0],o[1],o[2],o[3],o[4],o[5]],q=16383&(o[6]<<8|o[7]),r=0,s=0,t=d;if(t.v1=c,t.v4=d,t.parse=a,t.unparse=b,t.BufferClass=k,"function"==typeof define&&define.amd)define(function(){return t});else if("undefined"!=typeof module&&module.exports)module.exports=t;else{var u=f.uuid;t.noConflict=function(){return f.uuid=u,t},f.uuid=t}}.call(this),!function(a){"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd?define(a):"undefined"!=typeof window?window.strcase=a():"undefined"!=typeof global?global.strcase=a():"undefined"!=typeof self&&(self.strcase=a())}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){c.dotCase=function(a){return c.separatorCase(a,".")},c.classCase=function(a){return c.separatorCase(a,"_").replace(/(?:^|_|\-|\/)(.)/g,function(a,b){return b.toUpperCase()})},c.namespaceCase=function(a){return c.separatorCase(a,".").replace(/(^|_|\.|\-|\/)(.)/g,function(a,b,c){return b+c.toUpperCase()})},c.constantCase=function(a){return c.separatorCase(a,"_").replace(/[a-z]/g,function(a){return a.toUpperCase()})},c.camelCase=function(a){return c.separatorCase(a,"_").replace(/[-_\.\/\s]+(.)?/g,function(a,b){return b.toUpperCase()})},c.titleCase=function(a){return c.separatorCase(a," ").replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()})},c.snakeCase=function(a){return c.separatorCase(a,"_")},c.pathCase=function(a){return this.separatorCase(a,"/")},c.paramCase=function(a){return this.separatorCase(a,"-")},c.separatorCase=function(a,b){return c.clean(c.trim(a),b).replace(/([a-z\d])([A-Z]+)/g,"$1"+b+"$2").replace(/(([A-Z])(?=[A-Z][a-z]))/g,"$1"+b).replace(/(([a-z])(?=[A-Z][a-z]))/g,"$1"+b).replace(/[-\.\/\_\s]+/g,b).toLowerCase()},c.clean=function(a,b){return a.replace(/\W+/g,b||" ")},c.trim=function(a){return a.replace(/^\W+|\W+$/g,"")}},{}]},{},[1])(1)});var crossPlatformText={init:function(a,b){var c=this;this.svg.crossPlatformTextInstance=this;var d,e=a.targetSelector,f=document.querySelector(e),g=f.tagName.toLowerCase(),h=d3.select(f),i=["div","section","p"];i.indexOf(this.targetTagName)>-1?(d=a.format,this[d].targetSelection=h,this.setFormat(d,g,h),c[d].init(a,function(a){b&&b(a)})):(d=g,this[d].targetImageSelection=h,this.setFormat(d,g,h),this[d].init(a,function(a){b&&b(a)}))},convertToPx:function(a,b){var c,d;return pathvisiojs.utilities.isNumber(a)?d=a:(c=a.toLowerCase(),d=c.indexOf("em")>-1?c.slice(0,c.length-2)*b:c.indexOf("px")>-1?c.slice(0,c.length-2):c.indexOf("pt")>-1?c.slice(0,c.length-2)*(4/3):c.indexOf("%")>-1?c.slice(0,c.length-1)/100*b:a),d},setFormat:function(a,b){this[a].targetTagName=b,this.render=this[a].render}};crossPlatformText.svg={init:function(a,b){var c;if(this.targetImageSelection)targetImageSelection=this.targetImageSelection,c=targetImageSelection.select("#viewport"),c[0][0]||(c=targetImageSelection.select("g"));else{var d=args.id||"cross-platform-text-svg";targetImageSelection=this.targetSelection.append("svg").attr("id",d).attr("version","1.1").attr("baseProfile","full").attr("xmlns","http://www.w3.org/1999/xlink").attr("xmlns:xmlns:xlink","http://www.w3.org/1999/xlink").attr("xmlns:xmlns:ev","http://www.w3.org/2001/xml-events").attr("preserveAspectRatio","xMidYMid").attr("width",width).attr("height",height),c=targetImageSelection.append("g").attr("id","viewport")}b&&b(c)},render:function(a,b){var c=(this.crossPlatformTextInstance,["fontSize"]),d=a.textContent.split(/\r\n|\r|\n|&#xA;/g),e=d.length,f=a.padding||0,g=a.width,h=a.height,i=a.fontSize,j=crossPlatformText.convertToPx(f,i);i=crossPlatformText.convertToPx(i,i);var k;"left"===a.textAlign?(k="start",textAlignXTranslation=j):"right"===a.textAlign?(k="end",textAlignXTranslation=g-j):(k="middle",textAlignXTranslation=g/2);var l,m=a.x+textAlignXTranslation,n=1.1*(e-1)*i;l="top"===a.verticalAlign?j+n/2+i*(2/3):"bottom"===a.verticalAlign?h-j-n/2-i*(2/3):h/2;var o=a.y+l,p="translate("+m+" "+o+")",q=targetImageSelection.select(a.containerSelector).append("g").attr("transform",p),r=(q.selectAll("text").data(d).enter().append("text").attr("id",function(a,b){return"text-line"+b}).attr("x",0).attr("y",function(a,b){return 1.1*(b-(e-1)/2)+"em"}).attr("dominant-baseline","central").attr("text-anchor",k).text(function(a){return a}),{}),s=[];r.elementName="g";var t=a.backgroundColor||"transparent";s.push({name:"fill",value:t});var u,v,w={color:function(a){q.attr("fill",a)},id:function(a){q.attr("id","text-for-"+a)},fill:function(a){q.attr("fill",a)},fillOpacity:function(a){q.attr("fill-opacity",a)},fontFamily:function(a){q.attr("font-family",a)},fontSize:function(a){q.attr("font-size",a)},fontStyle:function(a){q.attr("font-style",a)},fontWeight:function(a){q.attr("font-weight",a)},rotation:function(a){p+=" rotate("+a+","+(g/2-textAlignXTranslation)+","+(h/2-l)+")",q.attr("transform",p)}},x=d3.map(a).entries().sort(function(a,b){return c.indexOf(a.key)-c.indexOf(b.key)});x.forEach(function(a){u=a.key,v=a.value,w.hasOwnProperty(u)&&w[u](v)}),b&&b(q[0][0])}},crossPlatformText.canvas={};var crossPlatformShapesNS=crossPlatformShapesNS||{};crossPlatformShapesNS["markers.svg"]='<svg id="markers" version="1.1" baseProfile="full" xmlns="http://www.w3.org/1999/xlink" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events" preserveAspectRatio="xMidYMid">\n<g>\n<desc>This SVG file contains a set of markers that can be duplicated for other colors.</desc>\n</g>\n<title>markers</title>\n<defs>\n<marker id="shape-library-markers-arrow-svg-start-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0" refY="6"><g id="g-src-shape-library-markers-arrow-svg-start-default" class="solid-stroke default-fill-color">\n\n	<!-- arrow markers: triangular polygons, no stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<polygon stroke-width="0" points="12,11 0,6 12,1"></polygon>\n\n</g></marker>\n<marker id="shape-library-markers-arrow-svg-end-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="12" refY="6"><g id="g-src-shape-library-markers-arrow-svg-end-default" class="solid-stroke default-fill-color" transform="rotate(180, 6, 6)">\n\n	<!-- arrow markers: triangular polygons, no stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<polygon stroke-width="0" points="12,11 0,6 12,1"></polygon>\n\n</g></marker>\n<marker id="shape-library-markers-mim-necessary-stimulation-svg-start-default" preserveAspectRatio="none" viewBox="0 0 16 12" markerWidth="16" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0" refY="6">\n<g id="g-src-shape-library-markers-mim-necessary-stimulation-svg-start-default" class="board-fill-color default-stroke-color solid-stroke">\n\n	<!-- mim-necessary-stimulation markers: triangular polygons, drawing-board fill, default color stroke; and vertical line -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<line fill="none" stroke-width="1" x1="14" y1="0" x2="14" y2="12"></line>\n	<line fill="none" stroke="none" x1="16" y1="6" x2="16" y2="6"></line> <!-- dummy point -->\n	<polygon stroke-width="1" points="0,6 9,11 9,1"></polygon>\n\n</g></marker>\n<marker id="shape-library-markers-mim-necessary-stimulation-svg-end-default" preserveAspectRatio="none" viewBox="0 0 16 12" markerWidth="16" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="16" refY="6"><g id="g-src-shape-library-markers-mim-necessary-stimulation-svg-end-default" class="board-fill-color default-stroke-color solid-stroke" transform="rotate(180, 8, 6)">\n\n	<!-- mim-necessary-stimulation markers: triangular polygons, drawing-board fill, default color stroke; and vertical line -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<line fill="none" stroke-width="1" x1="14" y1="0" x2="14" y2="12"></line>\n	<line fill="none" stroke="none" x1="16" y1="6" x2="16" y2="6"></line> <!-- dummy point -->\n	<polygon stroke-width="1" points="0,6 9,11 9,1"></polygon>\n\n</g></marker>\n<marker id="shape-library-markers-mim-binding-svg-start-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0" refY="6"><g id="g-src-shape-library-markers-mim-binding-svg-start-default" class="solid-stroke default-fill-color">\n\n	<!-- mim-binding markers: four-point polygon, no stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<polygon stroke-width="0" points="12,12 0,6 12,0 5,6 "></polygon>\n\n</g></marker>\n<marker id="shape-library-markers-mim-binding-svg-end-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="12" refY="6"><g id="g-src-shape-library-markers-mim-binding-svg-end-default" class="solid-stroke default-fill-color" transform="rotate(180, 6, 6)">\n\n	<!-- mim-binding markers: four-point polygon, no stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<polygon stroke-width="0" points="12,12 0,6 12,0 5,6 "></polygon>\n\n</g></marker>\n<marker id="shape-library-markers-mim-conversion-svg-start-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0" refY="6"><g id="g-src-shape-library-markers-mim-conversion-svg-start-default" class="solid-stroke default-fill-color">\n\n	<!-- mim-conversion markers: triangular polygons, no stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<polygon stroke-width="0" points="12,11 0,6 12,1"></polygon>\n\n</g></marker>\n<marker id="shape-library-markers-mim-conversion-svg-end-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="12" refY="6"><g id="g-src-shape-library-markers-mim-conversion-svg-end-default" class="solid-stroke default-fill-color" transform="rotate(180, 6, 6)">\n\n	<!-- mim-conversion markers: triangular polygons, no stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<polygon stroke-width="0" points="12,11 0,6 12,1"></polygon>\n\n</g></marker>\n<marker id="shape-library-markers-mim-stimulation-svg-start-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0" refY="6"><g id="g-src-shape-library-markers-mim-stimulation-svg-start-default" class="board-fill-color default-stroke-color solid-stroke">\n\n	<!-- mim-stimulation markers: triangular polygons, drawing-board fill, default color stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<line stroke="none" fill="none" x1="12" y1="6" x2="12" y2="6"></line> <!-- dummy point -->\n	<polygon stroke-width="1" points="0,6 11,11 11,1"></polygon>\n\n</g></marker><marker id="shape-library-markers-mim-stimulation-svg-end-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="12" refY="6"><g id="g-src-shape-library-markers-mim-stimulation-svg-end-default" class="board-fill-color default-stroke-color solid-stroke" transform="rotate(180, 6, 6)">\n\n	<!-- mim-stimulation markers: triangular polygons, drawing-board fill, default color stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<line stroke="none" fill="none" x1="12" y1="6" x2="12" y2="6"></line> <!-- dummy point -->\n	<polygon stroke-width="1" points="0,6 11,11 11,1"></polygon>\n\n</g></marker><marker id="shape-library-markers-mim-modification-svg-start-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0" refY="6"><g id="g-src-shape-library-markers-mim-modification-svg-start-default" class="default-fill-color solid-stroke">\n\n	<!-- mim-modification markers: four-point polygon, no stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<polygon stroke-width="0" points="12,12 0,6 12,0 5,6 "></polygon>\n\n</g></marker><marker id="shape-library-markers-mim-modification-svg-end-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="12" refY="6"><g id="g-src-shape-library-markers-mim-modification-svg-end-default" class="default-fill-color solid-stroke" transform="rotate(180, 6, 6)">\n\n	<!-- mim-modification markers: four-point polygon, no stroke -->\n\n	<rect class="board-fill-color" stroke="none" x="0" y="5.4" width="2" height="1.2"></rect>\n	<polygon stroke-width="0" points="12,12 0,6 12,0 5,6 "></polygon>\n\n</g></marker><marker id="shape-library-markers-mim-catalysis-svg-start-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0" refY="6"><g id="g-src-shape-library-markers-mim-catalysis-svg-start-default" class="board-fill-color default-stroke-color solid-stroke">\n\n	<!-- mim-catalysis markers: circle, drawing-board fill and default color stroke -->\n\n	<circle cx="6.0" cy="6" r="5.3px" stroke-width="1px"></circle>\n\n</g></marker><marker id="shape-library-markers-mim-catalysis-svg-end-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="12" refY="6"><g id="g-src-shape-library-markers-mim-catalysis-svg-end-default" class="board-fill-color default-stroke-color solid-stroke" transform="rotate(180, 6, 6)">\n\n	<!-- mim-catalysis markers: circle, drawing-board fill and default color stroke -->\n\n	<circle cx="6.0" cy="6" r="5.3px" stroke-width="1px"></circle>\n\n</g></marker><marker id="shape-library-markers-mim-inhibition-svg-start-default" preserveAspectRatio="none" viewBox="0 0 10 20" markerWidth="10" markerHeight="20" markerUnits="strokeWidth" orient="auto" refX="0" refY="10"><g id="g-src-shape-library-markers-mim-inhibition-svg-start-default" class="board-fill-color default-stroke-color solid-stroke">\n\n	<!-- mim-inhibition markers: vertical line; and extended drawing-board rect -->\n	\n	<rect stroke="none" x="0" y="9" width="8" height="2"></rect>\n	<line fill="none" stroke-width="1.8" x1="7" y1="0" x2="7" y2="20"></line>\n\n</g></marker><marker id="shape-library-markers-mim-inhibition-svg-end-default" preserveAspectRatio="none" viewBox="0 0 10 20" markerWidth="10" markerHeight="20" markerUnits="strokeWidth" orient="auto" refX="10" refY="10"><g id="g-src-shape-library-markers-mim-inhibition-svg-end-default" class="board-fill-color default-stroke-color solid-stroke" transform="rotate(180, 5, 10)">\n\n	<!-- mim-inhibition markers: vertical line; and extended drawing-board rect -->\n	\n	<rect stroke="none" x="0" y="9" width="8" height="2"></rect>\n	<line fill="none" stroke-width="1.8" x1="7" y1="0" x2="7" y2="20"></line>\n\n</g></marker><marker id="shape-library-markers-mim-cleavage-svg-start-default" preserveAspectRatio="none" viewBox="0 0 20 30" markerWidth="20" markerHeight="30" markerUnits="strokeWidth" orient="auto" refX="9" refY="15"><g id="g-src-shape-library-markers-mim-cleavage-svg-start-default" class="board-fill-color default-stroke-color solid-stroke">\n\n	<!-- mim-cleavage markers: two lines and extended drawing-board rect -->\n\n	<rect stroke="none" x="0" y="14.3" width="18.4" height="1.4"></rect>\n	<line fill="none" stroke-width="1" x1="18" y1="14.5" x2="18" y2="30"></line>	\n	<line fill="none" stroke-width="1" x1="18" y1="30" x2="0" y2="0"></line>	\n\n\n</g></marker><marker id="shape-library-markers-mim-cleavage-svg-end-default" preserveAspectRatio="none" viewBox="0 0 20 30" markerWidth="20" markerHeight="30" markerUnits="strokeWidth" orient="auto" refX="10" refY="15"><g id="g-src-shape-library-markers-mim-cleavage-svg-end-default" class="board-fill-color default-stroke-color solid-stroke" transform="rotate(180, 10, 15)">\n\n	<!-- mim-cleavage markers: two lines and extended drawing-board rect -->\n\n	<rect stroke="none" x="0" y="14.3" width="18.4" height="1.4"></rect>\n	<line fill="none" stroke-width="1" x1="18" y1="14.5" x2="18" y2="30"></line>	\n	<line fill="none" stroke-width="1" x1="18" y1="30" x2="0" y2="0"></line>	\n\n\n</g></marker><marker id="shape-library-markers-mim-covalent-bond-svg-start-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="-0.5" refY="6"><g id="g-src-shape-library-markers-mim-covalent-bond-svg-start-default" class="solid-stroke default-fill-color">\n\n	<!-- mim-covalent-bond markers: not much to see here! -->\n	<rect x="0" y="0" width="0" height="0" stroke="none" fill="none" stroke-width="0"></rect>\n\n</g></marker><marker id="shape-library-markers-mim-covalent-bond-svg-end-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="11" refY="6"><g id="g-src-shape-library-markers-mim-covalent-bond-svg-end-default" class="solid-stroke default-fill-color" transform="rotate(180, 6, 6)">\n\n	<!-- mim-covalent-bond markers: not much to see here! -->\n	<rect x="0" y="0" width="0" height="0" stroke="none" fill="none" stroke-width="0"></rect>\n\n</g></marker><marker id="shape-library-markers-mim-transcription-translation-svg-start-default" preserveAspectRatio="none" viewBox="0 0 20 24" markerWidth="20" markerHeight="24" markerUnits="strokeWidth" orient="auto" refX="0" refY="12"><g id="g-src-shape-library-markers-mim-transcription-translation-svg-start-default" class="board-fill-color default-stroke-color solid-stroke">\n\n	<!-- mim-transcription-translation markers: two lines and an open trigular polygon, plus extended drawing-board rect -->\n\n	<rect stroke="none" x="0" y="11" width="12" height="2"></rect>\n	<line fill="none" stroke-width="1" x1="15" y1="12" x2="15" y2="5"></line>\n	<line fill="none" stroke-width="1" x1="15.5" y1="5" x2="8" y2="5"></line>\n	<polygon stroke-width="1" points="0,5 8,1 8,9"></polygon>\n\n</g></marker><marker id="shape-library-markers-mim-transcription-translation-svg-end-default" preserveAspectRatio="none" viewBox="0 0 20 24" markerWidth="20" markerHeight="24" markerUnits="strokeWidth" orient="auto" refX="20" refY="12"><g id="g-src-shape-library-markers-mim-transcription-translation-svg-end-default" class="board-fill-color default-stroke-color solid-stroke" transform="rotate(180, 10, 12)">\n\n	<!-- mim-transcription-translation markers: two lines and an open trigular polygon, plus extended drawing-board rect -->\n\n	<rect stroke="none" x="0" y="11" width="12" height="2"></rect>\n	<line fill="none" stroke-width="1" x1="15" y1="12" x2="15" y2="5"></line>\n	<line fill="none" stroke-width="1" x1="15.5" y1="5" x2="8" y2="5"></line>\n	<polygon stroke-width="1" points="0,5 8,1 8,9"></polygon>\n\n</g></marker><marker id="shape-library-markers-mim-gap-svg-start-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0" refY="6"><g id="g-src-shape-library-markers-mim-gap-svg-start-default" class="board-fill-color solid-stroke">\n\n	<!-- mim-gap markers: just an extended drawing-board rect -->\n	<!-- \n	TODO This could be refactored to make the shape match the viewbox.\n	It can overlap the side of the shape, blanking out a small part of it when the edge is at an angle.\n	-->\n\n	<rect stroke="none" x="0" y="5.3" width="8" height="1.4"></rect>\n\n</g></marker><marker id="shape-library-markers-mim-gap-svg-end-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="12" refY="6"><g id="g-src-shape-library-markers-mim-gap-svg-end-default" class="board-fill-color solid-stroke" transform="rotate(180, 6, 6)">\n\n	<!-- mim-gap markers: just an extended drawing-board rect -->\n	<!-- \n	TODO This could be refactored to make the shape match the viewbox.\n	It can overlap the side of the shape, blanking out a small part of it when the edge is at an angle.\n	-->\n\n	<rect stroke="none" x="0" y="5.3" width="8" height="1.4"></rect>\n\n</g></marker><marker id="shape-library-markers-t-bar-svg-start-default" preserveAspectRatio="none" viewBox="0 0 10 20" markerWidth="10" markerHeight="20" markerUnits="strokeWidth" orient="auto" refX="0" refY="10"><g id="g-src-shape-library-markers-t-bar-svg-start-default" class="board-fill-color default-stroke-color solid-stroke">\n\n        <!-- t-bar markers: vertical line; and extended drawing-board rect -->\n	\n	<rect stroke="none" x="0" y="9" width="8" height="2"></rect>\n	<line fill="none" stroke-width="1.8" x1="7" y1="0" x2="7" y2="20"></line>\n\n</g></marker><marker id="shape-library-markers-t-bar-svg-end-default" preserveAspectRatio="none" viewBox="0 0 10 20" markerWidth="10" markerHeight="20" markerUnits="strokeWidth" orient="auto" refX="10" refY="10"><g id="g-src-shape-library-markers-t-bar-svg-end-default" class="board-fill-color default-stroke-color solid-stroke" transform="rotate(180, 5, 10)">\n\n        <!-- t-bar markers: vertical line; and extended drawing-board rect -->\n	\n	<rect stroke="none" x="0" y="9" width="8" height="2"></rect>\n	<line fill="none" stroke-width="1.8" x1="7" y1="0" x2="7" y2="20"></line>\n\n</g></marker><marker id="shape-library-markers-none-svg-start-default" preserveAspectRatio="none" viewBox="0 0 0 0" markerWidth="0" markerHeight="0" markerUnits="strokeWidth" orient="auto" refX="0" refY="6"><g id="g-src-shape-library-markers-none-svg-start-default" class="board-fill-color board-stroke-color node shape">\n\n	<rect x="0" y="0" width="0" height="0" stroke="none" fill="none" stroke-width="0"></rect>\n\n</g></marker><marker id="shape-library-markers-none-svg-end-default" preserveAspectRatio="none" viewBox="0 0 0 0" markerWidth="0" markerHeight="0" markerUnits="strokeWidth" orient="auto" refX="11" refY="6"><g id="g-src-shape-library-markers-none-svg-end-default" class="board-fill-color board-stroke-color node shape" transform="rotate(180, 0, 0)">\n\n	<rect x="0" y="0" width="0" height="0" stroke="none" fill="none" stroke-width="0"></rect>\n\n</g></marker><marker id="shape-library-markers-mim-branching-left-svg-start-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0.4" refY="6"><g id="g-src-shape-library-markers-mim-branching-left-svg-start-default" class="board-fill-color default-stroke-color solid-stroke">\n\n	<!-- mim-branching-left markers: line and extended drawing-board rect -->\n\n	<rect stroke="none" x="0.4" y="5.3" width="3.1" height="1.4"></rect>\n	<line fill="none" stroke-width="1" x1="3.9" y1="6.2" x2="0.2" y2="0"></line>	\n\n</g></marker><marker id="shape-library-markers-mim-branching-left-svg-end-default" preserveAspectRatio="none" viewBox="0 0 12 12" markerWidth="12" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="11.6" refY="6"><g id="g-src-shape-library-markers-mim-branching-left-svg-end-default" class="board-fill-color default-stroke-color solid-stroke" transform="rotate(180, 6, 6)">\n\n	<!-- mim-branching-left markers: line and extended drawing-board rect -->\n\n	<rect stroke="none" x="0.4" y="5.3" width="3.1" height="1.4"></rect>\n	<line fill="none" stroke-width="1" x1="3.9" y1="6.2" x2="0.2" y2="0"></line>	\n\n</g></marker><marker id="shape-library-markers-mim-branching-right-svg-start-default" preserveAspectRatio="none" viewBox="0 0 4 12" markerWidth="4" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="0.4" refY="6"><g id="g-src-shape-library-markers-mim-branching-right-svg-start-default" class="board-fill-color default-stroke-color solid-stroke">\n\n	<!-- mim-branching-right markers: line and extended drawing-board rect -->\n\n	<rect stroke="none" x="0.4" y="5.3" width="3.1" height="1.4"></rect>\n	<line fill="none" stroke-width="1" x1="0.2" y1="12" x2="3.9" y2="5.8"></line>	\n\n</g></marker><marker id="shape-library-markers-mim-branching-right-svg-end-default" preserveAspectRatio="none" viewBox="0 0 4 12" markerWidth="4" markerHeight="12" markerUnits="strokeWidth" orient="auto" refX="3.6" refY="6"><g id="g-src-shape-library-markers-mim-branching-right-svg-end-default" class="board-fill-color default-stroke-color solid-stroke" transform="rotate(180, 2, 6)">\n\n	<!-- mim-branching-right markers: line and extended drawing-board rect -->\n\n	<rect stroke="none" x="0.4" y="5.3" width="3.1" height="1.4"></rect>\n	<line fill="none" stroke-width="1" x1="0.2" y1="12" x2="3.9" y2="5.8"></line>	\n\n</g>\n</marker>\n<style type="text/css">	\n	/* default color for pathway elements */\n	.default-fill-color {\n		fill: black; \n	}\n	.default-stroke-color {\n		stroke: black;\n	}\n	\n	/* default color of the background drawing board */ 	\n	.board-fill-color {\n		fill: white;\n	}\n	.board-stroke-color {\n		stroke: white;\n	}\n\n	marker {\n		/* this is what should work per the spec\n		   stroke-dasharray: none; */\n		/* but I need to add this to make it work in Safari */\n		stroke-dasharray: 9999999999999999999999999;\n	}\n</style>\n</defs>\n</svg>\n';
var crossPlatformShapes={init:function(a,b){var c=a.customShapes,d=this;this.svg.crossPlatformShapesInstance=this.svg.path.crossPlatformShapesInstance=d;var e,f=a.targetSelector,g=document.querySelector(f),h=g.tagName.toLowerCase(),i=d3.select(g);"div"===h?(e=a.format,this[e].targetSelection=i,this.setFormat(e,c,h,i),d[e].init(a,function(a){b&&b(a)})):(e=h,this[e].targetImageSelection=i,this.setFormat(e,c,h,i),this[e].init(a,function(a){b&&b(a)}))},setFormat:function(a,b,c){var d=this;this[a].targetTagName=c;var e=["arc","arrow","brace","complex","endoplasmicReticulum","golgiApparatus","hexagon","lineCurved","lineElbow","lineSegmented","lineStraight","mimDegradation","mitochondria","ellipseDouble","ellipse","pentagon","rectangle","roundedRectangleDouble","roundedRectangle","sarcoplasmicReticulum","triangle","mimNecessaryStimulation","mimBinding","mimConversion","mimStimulation","mimModification","mimCatalysis","mimInhibition","mimCleavage","mimCovalentBond","mimTranscriptionTranslation","mimGap","tBar","mimBranchingLeft","mimBranchingRight"];e.forEach(function(b){d[b]=function(c,e){return d[a].path.render(b,c,e)}}),b&&(d.customShapes=b,d[a].image.customShapes=b,d3.map(b).keys().forEach(function(b){d[b]=function(c,e){return d[a].image.render(b,c,e)}}))}};crossPlatformShapes.pathCalculator={},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arrow=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b,c]},{command:"lineTo",points:[b+d,c+e/2]},{command:"lineTo",points:[b,c+e]},{command:"closePath",points:[]}];return f},crossPlatformShapes.pathCalculator.brace=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b,c+e]},{command:"bezierCurveTo",points:[b,c,b+d/2,c+e,b+d/2,c]},{command:"bezierCurveTo",points:[b+d/2,c+e,b+d,c,b+d,c+e]}];return f},crossPlatformShapes.pathCalculator.complex=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b+18,c]},{command:"lineTo",points:[b+d-18,c]},{command:"lineTo",points:[b+d,c+18]},{command:"lineTo",points:[b+d,c+e-18]},{command:"lineTo",points:[b+d-18,c+e]},{command:"lineTo",points:[b+18,c+e]},{command:"lineTo",points:[b,c+e-18]},{command:"lineTo",points:[b,c+18]},{command:"closePath",points:[]}];return f},crossPlatformShapes.pathCalculator.endoplasmicReticulum=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b,c]},{command:"lineTo",points:[b+d,c]},{command:"lineTo",points:[b+d,c+e]},{command:"lineTo",points:[b,c+e]},{command:"closePath",points:[]}];return f},crossPlatformShapes.pathCalculator.golgiApparatus=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b,c]},{command:"lineTo",points:[b+d,c]},{command:"lineTo",points:[b+d,c+e]},{command:"lineTo",points:[b,c+e]},{command:"closePath",points:[]}];return f},crossPlatformShapes.pathCalculator.hexagon=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b+.25*d,c]},{command:"lineTo",points:[b+.75*d,c]},{command:"lineTo",points:[b+d,c+.5*e]},{command:"lineTo",points:[b+.75*d,c+e]},{command:"lineTo",points:[b+.25*d,c+e]},{command:"lineTo",points:[b,c+.5*e]},{command:"closePath",points:[]}];return f},crossPlatformShapes.pathCalculator.lineCurved=function(a){"use strict";var b=d3.svg.line().x(function(a){return a.x}).y(function(a){return a.y}).interpolate("basis"),c=b(a.points);return c},crossPlatformShapes.pathCalculator.lineElbow=function(a){"use strict";var b=d3.svg.line().x(function(a){return a.x}).y(function(a){return a.y}).interpolate("linear"),c=b(a.points);return c},crossPlatformShapes.pathCalculator.lineSegmented=function(a){"use strict";var b=d3.svg.line().x(function(a){return a.x}).y(function(a){return a.y}).interpolate("linear"),c=b(a.points);return c},crossPlatformShapes.pathCalculator.lineStraight=function(a){"use strict";var b=a.points[0].x,c=a.points[0].y,d=a.points[1].x,e=a.points[1].y,f=[{command:"moveTo",points:[b,c]},{command:"lineTo",points:[d,e]}];return f},crossPlatformShapes.pathCalculator.mimDegradation=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=crossPlatformShapes.pathCalculator.ellipse(a),g=[{command:"moveTo",points:[b,c]},{command:"lineTo",points:[b+d,c+e]}],h=f.concat(g);return h},crossPlatformShapes.pathCalculator.mitochondria=function(a){"use strict";var b=(a.x,a.y,a.width,a.height,crossPlatformShapes.pathCalculator.ellipse(a)),c=b;return c},crossPlatformShapes.pathCalculator.ellipseDouble=function(a){"use strict";var b=crossPlatformShapes.pathCalculator.ellipse(a),c=a,d=2*a.borderWidth||6;c.x=a.x+d,c.y=a.y+d,c.width=a.width-2*d,c.height=a.height-2*d;var e=crossPlatformShapes.pathCalculator.ellipse(c),f=b.concat(e);return f},crossPlatformShapes.pathCalculator.ellipse=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=b+d/2,g=c+e/2,h=2*d/3,i=e/2,j=[{command:"moveTo",points:[f,g-i]},{command:"bezierCurveTo",points:[f+h,g-i,f+h,g+i,f,g+i]},{command:"bezierCurveTo",points:[f-h,g+i,f-h,g-i,f,g-i]}];return j},crossPlatformShapes.pathCalculator.pentagon=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b,c+.81*e]},{command:"lineTo",points:[b,c+.19*e]},{command:"lineTo",points:[b+.62*d,c]},{command:"lineTo",points:[b+d,c+.5*e]},{command:"lineTo",points:[b+.62*d,c+e]},{command:"closePath",points:[]}];return f},crossPlatformShapes.pathCalculator.rectangle=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b,c]},{command:"lineTo",points:[b+d,c]},{command:"lineTo",points:[b+d,c+e]},{command:"lineTo",points:[b,c+e]},{command:"closePath",points:[]}];return f},crossPlatformShapes.pathCalculator.roundedRectangleDouble=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=a.borderWidth,g=crossPlatformShapes.pathCalculator.roundedRectangle(a),h=a,i=2*f||6;h.x=b+i,h.y=c+i,h.width=d-2*i,h.height=e-2*i;var j=crossPlatformShapes.pathCalculator.roundedRectangle(h),k=g.concat(j);return k},crossPlatformShapes.pathCalculator.roundedRectangle=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b,c+10]},{command:"bezierCurveTo",points:[b,c+10-5.43379,b+4.56621,c,b+10,c]},{command:"lineTo",points:[b+d-10,c]},{command:"bezierCurveTo",points:[b+d-10+5.43379,c,b+d,c+4.56621,b+d,c+10]},{command:"lineTo",points:[b+d,c+e-10]},{command:"bezierCurveTo",points:[b+d,c+e-10+5.43379,b+d-4.56621,c+e,b+d-10,c+e]},{command:"lineTo",points:[b+10,c+e]},{command:"bezierCurveTo",points:[b+10-5.43379,c+e,b,c+e-4.56621,b,c+e-10]},{command:"lineTo",points:[b,c+10]}];return f},crossPlatformShapes.pathCalculator.sarcoplasmicReticulum=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b,c]},{command:"lineTo",points:[b+d,c]},{command:"lineTo",points:[b+d,c+e]},{command:"lineTo",points:[b,c+e]},{command:"closePath",points:[]}];return f},crossPlatformShapes.pathCalculator.triangle=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=[{command:"moveTo",points:[b,c]},{command:"lineTo",points:[b+d,c+e/2]},{command:"lineTo",points:[b,c+e]},{command:"closePath",points:[]}];return f},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.tBar=function(a){"use strict";var b=a.x,c=a.y,d=(a.width,a.height),e=[{command:"moveTo",points:[b,c]},{command:"lineTo",points:[b,c+d]}];return e},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.pathCalculator.arc=function(a){"use strict";var b=a.x,c=a.y,d=a.width,e=a.height,f=e*(2/3),g=[{command:"moveTo",points:[b,c]},{command:"bezierCurveTo",points:[b,c+f,b+d,c+f,b+d,c]}];return g},crossPlatformShapes.customShapes={arc:{href:"http://www.example.org/arc.png"},brace:{href:"http://www.example.org/brace.png"},rectangle:{href:"http://www.example.org/rectangle.png"}},crossPlatformShapes.svg={init:function(a,b){var c,d,e,f=a.width||"100%",g=a.height||"100%",h=a.backgroundColor||"#ffffff";if(this.crossPlatformShapesInstance,"svg"!==this.targetTagName){var i=a.id||"cross-platform-shape-svg";e=this.targetSelection.append("svg").attr("id",i).attr("version","1.1").attr("baseProfile","full").attr("xmlns","http://www.w3.org/1999/xlink").attr("xmlns:xmlns:xlink","http://www.w3.org/1999/xlink").attr("xmlns:xmlns:ev","http://www.w3.org/2001/xml-events").attr("preserveAspectRatio","xMidYMid").attr("width",f).attr("height",g).attr("style","background-color:"+h+"; "),this.path.targetImageSelection=this.image.targetImageSelection=e,d=e.append("defs").attr("id","defs"),this.marker.targetImageSelectionDefs=d,c=e.append("g").attr("id","viewport")}else e=this.targetImageSelection,this.path.targetImageSelection=this.image.targetImageSelection=e,this.marker.targetImageSelectionDefs=this.targetImageSelection.select("defs"),c=e.select("#viewport"),c[0][0]||(c=e.select("g"));this.path.availableMarkers=this.marker.availableMarkers={},this.path.backgroundColor=this.marker.backgroundColor=h,e.attr("style","background-color:"+h+"; "),b&&b(c)}},crossPlatformShapes.svg.image={render:function(a,b,c){var d=this.customShapes,e=this.targetImageSelection.select(b.containerSelector).append("image").attr("xlink:xlink:href",d[a].href).attr("x",b.x||0).attr("y",b.y||0).attr("width",b.width||0).attr("height",b.height||0),f=b.rotation;f&&e.attr("transform","rotate("+f+","+(b.x+b.width/2)+","+(b.y+b.height/2)+")"),c&&c(e[0][0])}},crossPlatformShapes.svg.marker={generateId:function(a,b,c){var d=("id-"+a+"-"+b+"-"+c).replace(/[^A-Za-z0-9-]/g,"").toLowerCase();return d},append:function(a,b,c,d){var e=this.availableMarkers,f=this.targetImageSelectionDefs,g=this.backgroundColor,h={arrow:{markerElement:{markerWidth:12,markerHeight:12},shapes:[{elementTag:"rect",x:0,y:5.4,width:2,height:1.2,stroke:g,fill:g},{elementTag:"polygon",points:"12,11 0,6 12,1","stroke-width":0,fill:c}]},mimBinding:{markerElement:{markerWidth:12,markerHeight:12},shapes:[{elementTag:"rect",x:0,y:5.4,width:2,height:1.2,stroke:g,fill:g},{elementTag:"polygon",points:"12,12 0,6 12,0 5,6","stroke-width":0,fill:c}]},mimNecessaryStimulation:{markerElement:{markerWidth:16,markerHeight:12},shapes:[{elementTag:"rect",x:0,y:5.4,width:2,height:1.2,stroke:"none",fill:g},{elementTag:"line",x1:14,y1:0,x2:14,y2:12,stroke:c,"stroke-width":1,fill:"none"},{elementTag:"line",x1:16,y1:6,x2:16,y2:6,stroke:"none",fill:"none"},{elementTag:"polygon",points:"0,6 9,11 9,1","stroke-width":1,stroke:c,fill:g}]},mimStimulation:{markerElement:{markerWidth:12,markerHeight:12},shapes:[{elementTag:"rect",x:0,y:5.4,width:2,height:1.2,stroke:"none",fill:g},{elementTag:"line",x1:12,y1:6,x2:12,y2:6,stroke:"none",fill:"none"},{elementTag:"polygon",points:"0,6 11,11 11,1","stroke-width":1,stroke:c,fill:g}]},mimModification:{markerElement:{markerWidth:12,markerHeight:12},shapes:[{elementTag:"rect",x:0,y:5.4,width:2,height:1.2,stroke:g,fill:g},{elementTag:"polygon",points:"12,12 0,6 12,0 5,6","stroke-width":0,fill:c}]},mimCatalysis:{markerElement:{markerWidth:12,markerHeight:12},shapes:[{elementTag:"circle",cx:6,cy:6,r:"5.3px",stroke:c,"stroke-width":1,fill:g}]},mimCleavage:{markerElement:{markerWidth:20,markerHeight:30},shapes:[{elementTag:"rect",x:0,y:14.3,width:18.4,height:1.4,stroke:g,fill:g},{elementTag:"line",stroke:c,"stroke-width":1,x1:18,y1:14.5,x2:18,y2:30},{elementTag:"line",stroke:c,"stroke-width":1,x1:18,y1:30,x2:0,y2:0}]},mimCovalentBond:{markerElement:{markerWidth:12,markerHeight:12},shapes:[{elementTag:"rect",x:0,y:0,width:0,height:0,stroke:g,"stroke-width":0,fill:g}]},mimTranscriptionTranslation:{markerElement:{markerWidth:20,markerHeight:24},shapes:[{elementTag:"rect",x:0,y:11,width:12,height:2,stroke:g,fill:g},{elementTag:"line",stroke:c,fill:"none","stroke-width":1,x1:15,y1:12,x2:15,y2:5},{elementTag:"line",stroke:c,fill:"none","stroke-width":1,x1:15.5,y1:5,x2:8,y2:5},{elementTag:"polygon",points:"0,5 8,1 8,9","stroke-width":1,stroke:c,fill:g}]},mimGap:{markerElement:{markerWidth:12,markerHeight:12},shapes:[{elementTag:"rect",x:0,y:5.3,width:8,height:1.4,stroke:"none",fill:g}]},mimBranchingLeft:{markerElement:{markerWidth:12,markerHeight:12},shapes:[{elementTag:"rect",x:.4,y:5.3,width:3.1,height:1.4,fill:g,stroke:"none"},{elementTag:"line",fill:"none",stroke:c,"stroke-width":1,x1:3.9,y1:6.2,x2:.2,y2:0}]},mimBranchingRight:{markerElement:{markerWidth:12,markerHeight:12},shapes:[{elementTag:"rect",x:.4,y:5.3,width:3.1,height:1.4,fill:g,stroke:"none"},{elementTag:"line",fill:"none",stroke:c,"stroke-width":1,x1:.2,y1:12,x2:3.9,y2:5.8}]},tBar:{markerElement:{markerWidth:10,markerHeight:20},shapes:[{elementTag:"rect",x:0,y:9,width:8,height:2,fill:g},{elementTag:"line",x:0,y:0,width:12,height:12,stroke:c,"stroke-width":1.8,x1:7,y1:0,x2:7,y2:20}]}};if(h.mimInhibition=h.tBar,h.mimConversion=h.arrow,h[a]){var i=this.generateId(a,b,c),j="url(#"+i+")";if(e[i])d(j);else{var k=f.append("marker").attr("id",i).attr("orient","auto").attr("markerUnits","strokeWidth").attr("preserveAspectRatio","none").attr("refY",h[a].markerElement.markerHeight/2).attr("viewBox","0 0 "+h[a].markerElement.markerWidth+" "+h[a].markerElement.markerHeight);d3.map(h[a].markerElement).entries().forEach(function(a){k.attr(a.key,a.value)}),"end"===b?k.attr("refX",h[a].markerElement.markerWidth):k.attr("refX",0);var l=k.append("g").attr("id","g-"+i);"end"===b&&l.attr("transform","rotate(180, "+h[a].markerElement.markerWidth/2+", "+h[a].markerElement.markerHeight/2+")"),h[a].shapes.forEach(function(a){var b=l.append(a.elementTag);d3.map(a).entries().forEach(function(a){"elementTag"!==a.key&&b.attr(a.key,a.value)})}),e[i]=!0,d(j)}}else console.warn('Marker (arrowhead) named "'+a+'" is not available.'),d("none")}},crossPlatformShapes.svg.path={generateMarkerId:function(a,b,c){var d=("id-"+a+"-"+b+"-"+c).replace(/[^A-Za-z0-9-]/g,"").toLowerCase();return d},render:function(a,b,c){var d=this.targetImageSelection,e=(this.availableMarkers,this.crossPlatformShapesInstance),f=["color","markerStart","markerEnd"],g={moveTo:"M",lineTo:"L",closePath:"Z",bezierCurveTo:"C",quadraticCurveTo:"Q"},h=d.select(b.containerSelector).append("path"),i=["lineCurved","lineElbow","lineSegmented"],j="";if(-1===i.indexOf(a)){var k=crossPlatformShapes.pathCalculator[a](b);k.forEach(function(a){j+=g[a.command],j+=a.points.join(",")})}else j=crossPlatformShapes.pathCalculator[a](b);h.attr("d",j);var l=b.backgroundColor||"transparent";h.attr("fill",l);var m,n,o,p={id:function(a){h.attr("id",a)},strokeDasharray:function(a){h.attr("stroke-dasharray",a)},fillOpacity:function(a){h.attr("fill-opacity",a)},color:function(a){m=a,h.attr("stroke",a)},markerStart:function(a){e.svg.marker.append(a,"start",m,function(a){h.attr("marker-start",a)})},markerEnd:function(a){e.svg.marker.append(a,"end",m,function(a){h.attr("marker-end",a)})},rotation:function(a){var c="rotate("+a+","+(b.x+b.width/2)+","+(b.y+b.height/2)+")";h.attr("transform",c)},borderWidth:function(a){h.attr("stroke-width",a)}},q=d3.map(b).entries().sort(function(a,b){return f.indexOf(a.key)-f.indexOf(b.key)});q.forEach(function(a){n=a.key,o=a.value,p.hasOwnProperty(n)&&p[n](o)}),c&&c(h[0][0])}},crossPlatformShapes.canvas={};var svgPanZoom={panEnabled:!0,zoomEnabled:!0,controlIconsEnabled:!1,dragEnabled:!1,zoomScaleSensitivity:.2,minZoom:.5,maxZoom:10,init:function(a){a=a||{};var b=a.selector;this.getSvg(b,function(b,c,d){c.__svgPanZoom={},c.__svgPanZoom.state="none";var e=d.getSvgDimensions(c),f=e.width,g=e.height;viewport=d.getViewport(c);var h=c.getAttribute("viewBox");if(h){var i=(c.getBBox(),c.getBoundingClientRect(),h.split(" ").map(function(a){return parseFloat(a)})),j=i[2],k=i[3];c.removeAttribute("viewBox");var l,m;l=m=c.__viewportElement.getCTM();var n=Math.min(f/j,g/k);m.a=n*l.a,m.d=n*l.d,m.e=l.e*n,m.f=l.f*n,d.setCTM(c.__viewportElement,m),d.initialCTM=m}else d.initialCTM=viewport.getCTM();a.hasOwnProperty("panEnabled")&&(d.panEnabled=a.panEnabled),a.hasOwnProperty("controlIconsEnabled")&&(d.controlIconsEnabled=a.controlIconsEnabled),a.hasOwnProperty("zoomEnabled")&&(d.zoomEnabled=a.zoomEnabled),d.controlIconsEnabled&&(a.svg=c,a.svgWidth=f,a.svgHeight=g,a.viewport=viewport,a.svgPanZoomInstance=d,d.controlIcons.add(a)),a.hasOwnProperty("dragEnabled")&&(d.dragEnabled=a.dragEnabled),a.hasOwnProperty("zoomScaleSensitivity")&&(d.zoomScaleSensitivity=a.zoomScaleSensitivity),a.hasOwnProperty("onZoom")&&(d.onZoom=a.onZoom),a.hasOwnProperty("minZoom")&&(d.minZoom=a.minZoom),a.hasOwnProperty("maxZoom")&&(d.maxZoom=a.maxZoom),d.setupHandlers(c),"svg"!==c.ownerDocument.documentElement.tagName.toLowerCase()&&(c.ownerDocument.defaultView.svgPanZoom=svgPanZoom)})},setZoomScaleSensitivity:function(a){this.zoomScaleSensitivity=a},enablePan:function(){this.panEnabled=!0},disablePan:function(){this.panEnabled=!1},enableZoom:function(){this.zoomEnabled=!0},disableZoom:function(){this.zoomEnabled=!1},enableDrag:function(){this.dragEnabled=!0},disableDrag:function(){this.dragEnabled=!1},setupHandlers:function(a){var b=this;if(a.addEventListener("mousedown",function(a){return b.handleMouseDown(a)},!1),a.addEventListener("touchstart",function(a){return b.handleMouseDown(a)},!1),a.addEventListener("mouseup",function(a){return b.handleMouseUp(a)},!1),a.addEventListener("touchend",function(a){return b.handleMouseUp(a)},!1),a.addEventListener("mousemove",function(a){return b.handleMouseMove(a)},!1),a.addEventListener("touchmove",function(a){return b.handleMouseMove(a)},!1),a.addEventListener("mouseleave",function(a){return b.handleMouseUp(a)},!1),a.addEventListener("touchleave",function(a){return b.handleMouseUp(a)},!1),a.addEventListener("touchcancel",function(a){return b.handleMouseUp(a)},!1),a.setAttribute("xmlns","http://www.w3.org/1999/xlink"),a.setAttributeNS("xmlns","xlink","http://www.w3.org/1999/xlink"),a.setAttributeNS("xmlns","ev","http://www.w3.org/2001/xml-events"),null!==a.parentNode){var c=a.getAttribute("style")||"";-1===c.toLowerCase().indexOf("overflow")&&a.setAttribute("style","overflow: hidden; "+c)}window.addWheelListener(a,function(a){return b.handleMouseWheel(a)})},getViewport:function(a){if(!a.__viewportElement&&(a.__viewportElement=a.getElementById("viewport"),!a.__viewportElement)){var b=document.createElementNS("http://www.w3.org/2000/svg","g");b.setAttribute("id","viewport");var c=a.childNodes||a.children;do b.appendChild(c[0]);while(c.length>0);a.appendChild(b),a.__viewportElement=b,"undefined"!=typeof console&&console.warn('No g element with id "viewport" in SVG document. Adding one as container element for SVG pan/zoom manipulation.')}return a.__viewportElement},getSvgDimensions:function(a){var b,c,d=a.getBoundingClientRect(),e=parseFloat(d.width),f=parseFloat(d.height);parseFloat(a.clip)?(b=a.clip.width,c=a.clip.height):parseFloat(a.style.pixelWidth)?(b=a.style.pixelWidth,c=a.style.pixelWidth):parseFloat(a.style.width)?(b=a.style.width,c=a.style.height):(b=a.getAttribute("width"),c=a.getAttribute("height")),b=b||0,c=c||0,b=-1===b.toString().indexOf("%")?parseFloat(b):0,c=-1===c.toString().indexOf("%")?parseFloat(c):0;var g={width:Math.max(e,b),height:Math.max(f,c)};return g},getScreenCTMCached:function(){var a={};return function(b){var c=Date.now();if(a.hasOwnProperty(b)){var d=a[b];return c-d.time>300&&(d.time=c,d.ctm=b.getScreenCTM()),d.ctm}var e=b.getScreenCTM();return a[b]={time:c,ctm:e},e}}(),getRelativeMousePoint:function(a,b){var c=a.createSVGPoint();return c.x=b.clientX,c.y=b.clientY,c=c.matrixTransform(this.getScreenCTMCached(a).inverse())},getSvgCenterPoint:function(a){var b=(a.getBBox(),a.getBoundingClientRect()),c=b.width,d=b.height,e=a.createSVGPoint();return e.x=c/2,e.y=d/2,e},getEventPoint:function(a){var b="svg"===a.target.tagName||"SVG"===a.target.tagName?a.target:a.target.ownerSVGElement||a.target.correspondingElement.ownerSVGElement,c=b.createSVGPoint();return c.x=a.clientX,c.y=a.clientY,c},setCTM:function(a,b){var c="matrix("+b.a+","+b.b+","+b.c+","+b.d+","+b.e+","+b.f+")";a.setAttribute("transform",c)},dumpMatrix:function(a){var b="[ "+a.a+", "+a.c+", "+a.e+"\n  "+a.b+", "+a.d+", "+a.f+"\n  0, 0, 1 ]";return b},setAttributes:function(a,b){for(var c in b)a.setAttributeNS(null,c,b[c])},findFirstSvg:function(a){var b,c,d;c=document.querySelector("svg"),c&&(d=c,a(d));var e=document.querySelectorAll("object");b=0;do b+=1,this.getSvg("object:nth-of-type("+b+")",function(b,c){c&&(d=c,a(d))});while(b<e.length);var f=document.querySelectorAll("embed");b=0;do b+=1,this.getSvg("embed:nth-of-type("+b+")",function(b,c){c&&(d=c,a(d))});while(b<f.length)},getSvg:function(a,b){var c,d;if(a){if(c=document.querySelector(a))if("svg"===c.tagName.toLowerCase())svg=c;else if("object"===c.tagName.toLowerCase())svg=c.contentDocument.documentElement;else{if("embed"!==c.tagName.toLowerCase())throw new Error("img"===c.tagName.toLowerCase()?'Cannot script an SVG in an "img" element. Please use an "object" element or an in-line SVG.':"Cannot get SVG.");svg=c.getSVGDocument().documentElement}if(svg||(d=new Error("No SVG found in this document.")),!b){if(!svg)throw d;return svg}b(d,svg,this)}else"undefined"!=typeof console&&console.warn("No selector specified for getSvg(). Using first svg element found."),c=this.findFirstSvg(function(a){if(a||(d=new Error("No SVG found in this document.")),!b){if(!a)throw d;return a}b(d,a,this)})},pan:function(a,b){if(!b)throw new Error("No direction specified for direction of panning. Please enter a string value of up, right, down or left.");var c,d,e=.1,f={top:{x:0,y:-1},t:{x:0,y:-1},up:{x:0,y:-1},u:{x:0,y:-1},right:{x:1,y:0},r:{x:1,y:0},bottom:{x:0,y:1},b:{x:0,y:1},down:{x:0,y:1},d:{x:0,y:1},left:{x:-1,y:0},l:{x:-1,y:0}},g=f[b];if(!g)throw new Error("Direction specified was not understood. Please enter a string value of up, right, down or left.");this.getSvg(a,function(a,b,f){var h=f.getViewport(b);c=b.getBBox().width*e*g.x,d=b.getBBox().height*e*g.y;var i=h.getCTM();i.e+=c,i.f+=d,f.setCTM(h,i)})},zoom:function(a){if(!a.scale)throw new Error("No scale specified for zoom. Please enter a number.");this.getSvg(a.selector,function(b,c,d){var e=d.getSvgCenterPoint(c);d.zoomAtPoint(c,e,a.scale,!0)})},zoomIn:function(a){this.getSvg(a,function(a,b,c){var d=c.getSvgCenterPoint(b);c.zoomAtPoint(b,d,1+c.zoomScaleSensitivity)})},zoomOut:function(a){this.getSvg(a,function(a,b,c){var d=c.getSvgCenterPoint(b);c.zoomAtPoint(b,d,1/(1+c.zoomScaleSensitivity))})},resetZoom:function(a){this.getSvg(a,function(a,b,c){var d=c.getViewport(b);c.setCTM(d,c.initialCTM),c.onZoom&&c.onZoom(c.initialCTM.a)})},handleMouseWheel:function(a){if(this.zoomEnabled){a.preventDefault?a.preventDefault():a.returnValue=!1;var b,c="svg"===a.target.tagName||"SVG"===a.target.tagName?a.target:a.target.ownerSVGElement||a.target.correspondingElement.ownerSVGElement;b="deltaMode"in a&&0===a.deltaMode?a.wheelDelta?a.deltaY/Math.abs(a.wheelDelta/3):a.deltaY/120:"mozPressure"in a?a.deltaY/3:a.deltaY;var d=this.getRelativeMousePoint(c,a),e=Math.pow(1+this.zoomScaleSensitivity,-1*b);this.zoomAtPoint(c,d,e)}},zoomAtPoint:function(a,b,c,d){var e=this.getViewport(a),f=e.getCTM();b=b.matrixTransform(f.inverse());var g=a.createSVGMatrix().translate(b.x,b.y).scale(c).translate(-b.x,-b.y),h=f,i=f.multiply(g);d&&(i.a=i.d=c),i.a<this.minZoom*this.initialCTM.a&&(i.a=i.d=h.a),i.a>this.maxZoom*this.initialCTM.a&&(i.a=i.d=h.a),i.a!==h.a&&this.setCTM(e,i),this.stateTf||(this.stateTf=i.inverse()),this.stateTf=this.stateTf.multiply(g.inverse()),this.onZoom&&this.onZoom(i.a)},handleMouseMove:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;var b,c="svg"===a.target.tagName||"SVG"===a.target.tagName?a.target:a.target.ownerSVGElement||a.target.correspondingElement.ownerSVGElement,d=this.getViewport(c),e=c.__svgPanZoom.state;"pan"===e&&this.panEnabled?(b=this.getEventPoint(a).matrixTransform(this.stateTf),this.setCTM(d,this.stateTf.inverse().translate(b.x-this.stateOrigin.x,b.y-this.stateOrigin.y))):"drag"===e&&this.dragEnabled&&(b=this.getEventPoint(a).matrixTransform(d.getCTM().inverse()),this.setCTM(this.stateTarget,c.createSVGMatrix().translate(b.x-this.stateOrigin.x,b.y-this.stateOrigin.y).multiply(d.getCTM().inverse()).multiply(this.stateTarget.getCTM())),this.stateOrigin=b)},handleDblClick:function(a){var b=a.target;a.preventDefault?a.preventDefault():a.returnValue=!1;var c="svg"===b.tagName||"SVG"===b.tagName?b:b.ownerSVGElement||b.correspondingElement.ownerSVGElement;if(this.controlIconsEnabled){var d=b.getAttribute("class")||"";if(d.indexOf("svg-pan-zoom-control")>-1)return!1}var e;e=a.shiftKey?1/(2*(1+this.zoomScaleSensitivity)):2*(1+this.zoomScaleSensitivity);var f=this.getRelativeMousePoint(c,a);this.zoomAtPoint(c,f,e)},handleMouseDown:function(a){2===a.detail&&this.handleDblClick(a),a.preventDefault?a.preventDefault():a.returnValue=!1;var b="svg"===a.target.tagName||"SVG"===a.target.tagName?a.target:a.target.ownerSVGElement||a.target.correspondingElement.ownerSVGElement,c=this.getViewport(b);"svg"!==a.target.tagName&&this.dragEnabled?(b.__svgPanZoom.state="drag",this.stateTarget=a.target,this.stateTf=c.getCTM().inverse(),this.stateOrigin=this.getEventPoint(a).matrixTransform(this.stateTf)):(b.__svgPanZoom.state="pan",this.stateTf=c.getCTM().inverse(),this.stateOrigin=this.getEventPoint(a).matrixTransform(this.stateTf))},handleMouseUp:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;var b="svg"===a.target.tagName||"SVG"===a.target.tagName?a.target:a.target.ownerSVGElement||a.target.correspondingElement.ownerSVGElement,c=b.__svgPanZoom.state;("pan"===c||"drag"===c)&&(b.__svgPanZoom.state="none")}};window.hasOwnProperty("addWheelListener")||!function(a,b){function c(b,c,g,h){b[d](f+c,"wheel"==e?g:function(b){!b&&(b=a.event);var c={originalEvent:b,clientX:b.clientX,clientY:b.clientY,target:b.target||b.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==b.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){b.preventDefault?b.preventDefault():b.returnValue=!1}};return"mousewheel"==e?(c.deltaY=-1/40*b.wheelDelta,b.wheelDeltaX&&(c.deltaX=-1/40*b.wheelDeltaX)):c.deltaY=b.detail,g(c)},h||!1)}var d,e,f="";a.addEventListener?d="addEventListener":(d="attachEvent",f="on"),e="onwheel"in b.createElement("div")?"wheel":void 0!==b.onmousewheel?"mousewheel":"DOMMouseScroll",a.addWheelListener=function(a,b,d){c(a,e,b,d),"DOMMouseScroll"==e&&c(a,"MozMousePixelScroll",b,d)}}(window,document),svgPanZoom.controlIcons={add:function(a){var b=a.svgWidth,c=a.svgHeight,d=a.svg,e=(a.viewport,a.selector),f=a.svgPanZoomInstance,g=d.querySelector("defs");g||(g=document.createElementNS("http://www.w3.org/2000/svg","defs"),d.appendChild(g));var h=document.createElementNS("http://www.w3.org/2000/svg","style");h.setAttribute("type","text/css"),h.textContent=".svg-pan-zoom-control { cursor: pointer; fill: black; fill-opacity: 0.333; } .svg-pan-zoom-control:hover { fill-opacity: 0.8; } .svg-pan-zoom-control-background { fill: white; fill-opacity: 0.5; } .svg-pan-zoom-control-background { fill-opacity: 0.8; }",g.appendChild(h);var i=document.createElementNS("http://www.w3.org/2000/svg","g");i.setAttribute("id","svg-pan-zoom-controls"),i.setAttribute("transform","translate("+(b-70)+" "+(c-76)+") scale(0.75)"),i.setAttribute("class","svg-pan-zoom-control");var j=document.createElementNS("http://www.w3.org/2000/svg","g");j.setAttribute("id","svg-pan-zoom-zoom-in"),j.setAttribute("transform","translate(30.5 5) scale(0.015)"),j.setAttribute("class","svg-pan-zoom-control"),j.addEventListener("click",function(){f.zoomIn(e)},!1),i.appendChild(j);var k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.setAttribute("x","0"),k.setAttribute("y","0"),k.setAttribute("width","1500"),k.setAttribute("height","1400"),k.setAttribute("class","svg-pan-zoom-control-background"),j.appendChild(k);var l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","M1280 576v128q0 26 -19 45t-45 19h-320v320q0 26 -19 45t-45 19h-128q-26 0 -45 -19t-19 -45v-320h-320q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h320v-320q0 -26 19 -45t45 -19h128q26 0 45 19t19 45v320h320q26 0 45 19t19 45zM1536 1120v-960 q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5t84.5 -203.5z"),l.setAttribute("class","svg-pan-zoom-control-element"),j.appendChild(l);var m=document.createElementNS("http://www.w3.org/2000/svg","g");m.setAttribute("id","svg-pan-zoom-reset-pan-zoom"),m.setAttribute("transform","translate(5 35) scale(0.4)"),m.setAttribute("class","svg-pan-zoom-control"),m.addEventListener("click",function(){f.resetZoom(e)},!1),i.appendChild(m);var n=document.createElementNS("http://www.w3.org/2000/svg","rect");n.setAttribute("x","2"),n.setAttribute("y","2"),n.setAttribute("width","182"),n.setAttribute("height","58"),n.setAttribute("class","svg-pan-zoom-control-background"),m.appendChild(n);var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d","M33.051,20.632c-0.742-0.406-1.854-0.609-3.338-0.609h-7.969v9.281h7.769c1.543,0,2.701-0.188,3.473-0.562c1.365-0.656,2.048-1.953,2.048-3.891C35.032,22.757,34.372,21.351,33.051,20.632z"),o.setAttribute("class","svg-pan-zoom-control-element"),m.appendChild(o);var p=document.createElementNS("http://www.w3.org/2000/svg","path");p.setAttribute("d","M170.231,0.5H15.847C7.102,0.5,0.5,5.708,0.5,11.84v38.861C0.5,56.833,7.102,61.5,15.847,61.5h154.384c8.745,0,15.269-4.667,15.269-10.798V11.84C185.5,5.708,178.976,0.5,170.231,0.5z M42.837,48.569h-7.969c-0.219-0.766-0.375-1.383-0.469-1.852c-0.188-0.969-0.289-1.961-0.305-2.977l-0.047-3.211c-0.03-2.203-0.41-3.672-1.142-4.406c-0.732-0.734-2.103-1.102-4.113-1.102h-7.05v13.547h-7.055V14.022h16.524c2.361,0.047,4.178,0.344,5.45,0.891c1.272,0.547,2.351,1.352,3.234,2.414c0.731,0.875,1.31,1.844,1.737,2.906s0.64,2.273,0.64,3.633c0,1.641-0.414,3.254-1.242,4.84s-2.195,2.707-4.102,3.363c1.594,0.641,2.723,1.551,3.387,2.73s0.996,2.98,0.996,5.402v2.32c0,1.578,0.063,2.648,0.19,3.211c0.19,0.891,0.635,1.547,1.333,1.969V48.569z M75.579,48.569h-26.18V14.022h25.336v6.117H56.454v7.336h16.781v6H56.454v8.883h19.125V48.569z M104.497,46.331c-2.44,2.086-5.887,3.129-10.34,3.129c-4.548,0-8.125-1.027-10.731-3.082s-3.909-4.879-3.909-8.473h6.891c0.224,1.578,0.662,2.758,1.316,3.539c1.196,1.422,3.246,2.133,6.15,2.133c1.739,0,3.151-0.188,4.236-0.562c2.058-0.719,3.087-2.055,3.087-4.008c0-1.141-0.504-2.023-1.512-2.648c-1.008-0.609-2.607-1.148-4.796-1.617l-3.74-0.82c-3.676-0.812-6.201-1.695-7.576-2.648c-2.328-1.594-3.492-4.086-3.492-7.477c0-3.094,1.139-5.664,3.417-7.711s5.623-3.07,10.036-3.07c3.685,0,6.829,0.965,9.431,2.895c2.602,1.93,3.966,4.73,4.093,8.402h-6.938c-0.128-2.078-1.057-3.555-2.787-4.43c-1.154-0.578-2.587-0.867-4.301-0.867c-1.907,0-3.428,0.375-4.565,1.125c-1.138,0.75-1.706,1.797-1.706,3.141c0,1.234,0.561,2.156,1.682,2.766c0.721,0.406,2.25,0.883,4.589,1.43l6.063,1.43c2.657,0.625,4.648,1.461,5.975,2.508c2.059,1.625,3.089,3.977,3.089,7.055C108.157,41.624,106.937,44.245,104.497,46.331z M139.61,48.569h-26.18V14.022h25.336v6.117h-18.281v7.336h16.781v6h-16.781v8.883h19.125V48.569z M170.337,20.14h-10.336v28.43h-7.266V20.14h-10.383v-6.117h27.984V20.14z"),p.setAttribute("class","svg-pan-zoom-control-element"),m.appendChild(p);
var q=document.createElementNS("http://www.w3.org/2000/svg","g");q.setAttribute("id","svg-pan-zoom-zoom-out"),q.setAttribute("transform","translate(30.5 70) scale(0.015)"),q.setAttribute("class","svg-pan-zoom-control"),q.addEventListener("click",function(){f.zoomOut(e)},!1),i.appendChild(q);var r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttribute("x","0"),r.setAttribute("y","0"),r.setAttribute("width","1500"),r.setAttribute("height","1400"),r.setAttribute("class","svg-pan-zoom-control-background"),q.appendChild(r);var s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d","M1280 576v128q0 26 -19 45t-45 19h-896q-26 0 -45 -19t-19 -45v-128q0 -26 19 -45t45 -19h896q26 0 45 19t19 45zM1536 1120v-960q0 -119 -84.5 -203.5t-203.5 -84.5h-960q-119 0 -203.5 84.5t-84.5 203.5v960q0 119 84.5 203.5t203.5 84.5h960q119 0 203.5 -84.5 t84.5 -203.5z"),s.setAttribute("class","svg-pan-zoom-control-element"),q.appendChild(s),d.appendChild(i)}},!function(a){"use strict";var b=function(a,c,d){var e,f,g=document.createElement("img");if(g.onerror=c,g.onload=function(){!f||d&&d.noRevoke||b.revokeObjectURL(f),c&&c(b.scale(g,d))},b.isInstanceOf("Blob",a)||b.isInstanceOf("File",a))e=f=b.createObjectURL(a),g._type=a.type;else{if("string"!=typeof a)return!1;e=a,d&&d.crossOrigin&&(g.crossOrigin=d.crossOrigin)}return e?(g.src=e,g):b.readFile(a,function(a){var b=a.target;b&&b.result?g.src=b.result:c&&c(a)})},c=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;b.isInstanceOf=function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},b.transformCoordinates=function(){},b.getTransformedOptions=function(a){return a},b.renderImageToCanvas=function(a,b,c,d,e,f,g,h,i,j){return a.getContext("2d").drawImage(b,c,d,e,f,g,h,i,j),a},b.hasCanvasOption=function(a){return a.canvas||a.crop},b.scale=function(a,c){c=c||{};var d,e,f,g,h,i,j,k,l,m=document.createElement("canvas"),n=a.getContext||b.hasCanvasOption(c)&&m.getContext,o=a.naturalWidth||a.width,p=a.naturalHeight||a.height,q=o,r=p,s=function(){var a=Math.max((f||q)/q,(g||r)/r);a>1&&(q=Math.ceil(q*a),r=Math.ceil(r*a))},t=function(){var a=Math.min((d||q)/q,(e||r)/r);1>a&&(q=Math.ceil(q*a),r=Math.ceil(r*a))};return n&&(c=b.getTransformedOptions(c),j=c.left||0,k=c.top||0,c.sourceWidth?(h=c.sourceWidth,void 0!==c.right&&void 0===c.left&&(j=o-h-c.right)):h=o-j-(c.right||0),c.sourceHeight?(i=c.sourceHeight,void 0!==c.bottom&&void 0===c.top&&(k=p-i-c.bottom)):i=p-k-(c.bottom||0),q=h,r=i),d=c.maxWidth,e=c.maxHeight,f=c.minWidth,g=c.minHeight,n&&d&&e&&c.crop?(q=d,r=e,l=h/i-d/e,0>l?(i=e*h/d,void 0===c.top&&void 0===c.bottom&&(k=(p-i)/2)):l>0&&(h=d*i/e,void 0===c.left&&void 0===c.right&&(j=(o-h)/2))):((c.contain||c.cover)&&(f=d=d||f,g=e=e||g),c.cover?(t(),s()):(s(),t())),n?(m.width=q,m.height=r,b.transformCoordinates(m,c),b.renderImageToCanvas(m,a,j,k,h,i,0,0,q,r)):(a.width=q,a.height=r,a)},b.createObjectURL=function(a){return c?c.createObjectURL(a):!1},b.revokeObjectURL=function(a){return c?c.revokeObjectURL(a):!1},b.readFile=function(a,b,c){if(window.FileReader){var d=new FileReader;if(d.onload=d.onerror=b,c=c||"readAsDataURL",d[c])return d[c](a),d}return!1},"function"==typeof define&&define.amd?define(function(){return b}):a.loadImage=b}(this),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){"use strict";if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var b=a.renderImageToCanvas;a.detectSubsampling=function(a){var b,c;return a.width*a.height>1048576?(b=document.createElement("canvas"),b.width=b.height=1,c=b.getContext("2d"),c.drawImage(a,-a.width+1,0),0===c.getImageData(0,0,1,1).data[3]):!1},a.detectVerticalSquash=function(a,b){var c,d,e,f,g,h=a.naturalHeight||a.height,i=document.createElement("canvas"),j=i.getContext("2d");for(b&&(h/=2),i.width=1,i.height=h,j.drawImage(a,0,0),c=j.getImageData(0,0,1,h).data,d=0,e=h,f=h;f>d;)g=c[4*(f-1)+3],0===g?e=f:d=f,f=e+d>>1;return f/h||1},a.renderImageToCanvas=function(c,d,e,f,g,h,i,j,k,l){if("image/jpeg"===d._type){var m,n,o,p,q=c.getContext("2d"),r=document.createElement("canvas"),s=1024,t=r.getContext("2d");if(r.width=s,r.height=s,q.save(),m=a.detectSubsampling(d),m&&(e/=2,f/=2,g/=2,h/=2),n=a.detectVerticalSquash(d,m),m||1!==n){for(f*=n,k=Math.ceil(s*k/g),l=Math.ceil(s*l/h/n),j=0,p=0;h>p;){for(i=0,o=0;g>o;)t.clearRect(0,0,s,s),t.drawImage(d,e,f,g,h,-o,-p,g,h),q.drawImage(r,0,0,s,s,i,j,k,l),o+=s,i+=k;p+=s,j+=l}return q.restore(),c}}return b(c,d,e,f,g,h,i,j,k,l)}}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){"use strict";var b=a.hasCanvasOption;a.hasCanvasOption=function(a){return b(a)||a.orientation},a.transformCoordinates=function(a,b){var c=a.getContext("2d"),d=a.width,e=a.height,f=b.orientation;if(f)switch(f>4&&(a.width=e,a.height=d),f){case 2:c.translate(d,0),c.scale(-1,1);break;case 3:c.translate(d,e),c.rotate(Math.PI);break;case 4:c.translate(0,e),c.scale(1,-1);break;case 5:c.rotate(.5*Math.PI),c.scale(1,-1);break;case 6:c.rotate(.5*Math.PI),c.translate(0,-e);break;case 7:c.rotate(.5*Math.PI),c.translate(d,-e),c.scale(-1,1);break;case 8:c.rotate(-.5*Math.PI),c.translate(-d,0)}},a.getTransformedOptions=function(a){if(!a.orientation||1===a.orientation)return a;var b,c={};for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);switch(a.orientation){case 2:c.left=a.right,c.right=a.left;break;case 3:c.left=a.right,c.top=a.bottom,c.right=a.left,c.bottom=a.top;break;case 4:c.top=a.bottom,c.bottom=a.top;break;case 5:c.left=a.top,c.top=a.left,c.right=a.bottom,c.bottom=a.right;break;case 6:c.left=a.top,c.top=a.right,c.right=a.bottom,c.bottom=a.left;break;case 7:c.left=a.bottom,c.top=a.right,c.right=a.top,c.bottom=a.left;break;case 8:c.left=a.bottom,c.top=a.left,c.right=a.top,c.bottom=a.right}return a.orientation>4&&(c.maxWidth=a.maxHeight,c.maxHeight=a.maxWidth,c.minWidth=a.minHeight,c.minHeight=a.minWidth,c.sourceWidth=a.sourceHeight,c.sourceHeight=a.sourceWidth),c}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){"use strict";var b=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);a.blobSlice=b&&function(){var a=this.slice||this.webkitSlice||this.mozSlice;return a.apply(this,arguments)},a.metaDataParsers={jpeg:{65505:[]}},a.parseMetaData=function(b,c,d){d=d||{};var e=this,f=d.maxMetaDataSize||262144,g={},h=!(window.DataView&&b&&b.size>=12&&"image/jpeg"===b.type&&a.blobSlice);(h||!a.readFile(a.blobSlice.call(b,0,f),function(b){if(b.target.error)return console.log(b.target.error),void c(g);var f,h,i,j,k=b.target.result,l=new DataView(k),m=2,n=l.byteLength-4,o=m;if(65496===l.getUint16(0)){for(;n>m&&(f=l.getUint16(m),f>=65504&&65519>=f||65534===f);){if(h=l.getUint16(m+2)+2,m+h>l.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(i=a.metaDataParsers.jpeg[f])for(j=0;j<i.length;j+=1)i[j].call(e,l,m,h,g,d);m+=h,o=m}!d.disableImageHead&&o>6&&(g.imageHead=k.slice?k.slice(0,o):new Uint8Array(k).subarray(0,o))}else console.log("Invalid JPEG file: Missing JPEG marker.");c(g)},"readAsArrayBuffer"))&&c(g)}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-meta"],a):a(window.loadImage)}(function(a){"use strict";a.ExifMap=function(){return this},a.ExifMap.prototype.map={Orientation:274},a.ExifMap.prototype.get=function(a){return this[a]||this[this.map[a]]},a.getExifThumbnail=function(a,b,c){var d,e,f;if(!c||b+c>a.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");for(d=[],e=0;c>e;e+=1)f=a.getUint8(b+e),d.push((16>f?"0":"")+f.toString(16));return"data:image/jpeg,%"+d.join("%")},a.exifTagTypes={1:{getValue:function(a,b){return a.getUint8(b)},size:1},2:{getValue:function(a,b){return String.fromCharCode(a.getUint8(b))},size:1,ascii:!0},3:{getValue:function(a,b,c){return a.getUint16(b,c)},size:2},4:{getValue:function(a,b,c){return a.getUint32(b,c)},size:4},5:{getValue:function(a,b,c){return a.getUint32(b,c)/a.getUint32(b+4,c)},size:8},9:{getValue:function(a,b,c){return a.getInt32(b,c)},size:4},10:{getValue:function(a,b,c){return a.getInt32(b,c)/a.getInt32(b+4,c)},size:8}},a.exifTagTypes[7]=a.exifTagTypes[1],a.getExifValue=function(b,c,d,e,f,g){var h,i,j,k,l,m,n=a.exifTagTypes[e];if(!n)return void console.log("Invalid Exif data: Invalid tag type.");if(h=n.size*f,i=h>4?c+b.getUint32(d+8,g):d+8,i+h>b.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===f)return n.getValue(b,i,g);for(j=[],k=0;f>k;k+=1)j[k]=n.getValue(b,i+k*n.size,g);if(n.ascii){for(l="",k=0;k<j.length&&(m=j[k],"\x00"!==m);k+=1)l+=m;return l}return j},a.parseExifTag=function(b,c,d,e,f){var g=b.getUint16(d,e);f.exif[g]=a.getExifValue(b,c,d,b.getUint16(d+2,e),b.getUint32(d+4,e),e)},a.parseExifTags=function(a,b,c,d,e){var f,g,h;if(c+6>a.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(f=a.getUint16(c,d),g=c+2+12*f,g+4>a.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(h=0;f>h;h+=1)this.parseExifTag(a,b,c+2+12*h,d,e);return a.getUint32(g,d)},a.parseExifData=function(b,c,d,e,f){if(!f.disableExif){var g,h,i,j=c+10;if(1165519206===b.getUint32(c+4)){if(j+8>b.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==b.getUint16(c+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(b.getUint16(j)){case 18761:g=!0;break;case 19789:g=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==b.getUint16(j+2,g))return void console.log("Invalid Exif data: Missing TIFF marker.");h=b.getUint32(j+4,g),e.exif=new a.ExifMap,h=a.parseExifTags(b,j,j+h,g,e),h&&!f.disableExifThumbnail&&(i={exif:{}},h=a.parseExifTags(b,j,j+h,g,i),i.exif[513]&&(e.exif.Thumbnail=a.getExifThumbnail(b,j+i.exif[513],i.exif[514]))),e.exif[34665]&&!f.disableExifSub&&a.parseExifTags(b,j,j+e.exif[34665],g,e),e.exif[34853]&&!f.disableExifGps&&a.parseExifTags(b,j,j+e.exif[34853],g,e)}}},a.metaDataParsers.jpeg[65505].push(a.parseExifData)}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-exif"],a):a(window.loadImage)}(function(a){"use strict";a.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},a.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},a.ExifMap.prototype.getText=function(a){var b=this.get(a);switch(a){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[a][b];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(b[0],b[1],b[2],b[3]);case"ComponentsConfiguration":return this.stringValues[a][b[0]]+this.stringValues[a][b[1]]+this.stringValues[a][b[2]]+this.stringValues[a][b[3]];case"GPSVersionID":return b[0]+"."+b[1]+"."+b[2]+"."+b[3]}return String(b)},function(a){var b,c=a.tags,d=a.map;for(b in c)c.hasOwnProperty(b)&&(d[c[b]]=b)}(a.ExifMap.prototype),a.ExifMap.prototype.getAll=function(){var a,b,c={};for(a in this)this.hasOwnProperty(a)&&(b=this.tags[a],b&&(c[b]=this.getText(b)));return c}}),function(){var a="undefined"!=typeof process&&process.versions&&process.versions.node,b=!a&&("undefined"!=typeof window||"undefined"!=typeof self);b&&"undefined"==typeof global&&("undefined"!=typeof window?global=window:"undefined"!=typeof self?global=self:"undefined"!=typeof $&&(global=$));var c=function(c){function d(){}function e(a){for(var b=[],c=Object.keys(a).sort(),d=0;d<c.length;++d){var e=c[d],f=a[e];L(f)||(f=[f]);for(var g=0;g<f.length;++g){var h=f[g];if(!N(h))throw new Cb("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:a});b.push({"@value":h,"@language":e.toLowerCase()})}}return b}function f(a,b){if(L(b))for(var c=0;c<b.length;++c)b[c]=f(a,b[c]);else if(W(b))b["@list"]=f(a,b["@list"]);else if(J(b)){X(b)&&(b["@id"]=a.getName(b["@id"]));for(var d=Object.keys(b).sort(),e=0;e<d.length;++e){var g=d[e];"@id"!==g&&(b[g]=f(a,b[g]))}}return b}function g(a,b,d){if(null===d)return null;var e=E(a,b,{vocab:!0});if("@id"===e)return E(a,d,{base:!0});if("@type"===e)return E(a,d,{vocab:!0,base:!0});var f=c.getContextValue(a,b,"@type");if("@id"===f||"@graph"===e&&N(d))return{"@id":E(a,d,{base:!0})};if("@vocab"===f)return{"@id":E(a,d,{vocab:!0,base:!0})};if(I(e))return d;var g={};if(null!==f)g["@type"]=f;else if(N(d)){var h=c.getContextValue(a,b,"@language");null!==h&&(g["@language"]=h)}return g["@value"]=d,g}function h(a,b,c){for(var d=[],e=Object.keys(a).sort(),f=0;f<e.length;++f)for(var g=e[f],h=a[g],k=Object.keys(h).sort(),l=0;l<k.length;++l){var m=k[l],n=h[m];if("@type"===m)m=vb;else if(I(m))continue;for(var o=0;o<n.length;++o){var p=n[o],q={};if(q.type=0===g.indexOf("_:")?"blank node":"IRI",q.value=g,Y(g)){var r={};if(r.type=0===m.indexOf("_:")?"blank node":"IRI",r.value=m,Y(m)&&("blank node"!==r.type||c.produceGeneralizedRdf))if(W(p))i(p["@list"],b,q,r,d);else{var s=j(p);s&&d.push({subject:q,predicate:r,object:s})}}}}return d}function i(a,b,c,d,e){for(var f={type:"IRI",value:sb},g={type:"IRI",value:tb},h={type:"IRI",value:ub},i=0;i<a.length;++i){var k=a[i],l={type:"blank node",value:b.getName()};e.push({subject:c,predicate:d,object:l}),c=l,d=f;var m=j(k);m&&e.push({subject:c,predicate:d,object:m}),d=g}e.push({subject:c,predicate:d,object:h})}function j(a){var b={};if(V(a)){b.type="literal";var c=a["@value"],d=a["@type"]||null;R(c)?(b.value=c.toString(),b.datatype=d||mb):P(c)||d===nb?(b.value=c.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),b.datatype=d||nb):O(c)?(b.value=c.toFixed(0),b.datatype=d||ob):"@language"in a?(b.value=c,b.datatype=d||zb,b.language=a["@language"]):(b.value=c,b.datatype=d||pb)}else{var e=J(a)?a["@id"]:a;b.type=0===e.indexOf("_:")?"blank node":"IRI",b.value=e}return"IRI"!==b.type||Y(b.value)?b:null}function k(a,b){if("IRI"===a.type||"blank node"===a.type)return{"@id":a.value};var c={"@value":a.value};if(a.language)c["@language"]=a.language;else{var d=a.datatype;if(d||(d=pb),b){if(d===mb)"true"===c["@value"]?c["@value"]=!0:"false"===c["@value"]&&(c["@value"]=!1);else if(Q(c["@value"]))if(d===ob){var e=parseInt(c["@value"]);e.toFixed(0)===c["@value"]&&(c["@value"]=e)}else d===nb&&(c["@value"]=parseFloat(c["@value"]));-1===[mb,ob,nb,pb].indexOf(d)&&(c["@type"]=d)}else d!==pb&&(c["@type"]=d)}return c}function l(a,b){for(var c=["subject","predicate","object"],d=0;d<c.length;++d){var e=c[d];if(a[e].type!==b[e].type||a[e].value!==b[e].value)return!1}return a.object.language!==b.object.language?!1:a.object.datatype!==b.object.datatype?!1:!0}function m(a,b){if("hash"in b[a])return b[a].hash;for(var c=b[a].quads,d=[],e=0;e<c.length;++e)d.push(cb(c[e],c[e].name?c[e].name.value:null,a));d.sort();var f=b[a].hash=Fb.hash(d);return f}function n(a,b,d,e,f){function g(f){if(f===l.length)return i=Object.keys(k).sort(),h(0);var j=l[f],n=o(j.subject,a),p=null;if(null!==n?p="p":(n=o(j.object,a),null!==n&&(p="r")),null!==n){var q;q=d.isNamed(n)?d.getName(n):e.isNamed(n)?e.getName(n):m(n,b,d);var r=Fb.create();r.update(p),r.update(j.predicate.value),r.update(q);var s=r.digest();s in k?k[s].push(n):k[s]=[n]}c.setImmediate(function(){g(f+1)})}function h(a){function g(){function i(a){if(a===s.length)return k(!1);var c=s[a];n(c,b,d,q,function(b,d){return b?f(b):(r+=q.getName(c)+"<"+d.hash+">",q=d.pathNamer,null!==m&&r.length>=m.length&&r>m?k(!0):void i(a+1))})}function k(b){!b&&(null===m||m>r)&&(m=r,o=q),p.hasNext()?c.setImmediate(function(){g()}):(j.update(m),e=o,h(a+1))}var l=p.next(),q=e.clone(),r="",s=[];for(var t in l){var u=l[t];if(d.isNamed(u)?r+=d.getName(u):(q.isNamed(u)||s.push(u),r+=q.getName(u)),null!==m&&r.length>=m.length&&r>m)return k(!0)}i(0)}if(a===i.length)return f(null,{hash:j.digest(),pathNamer:e});var l=i[a];j.update(l);var m=null,o=null,p=new Eb(k[l]);c.setImmediate(function(){g()})}var i,j=Fb.create(),k={},l=b[a].quads;c.setImmediate(function(){g(0)})}function o(a,b){return"blank node"===a.type&&a.value!==b?a.value:null}function p(a,b,d,e,f,g){if(L(a))for(var h=0;h<a.length;++h)p(a[h],b,d,e,void 0,g);else{if(!J(a))return void(g&&g.push(a));if(V(a)){if("@type"in a){var i=a["@type"];0===i.indexOf("_:")&&(a["@type"]=i=e.getName(i))}return void(g&&g.push(a))}if("@type"in a)for(var j=a["@type"],h=0;h<j.length;++h){var i=j[h];0===i.indexOf("_:")&&e.getName(i)}S(f)&&(f=X(a)?e.getName(a["@id"]):a["@id"]),g&&g.push({"@id":f});var k=b[d],l=k[f]=k[f]||{};l["@id"]=f;for(var m=Object.keys(a).sort(),n=0;n<m.length;++n){var o=m[n];if("@id"!==o)if("@reverse"!==o)if("@graph"!==o)if("@type"!==o&&I(o)){if("@index"===o&&"@index"in l)throw new Cb("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:l});l[o]=a[o]}else{var q=a[o];if(0===o.indexOf("_:")&&(o=e.getName(o)),0!==q.length)for(var r=0;r<q.length;++r){var s=q[r];if("@type"===o&&(s=0===s.indexOf("_:")?e.getName(s):s),T(s)||U(s)){var t=X(s)?e.getName(s["@id"]):s["@id"];c.addValue(l,o,{"@id":t},{propertyIsArray:!0,allowDuplicate:!1}),p(s,b,d,e,t)}else if(W(s)){var u=[];p(s["@list"],b,d,e,f,u),s={"@list":u},c.addValue(l,o,s,{propertyIsArray:!0,allowDuplicate:!1})}else p(s,b,d,e,f),c.addValue(l,o,s,{propertyIsArray:!0,allowDuplicate:!1})}else c.addValue(l,o,[],{propertyIsArray:!0})}else{f in b||(b[f]={});var v="@merged"===d?d:f;p(a[o],b,v,e)}else{var w={"@id":f},x=a["@reverse"];for(var y in x)for(var z=x[y],A=0;A<z.length;++A){var B=z[A],C=B["@id"];X(B)&&(C=e.getName(C)),p(B,b,d,e,C),c.addValue(k[C],y,w,{propertyIsArray:!0,allowDuplicate:!1})}}}}}function q(a,b,d,e,f){s(a,d),d=d[0];var g=t(a,b,d),h=a.options,i=r(d,h,"embed"),j=r(d,h,"explicit"),k=Object.keys(g).sort();for(var l in k){var m=k[l];null===f&&(a.embeds={});var n={};n["@id"]=m;var o={parent:e,property:f};if(i&&m in a.embeds){i=!1;var p=a.embeds[m];if(L(p.parent)){for(var u=0;u<p.parent.length;++u)if(c.compareValues(n,p.parent[u])){i=!0;break}}else c.hasValue(p.parent,p.property,n)&&(i=!0);i&&w(a,m)}if(i){a.embeds[m]=o;for(var y=g[m],z=Object.keys(y).sort(),u=0;u<z.length;u++){var A=z[u];if(I(A))n[A]=Z(y[A]);else if(A in d)for(var B=y[A],C=0;C<B.length;++C){var D=B[C];if(W(D)){var E={"@list":[]};x(a,n,A,E);var F=D["@list"];for(var G in F)D=F[G],U(D)?q(a,[D["@id"]],d[A][0]["@list"],E,"@list"):x(a,E,"@list",Z(D))}else U(D)?q(a,[D["@id"]],d[A],n,A):x(a,n,A,Z(D))}else j||v(a,y,A,n)}for(var z=Object.keys(d).sort(),u=0;u<z.length;++u){var A=z[u];if(!I(A)){var H=d[A][0],J=r(H,h,"omitDefault");if(!(J||A in n)){var K="@null";"@default"in H&&(K=Z(H["@default"])),L(K)||(K=[K]),n[A]=[{"@preserve":K}]}}}x(a,e,f,n)}else x(a,e,f,n)}}function r(a,b,c){var d="@"+c;return d in a?a[d][0]:b[c]}function s(a,b){if(!L(b)||1!==b.length||!J(b[0]))throw new Cb("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:b})}function t(a,b,c){for(var d={},e=0;e<b.length;++e){var f=b[e],g=a.subjects[f];u(g,c)&&(d[f]=g)}return d}function u(a,b){if("@type"in b&&(1!==b["@type"].length||!J(b["@type"][0]))){for(var d=b["@type"],e=0;e<d.length;++e)if(c.hasValue(a,"@type",d[e]))return!0;return!1}for(var f in b)if(!("@id"!==f&&I(f)||f in a))return!1;return!0}function v(a,b,c,d){for(var e=b[c],f=0;f<e.length;++f){var g=e[f];if(W(g)){var h={"@list":[]};return x(a,d,c,h),v(a,g,"@list",h["@list"])}if(U(g)){var i=g["@id"];if(!(i in a.embeds)){var j={parent:d,property:c};a.embeds[i]=j,g={};var k=a.subjects[i];for(var l in k)I(l)?g[l]=Z(k[l]):v(a,k,l,g)}x(a,d,c,g)}else x(a,d,c,Z(g))}}function w(a,b){var d=a.embeds,e=d[b],f=e.parent,g=e.property,h={"@id":b};if(L(f)){for(var i=0;i<f.length;++i)if(c.compareValues(f[i],h)){f[i]=h;break}}else{var j=L(f[g]);c.removeValue(f,g,h,{propertyIsArray:j}),c.addValue(f,g,h,{propertyIsArray:j})}var k=function(a){for(var b=Object.keys(d),c=0;c<b.length;++c){var e=b[c];e in d&&J(d[e].parent)&&d[e].parent["@id"]===a&&(delete d[e],k(e))}};k(b)}function x(a,b,d,e){J(b)?c.addValue(b,d,e,{propertyIsArray:!0}):b.push(e)}function y(a,b,d){if(L(b)){for(var e=[],f=0;f<b.length;++f){var g=y(a,b[f],d);null!==g&&e.push(g)}b=e}else if(J(b)){if("@preserve"in b)return"@null"===b["@preserve"]?null:b["@preserve"];if(V(b))return b;if(W(b))return b["@list"]=y(a,b["@list"],d),b;for(var h in b){var g=y(a,b[h],d),i=c.getContextValue(a,h,"@container");d.compactArrays&&L(g)&&1===g.length&&null===i&&(g=g[0]),b[h]=g}}return b}function z(a,b){return a.length<b.length?-1:b.length<a.length?1:a===b?0:b>a?-1:1}function A(a,b,c,d,e,f){null===f&&(f="@null");var g=[];if("@id"!==f&&"@reverse"!==f||!U(c))g.push(f);else{"@reverse"===f&&g.push("@reverse");var h=B(a,c["@id"],null,{vocab:!0});h in a.mappings&&a.mappings[h]&&a.mappings[h]["@id"]===c["@id"]?g.push.apply(g,["@vocab","@id"]):g.push.apply(g,["@id","@vocab"])}g.push("@none");for(var i=a.inverse[b],j=0;j<d.length;++j){var k=d[j];if(k in i)for(var l=i[k][e],m=0;m<g.length;++m){var n=g[m];if(n in l)return l[n]}}return null}function B(a,b,c,d,e){if(null===b)return b;if(S(c)&&(c=null),S(e)&&(e=!1),d=d||{},I(b)&&(d.vocab=!0),d.vocab&&b in a.getInverse()){var f=a["@language"]||"@none",g=[];J(c)&&"@index"in c&&g.push("@index");var h="@language",i="@null";if(e)h="@type",i="@reverse",g.push("@set");else if(W(c)){"@index"in c||g.push("@list");for(var j=c["@list"],k=0===j.length?f:null,l=null,m=0;m<j.length;++m){var n=j[m],o="@none",p="@none";if(V(n)?"@language"in n?o=n["@language"]:"@type"in n?p=n["@type"]:o="@null":p="@id",null===k?k=o:o!==k&&V(n)&&(k="@none"),null===l?l=p:p!==l&&(l="@none"),"@none"===k&&"@none"===l)break}k=k||"@none",l=l||"@none","@none"!==l?(h="@type",i=l):i=k}else V(c)?"@language"in c&&!("@index"in c)?(g.push("@language"),i=c["@language"]):"@type"in c&&(h="@type",i=c["@type"]):(h="@type",i="@id"),g.push("@set");g.push("@none");var q=A(a,b,c,g,h,i);if(null!==q)return q}if(d.vocab&&"@vocab"in a){var r=a["@vocab"];if(0===b.indexOf(r)&&b!==r){var s=b.substr(r.length);if(!(s in a.mappings))return s}}var t=null;for(var q in a.mappings)if(-1===q.indexOf(":")){var u=a.mappings[q];if(u&&u["@id"]!==b&&0===b.indexOf(u["@id"])){var v=q+":"+b.substr(u["@id"].length),w=!(v in a.mappings)||null===c&&a.mappings[v]&&a.mappings[v]["@id"]===b;w&&(null===t||z(v,t)<0)&&(t=v)}}return null!==t?t:d.vocab?b:G(a["@base"],b)}function C(a,b,d){if(V(d)){var e=c.getContextValue(a,b,"@type"),f=c.getContextValue(a,b,"@language"),g=c.getContextValue(a,b,"@container"),h="@index"in d&&"@index"!==g;if(!h&&(d["@type"]===e||d["@language"]===f))return d["@value"];var i=Object.keys(d).length,j=1===i||2===i&&"@index"in d&&!h,k="@language"in a,l=N(d["@value"]),m=a.mappings[b]&&null===a.mappings[b]["@language"];if(j&&(!k||!l||m))return d["@value"];var n={};return h&&(n[B(a,"@index")]=d["@index"]),"@type"in d?n[B(a,"@type")]=B(a,d["@type"],null,{vocab:!0}):"@language"in d&&(n[B(a,"@language")]=d["@language"]),n[B(a,"@value")]=d["@value"],n}var o=E(a,b,{vocab:!0}),e=c.getContextValue(a,b,"@type"),p=B(a,d["@id"],null,{vocab:"@vocab"===e});if("@id"===e||"@vocab"===e||"@graph"===o)return p;var n={};return n[B(a,"@id")]=p,n}function D(a,b,c,d){if(c in d){if(d[c])return;throw new Cb("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:b,term:c})}if(d[c]=!1,I(c))throw new Cb("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:b});a.mappings[c]&&delete a.mappings[c];var e=b[c];if(null===e||J(e)&&null===e["@id"])return a.mappings[c]=null,void(d[c]=!0);if(N(e)&&(e={"@id":e}),!J(e))throw new Cb("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:b});var f=a.mappings[c]={};if(f.reverse=!1,"@reverse"in e){if("@id"in e)throw new Cb("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:b});var g=e["@reverse"];if(!N(g))throw new Cb("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});var h=E(a,g,{vocab:!0,base:!1},b,d);if(!Y(h))throw new Cb("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});f["@id"]=h,f.reverse=!0}else if("@id"in e){var h=e["@id"];if(!N(h))throw new Cb("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});if(h!==c){if(h=E(a,h,{vocab:!0,base:!1},b,d),!Y(h)&&!I(h))throw new Cb("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});f["@id"]=h}}if(!("@id"in f)){var i=c.indexOf(":");if(-1!==i){var j=c.substr(0,i);if(j in b&&D(a,b,j,d),a.mappings[j]){var k=c.substr(i+1);f["@id"]=a.mappings[j]["@id"]+k}else f["@id"]=c}else{if(!("@vocab"in a))throw new Cb("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b,term:c});f["@id"]=a["@vocab"]+c}}if(d[c]=!0,"@type"in e){var l=e["@type"];if(!N(l))throw new Cb("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:b});if("@id"!==l&&"@vocab"!==l){if(l=E(a,l,{vocab:!0,base:!1},b,d),!Y(l))throw new Cb("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:b});if(0===l.indexOf("_:"))throw new Cb("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:b})}f["@type"]=l}if("@container"in e){var m=e["@container"];if("@list"!==m&&"@set"!==m&&"@index"!==m&&"@language"!==m)throw new Cb("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:b});
if(f.reverse&&"@index"!==m&&"@set"!==m&&null!==m)throw new Cb("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:b});f["@container"]=m}if("@language"in e&&!("@type"in e)){var n=e["@language"];if(null!==n&&!N(n))throw new Cb("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:b});null!==n&&(n=n.toLowerCase()),f["@language"]=n}var h=f["@id"];if("@context"===h||"@preserve"===h)throw new Cb("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:b})}function E(a,b,c,d,e){if(null===b||I(b))return b;if(d&&b in d&&e[b]!==!0&&D(a,d,b,e),c=c||{},c.vocab){var f=a.mappings[b];if(null===f)return null;if(f)return f["@id"]}var g=b.indexOf(":");if(-1!==g){var h=b.substr(0,g),i=b.substr(g+1);if("_"===h||0===i.indexOf("//"))return b;d&&h in d&&D(a,d,h,e);var f=a.mappings[h];return f?f["@id"]+i:b}if(c.vocab&&"@vocab"in a)return a["@vocab"]+b;var j=b;return c.base&&(j=F(a["@base"],j)),j}function F(a,b){if(null===a)return b;if(-1!==b.indexOf(":"))return b;N(a)&&(a=c.url.parse(a||""));var d=c.url.parse(b),e=a.protocol||"";d.authority?e+="//"+d.authority:""!==a.href&&(e+="//"+a.authority);var f;0===d.pathname.indexOf("/")?f=d.pathname:(f=a.pathname,""!==d.pathname&&(f=f.substr(0,f.lastIndexOf("/")+1),f.length>0&&"/"!==f.substr(-1)&&(f+="/"),f+=d.pathname)),f=gb(f,""!==e),d.query&&(f+="?"+d.query),d.hash&&(f+=d.hash);var g=e+f;return""===g&&(g="./"),g}function G(a,b){if(null===a)return b;N(a)&&(a=c.url.parse(a||""));var d="";if(""!==a.href?d+=(a.protocol||"")+"//"+a.authority:b.indexOf("//")&&(d+="//"),0!==b.indexOf(d))return b;for(var e=c.url.parse(b.substr(d.length)),f=a.normalizedPath.split("/"),g=e.normalizedPath.split("/"),h=e.hash||e.query?0:1;f.length>0&&g.length>h&&f[0]===g[0];)f.shift(),g.shift();var i="";if(f.length>0){f.pop();for(var j=0;j<f.length;++j)i+="../"}return i+=g.join("/"),e.query&&(i+="?"+e.query),e.hash&&(i+=e.hash),""===i&&(i="./"),i}function H(a){function b(){var a=this;if(a.inverse)return a.inverse;for(var b=a.inverse={},c=a["@language"]||"@none",e=a.mappings,f=Object.keys(e).sort(z),g=0;g<f.length;++g){var h=f[g],i=e[h];if(null!==i){var j=i["@container"]||"@none",k=i["@id"];L(k)||(k=[k]);for(var l=0;l<k.length;++l){var m=k[l],n=b[m];if(n||(b[m]=n={}),n[j]||(n[j]={"@language":{},"@type":{}}),n=n[j],i.reverse)d(i,h,n["@type"],"@reverse");else if("@type"in i)d(i,h,n["@type"],i["@type"]);else if("@language"in i){var o=i["@language"]||"@null";d(i,h,n["@language"],o)}else d(i,h,n["@language"],c),d(i,h,n["@type"],"@none"),d(i,h,n["@language"],"@none")}}}return b}function d(a,b,c,d){d in c||(c[d]=b)}function e(){var a={};return a["@base"]=this["@base"],a.mappings=Z(this.mappings),a.clone=this.clone,a.inverse=null,a.getInverse=this.getInverse,"@language"in this&&(a["@language"]=this["@language"]),"@vocab"in this&&(a["@vocab"]=this["@vocab"]),a}var f=c.url.parse(a.base||"");return{"@base":f,mappings:{},inverse:null,getInverse:b,clone:e}}function I(a){if(!N(a))return!1;switch(a){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function J(a){return"[object Object]"===Object.prototype.toString.call(a)}function K(a){return J(a)&&0===Object.keys(a).length}function L(a){return Array.isArray(a)}function M(a){if(!N(a)&&!K(a)){var b=!1;if(L(a)){b=!0;for(var c=0;c<a.length;++c)if(!N(a[c])){b=!1;break}}if(!b)throw new Cb('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:a})}}function N(a){return"string"==typeof a||"[object String]"===Object.prototype.toString.call(a)}function O(a){return"number"==typeof a||"[object Number]"===Object.prototype.toString.call(a)}function P(a){return O(a)&&-1!==String(a).indexOf(".")}function Q(a){return!isNaN(parseFloat(a))&&isFinite(a)}function R(a){return"boolean"==typeof a||"[object Boolean]"===Object.prototype.toString.call(a)}function S(a){return"undefined"==typeof a}function T(a){var b=!1;if(J(a)&&!("@value"in a||"@set"in a||"@list"in a)){var c=Object.keys(a).length;b=c>1||!("@id"in a)}return b}function U(a){return J(a)&&1===Object.keys(a).length&&"@id"in a}function V(a){return J(a)&&"@value"in a}function W(a){return J(a)&&"@list"in a}function X(a){var b=!1;return J(a)&&(b="@id"in a?0===a["@id"].indexOf("_:"):0===Object.keys(a).length||!("@value"in a||"@set"in a||"@list"in a)),b}function Y(a){return N(a)&&-1!==a.indexOf(":")}function Z(a){if(a&&"object"==typeof a){var b;if(L(a)){b=[];for(var c=0;c<a.length;++c)b[c]=Z(a[c])}else{b={};for(var d in a)b[d]=Z(a[d])}return b}return a}function $(a,b,c,d){var e=Object.keys(b).length;if(L(a)){for(var f=0;f<a.length;++f)$(a[f],b,c,d);return e<Object.keys(b).length}if(J(a)){for(var g in a)if("@context"===g){var h=a[g];if(L(h))for(var i=h.length,f=0;i>f;++f){var j=h[f];N(j)&&(j=F(d,j),c?(j=b[j],L(j)?(Array.prototype.splice.apply(h,[f,1].concat(j)),f+=j.length,i+=j.length):h[f]=j):j in b||(b[j]=!1))}else N(h)&&(h=F(d,h),c?a[g]=b[h]:h in b||(b[h]=!1))}else $(a[g],b,c,d);return e<Object.keys(b).length}return!1}function _(a,b,c){var d=null,e=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,f=b.documentLoader,g=function(a,b,c,f,h){if(Object.keys(b).length>Bb)return d=new Cb("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:Bb}),h(d);var i={},j=function(){$(a,i,!0,f),h(null,a)};$(a,i,!1,f)||j();var k=[];for(var l in i)if(i[l]===!1){if(!e.test(l))return d=new Cb("Malformed URL.","jsonld.InvalidUrl",{code:"loading remote context failed",url:l}),h(d);k.push(l)}for(var m=k.length,n=0;n<k.length;++n)!function(a){if(a in b)return d=new Cb("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:a}),h(d);var e=Z(b);e[a]=!0;var f=function(b,f){if(!d){var k=f?f.document:null;if(!b&&N(k))try{k=JSON.parse(k)}catch(l){b=l}if(b?b=new Cb("Derefencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:a,cause:b}):J(k)||(b=new Cb("Derefencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:a,cause:b})),b)return d=b,h(d);k="@context"in k?{"@context":k["@context"]}:{"@context":{}},f.contextUrl&&(L(k["@context"])||(k["@context"]=[k["@context"]]),k["@context"].push(f.contextUrl)),g(k,e,c,a,function(b,c){return b?h(b):(i[a]=c["@context"],m-=1,void(0===m&&j()))})}},k=c(a,f);k&&"then"in k&&k.then(f.bind(null,null),f)}(k[n])};g(a,{},f,b.base,c)}function ab(a){for(var b="(?:<([^:]+:[^>]*)>)",c="(_:(?:[A-Za-z0-9]+))",d='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"',e="(?:\\^\\^"+b+")",f="(?:@([a-z]+(?:-[a-z0-9]+)*))",g="(?:"+d+"(?:"+e+"|"+f+")?)",h="[ \\t]+",i="[ \\t]*",j=/(?:\r\n)|(?:\n)|(?:\r)/g,k=new RegExp("^"+i+"$"),m="(?:"+b+"|"+c+")"+h,n=b+h,o="(?:"+b+"|"+c+"|"+g+")"+i,p="(?:\\.|(?:(?:"+b+"|"+c+")"+i+"\\.))",q=new RegExp("^"+i+m+n+o+p+i+"$"),r={},s=a.split(j),t=0,u=0;u<s.length;++u){var v=s[u];if(t++,!k.test(v)){var w=v.match(q);if(null===w)throw new Cb("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:t});var x={};if(x.subject=S(w[1])?{type:"blank node",value:w[2]}:{type:"IRI",value:w[1]},x.predicate={type:"IRI",value:w[3]},S(w[4]))if(S(w[5])){x.object={type:"literal"},S(w[7])?S(w[8])?x.object.datatype=pb:(x.object.datatype=zb,x.object.language=w[8]):x.object.datatype=w[7];var y=w[6].replace(/\\"/g,'"').replace(/\\t/g,"	").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");x.object.value=y}else x.object={type:"blank node",value:w[5]};else x.object={type:"IRI",value:w[4]};var z="@default";if(S(w[9])?S(w[10])||(z=w[10]):z=w[9],z in r){for(var A=!0,B=r[z],C=0;A&&C<B.length;++C)l(B[C],x)&&(A=!1);A&&B.push(x)}else r[z]=[x]}}return r}function bb(a){var b=[];for(var c in a)for(var d=a[c],e=0;e<d.length;++e){var f=d[e];"@default"===c&&(c=null),b.push(cb(f,c))}return b.sort(),b.join("")}function cb(a,b,c){var d=a.subject,e=a.predicate,f=a.object,g=b,h="";if(h+="IRI"===d.type?"<"+d.value+">":c?d.value===c?"_:a":"_:z":d.value,h+=" ",h+="IRI"===e.type?"<"+e.value+">":c?"_:p":e.value,h+=" ","IRI"===f.type)h+="<"+f.value+">";else if("blank node"===f.type)h+=c?f.value===c?"_:a":"_:z":f.value;else{var i=f.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"');h+='"'+i+'"',f.datatype===zb?f.language&&(h+="@"+f.language):f.datatype!==pb&&(h+="^^<"+f.datatype+">")}return null!==g&&(h+=0!==g.indexOf("_:")?" <"+g+">":c?" _:g":" "+g),h+=" .\n"}function db(a){var b={};b["@default"]=[];for(var c=a.getSubjects(),d=0;d<c.length;++d){var e=c[d];if(null!==e){var f=a.getSubjectTriples(e);if(null!==f){var g=f.predicates;for(var h in g)for(var i=g[h].objects,j=0;j<i.length;++j){var k=i[j],l={};l.subject=0===e.indexOf("_:")?{type:"blank node",value:e}:{type:"IRI",value:e},l.predicate=0===h.indexOf("_:")?{type:"blank node",value:h}:{type:"IRI",value:h};var m=k.value;if(k.type===xb){kb||Ib();var n=new kb;m="";for(var o=0;o<k.value.length;o++)k.value[o].nodeType===lb.ELEMENT_NODE?m+=n.serializeToString(k.value[o]):k.value[o].nodeType===lb.TEXT_NODE&&(m+=k.value[o].nodeValue)}l.object={},k.type===yb?l.object.type=0===k.value.indexOf("_:")?"blank node":"IRI":(l.object.type="literal",k.type===wb?k.language?(l.object.datatype=zb,l.object.language=k.language):l.object.datatype=pb:l.object.datatype=k.type),l.object.value=m,b["@default"].push(l)}}}}return b}function eb(a){this.prefix=a,this.counter=0,this.existing={}}function fb(a){if(-1!==a.href.indexOf(":")||0!==a.href.indexOf("//")||a.host)a.authority=a.host||"",a.auth&&(a.authority=a.auth+"@"+a.authority);else{a.pathname=a.pathname.substr(2);var b=a.pathname.indexOf("/");-1===b?(a.authority=a.pathname,a.pathname=""):(a.authority=a.pathname.substr(0,b),a.pathname=a.pathname.substr(b))}}function gb(a,b){var c="";0===a.indexOf("/")&&(c="/");for(var d=a.split("/"),e=[];d.length>0;)"."===d[0]||""===d[0]&&d.length>1?d.shift():".."!==d[0]?e.push(d.shift()):(d.shift(),b||e.length>0&&".."!==e[e.length-1]?e.pop():e.push(".."));return c+e.join("/")}c.compact=function(a,b,d,e){function f(a,c,d,f){if(a)return e(a);f.compactArrays&&!f.graph&&L(c)?1===c.length?c=c[0]:0===c.length&&(c={}):f.graph&&J(c)&&(c=[c]),J(b)&&"@context"in b&&(b=b["@context"]),b=Z(b),L(b)||(b=[b]);var g=b;b=[];for(var h=0;h<g.length;++h)(!J(g[h])||Object.keys(g[h]).length>0)&&b.push(g[h]);var i=b.length>0;if(1===b.length&&(b=b[0]),L(c)){var j=B(d,"@graph"),k=c;c={},i&&(c["@context"]=b),c[j]=k}else if(J(c)&&i){var k=c;c={"@context":b};for(var l in k)c[l]=k[l]}e(null,c,d)}if(arguments.length<2)return c.nextTick(function(){e(new TypeError("Could not compact, too few arguments."))});if("function"==typeof d&&(e=d,d={}),d=d||{},null===b)return c.nextTick(function(){e(new Cb("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))});if(null===a)return c.nextTick(function(){e(null,null)});"base"in d||(d.base="string"==typeof a?a:""),"compactArrays"in d||(d.compactArrays=!0),"graph"in d||(d.graph=!1),"skipExpansion"in d||(d.skipExpansion=!1),"documentLoader"in d||(d.documentLoader=c.loadDocument);var g=function(a,b,d){c.nextTick(function(){return b.skipExpansion?d(null,a):void c.expand(a,b,d)})};g(a,d,function(a,g){if(a)return e(new Cb("Could not expand input before compaction.","jsonld.CompactError",{cause:a}));var h=H(d);c.processContext(h,b,d,function(a,b){if(a)return e(new Cb("Could not process context before compaction.","jsonld.CompactError",{cause:a}));var c;try{c=(new Db).compact(b,null,g,d)}catch(h){return e(h)}f(null,c,b,d)})})},c.expand=function(a,b,d){function e(a){"base"in b||(b.base=a.documentUrl||"");var c={document:Z(a.document),remoteContext:{"@context":a.contextUrl}};if("expandContext"in b){var e=Z(b.expandContext);c.expandContext="object"==typeof e&&"@context"in e?e:{"@context":e}}_(c,b,function(a,c){if(a)return d(a);var e;try{var f=new Db,g=H(b),h=c.document,i=c.remoteContext["@context"];c.expandContext&&(g=f.processContext(g,c.expandContext["@context"],b)),i&&(g=f.processContext(g,i,b)),e=f.expand(g,null,h,b,!1),J(e)&&"@graph"in e&&1===Object.keys(e).length?e=e["@graph"]:null===e&&(e=[]),L(e)||(e=[e])}catch(j){return d(j)}d(null,e)})}return arguments.length<1?c.nextTick(function(){d(new TypeError("Could not expand, too few arguments."))}):("function"==typeof b&&(d=b,b={}),b=b||{},"documentLoader"in b||(b.documentLoader=c.loadDocument),"keepFreeFloatingNodes"in b||(b.keepFreeFloatingNodes=!1),void c.nextTick(function(){if("string"==typeof a){var c=function(a,b){if(a)return d(a);try{if(!b.document)throw new Cb("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof b.document&&(b.document=JSON.parse(b.document))}catch(c){return d(new Cb("Could not retrieve a JSON-LD document from the URL. URL derefencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:c,remoteDoc:b}))}e(b)},f=b.documentLoader(a,c);return void(f&&"then"in f&&f.then(c.bind(null,null),c))}e({contextUrl:null,documentUrl:null,document:a})}))},c.flatten=function(a,b,d,e){return arguments.length<1?c.nextTick(function(){e(new TypeError("Could not flatten, too few arguments."))}):("function"==typeof d?(e=d,d={}):"function"==typeof b&&(e=b,b=null,d={}),d=d||{},"base"in d||(d.base="string"==typeof a?a:""),"documentLoader"in d||(d.documentLoader=c.loadDocument),void c.expand(a,d,function(a,f){if(a)return e(new Cb("Could not expand input before flattening.","jsonld.FlattenError",{cause:a}));var g;try{g=(new Db).flatten(f)}catch(h){return e(h)}return null===b?e(null,g):(d.graph=!0,d.skipExpansion=!0,void c.compact(g,b,d,function(a,b){return a?e(new Cb("Could not compact flattened output.","jsonld.FlattenError",{cause:a})):void e(null,b)}))}))},c.frame=function(a,b,d,e){function f(b){var f,g=b.document;g?(f=g["@context"]||{},b.contextUrl&&(f?L(f)?f.push(b.contextUrl):f=[f,b.contextUrl]:f=b.contextUrl,g["@context"]=f)):f={},c.expand(a,d,function(a,b){if(a)return e(new Cb("Could not expand input before framing.","jsonld.FrameError",{cause:a}));var h=Z(d);h.isFrame=!0,h.keepFreeFloatingNodes=!0,c.expand(g,h,function(a,d){if(a)return e(new Cb("Could not expand frame before framing.","jsonld.FrameError",{cause:a}));var g;try{g=(new Db).frame(b,d,h)}catch(i){return e(i)}h.graph=!0,h.skipExpansion=!0,c.compact(g,f,h,function(a,b,c){if(a)return e(new Cb("Could not compact framed output.","jsonld.FrameError",{cause:a}));var d=B(c,"@graph");b[d]=y(c,b[d],h),e(null,b)})})})}return arguments.length<2?c.nextTick(function(){e(new TypeError("Could not frame, too few arguments."))}):("function"==typeof d&&(e=d,d={}),d=d||{},"base"in d||(d.base="string"==typeof a?a:""),"documentLoader"in d||(d.documentLoader=c.loadDocument),"embed"in d||(d.embed=!0),d.explicit=d.explicit||!1,d.omitDefault=d.omitDefault||!1,void c.nextTick(function(){if("string"==typeof b){var a=function(a,b){if(a)return e(a);try{if(!b.document)throw new Cb("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof b.document&&(b.document=JSON.parse(b.document))}catch(c){return e(new Cb("Could not retrieve a JSON-LD document from the URL. URL derefencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:c,remoteDoc:b}))}f(b)},c=d.documentLoader(b,a);return void(c&&"then"in c&&c.then(a.bind(null,null),a))}f({contextUrl:null,documentUrl:null,document:b})}))},c.objectify=function(a,b,d,e){"function"==typeof d&&(e=d,d={}),d=d||{},"base"in d||(d.base="string"==typeof a?a:""),"documentLoader"in d||(d.documentLoader=c.loadDocument),c.expand(a,d,function(a,f){if(a)return e(new Cb("Could not expand input before framing.","jsonld.FrameError",{cause:a}));var g;try{g=(new Db).flatten(f)}catch(h){return e(h)}d.graph=!0,d.skipExpansion=!0,c.compact(g,b,d,function(a,b,f){if(a)return e(new Cb("Could not compact flattened output.","jsonld.FrameError",{cause:a}));var g=B(f,"@graph");b[g]=y(f,b[g],d);var h=b[g][0],i=function(a){if(J(a)||L(a)){if(J(a)){if(i.visited[a["@id"]])return;i.visited[a["@id"]]=!0}for(var b in a){var d=a[b],e="@id"===c.getContextValue(f,b,"@type");if(L(d)||J(d)||e)if(N(d)&&e)a[b]=d=h[d],i(d);else if(L(d))for(var g=0;g<d.length;++g)N(d[g])&&e?d[g]=h[d[g]]:J(d[g])&&"@id"in d[g]&&(d[g]=h[d[g]["@id"]]),i(d[g]);else if(J(d)){var j=d["@id"];a[b]=d=h[j],i(d)}}}};i.visited={},i(h),b.of_type={};for(var j in h)if("@type"in h[j]){var k=h[j]["@type"];L(k)||(k=[k]);for(var l in k)k[l]in b.of_type||(b.of_type[k[l]]=[]),b.of_type[k[l]].push(h[j])}e(null,b)})})},c.normalize=function(a,b,d){if(arguments.length<1)return c.nextTick(function(){d(new TypeError("Could not normalize, too few arguments."))});"function"==typeof b&&(d=b,b={}),b=b||{},"base"in b||(b.base="string"==typeof a?a:""),"documentLoader"in b||(b.documentLoader=c.loadDocument);var e=Z(b);delete e.format,e.produceGeneralizedRdf=!1,c.toRDF(a,e,function(a,c){return a?d(new Cb("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:a})):void(new Db).normalize(c,b,d)})},c.fromRDF=function(a,b,d){return arguments.length<1?c.nextTick(function(){d(new TypeError("Could not convert from RDF, too few arguments."))}):("function"==typeof b&&(d=b,b={}),b=b||{},"useRdfType"in b||(b.useRdfType=!1),"useNativeTypes"in b||(b.useNativeTypes=!1),"format"in b||!N(a)||"format"in b||(b.format="application/nquads"),void c.nextTick(function(){function c(a,b,c){(new Db).fromRDF(a,b,c)}var e;if(b.format){if(e=b.rdfParser||jb[b.format],!e)throw new Cb("Unknown input format.","jsonld.UnknownFormat",{format:b.format})}else e=function(){return a};if(a=e(a,function(a,e){return a?d(a):void c(e,b,d)})){if("then"in a)return a.then(function(a){c(a,b,d)},d);c(a,b,d)}}))},c.toRDF=function(a,b,d){return arguments.length<1?c.nextTick(function(){d(new TypeError("Could not convert to RDF, too few arguments."))}):("function"==typeof b&&(d=b,b={}),b=b||{},"base"in b||(b.base="string"==typeof a?a:""),"documentLoader"in b||(b.documentLoader=c.loadDocument),void c.expand(a,b,function(a,c){if(a)return d(new Cb("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:a}));var e;try{if(e=Db.prototype.toRDF(c,b),b.format){if("application/nquads"===b.format)return d(null,bb(e));throw new Cb("Unknown output format.","jsonld.UnknownFormat",{format:b.format})}}catch(f){return d(f)}d(null,e)}))},c.relabelBlankNodes=function(a){f(new eb("_:b",a))},c.documentLoader=function(b,d){var e=new Cb("Could not retrieve a JSON-LD document from the URL. URL derefencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return a?d(e,{contextUrl:null,documentUrl:b,document:null}):c.promisify(function(a){a(e)})},c.loadDocument=function(a,b){var d=c.documentLoader(a,b);d&&"then"in d&&d.then(b.bind(null,null),b)},c.promises=function(){var a=Array.prototype.slice,b=c.promisify,d={};return d.expand=function(){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");return b.apply(null,[c.expand].concat(a.call(arguments)))},d.compact=function(){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");var d=function(a,b,d,e){c.compact(a,b,d,function(a,b){e(a,b)})};return b.apply(null,[d].concat(a.call(arguments)))},d.flatten=function(){if(arguments.length<1)throw new TypeError("Could not flatten, too few arguments.");return b.apply(null,[c.flatten].concat(a.call(arguments)))},d.frame=function(){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");return b.apply(null,[c.frame].concat(a.call(arguments)))},d.fromRDF=function(){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");return b.apply(null,[c.fromRDF].concat(a.call(arguments)))},d.toRDF=function(){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");return b.apply(null,[c.toRDF].concat(a.call(arguments)))},d.normalize=function(){if(arguments.length<1)throw new TypeError("Could not normalize, too few arguments.");return b.apply(null,[c.normalize].concat(a.call(arguments)))},d},c.promisify=function(b){var c=a?require("./Promise").Promise:global.Promise,d=Array.prototype.slice.call(arguments,1);return new c(function(a){b.apply(null,d.concat(function(b,c){b?a.reject(b):a.resolve(c)}))})},d.prototype=c.promises(),d.prototype.toString=function(){return this instanceof d?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},c.JsonLdProcessor=d;var hb=!!Object.defineProperty;if(hb)try{Object.defineProperty({},"x",{})}catch(ib){hb=!1}hb&&(Object.defineProperty(d,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(d.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:d})),b&&"undefined"==typeof global.JsonLdProcessor&&(hb?Object.defineProperty(global,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:d}):global.JsonLdProcessor=d),"undefined"!=typeof process&&process.nextTick?(c.nextTick=process.nextTick,c.setImmediate="function"==typeof setImmediate?setImmediate:c.nextTick):"function"==typeof setImmediate?(c.setImmediate=setImmediate,c.nextTick=function(a){return setImmediate(a)}):(c.setImmediate=function(a){setTimeout(a,0)},c.nextTick=c.setImmediate),c.parseLinkHeader=function(a){for(var b={},c=a.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g),d=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,e=0;e<c.length;++e){var f=c[e].match(d);if(f){for(var g={target:f[1]},h=f[2],i=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;f=i.exec(h);)g[f[1]]=void 0===f[2]?f[3]:f[2];var j=g.rel||"";L(b[j])?b[j].push(g):b[j]=j in b?[b[j],g]:g}}return b},c.DocumentCache=function(a){this.order=[],this.cache={},this.size=a||50,this.expires=3e4},c.DocumentCache.prototype.get=function(a){if(a in this.cache){var b=this.cache[a];if(b.expires>=+new Date)return b.ctx;delete this.cache[a],this.order.splice(this.order.indexOf(a),1)}return null},c.DocumentCache.prototype.set=function(a,b){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(a),this.cache[a]={ctx:b,expires:+new Date+this.expires}},c.ActiveContextCache=function(a){this.order=[],this.cache={},this.size=a||100},c.ActiveContextCache.prototype.get=function(a,b){var c=JSON.stringify(a),d=JSON.stringify(b),e=this.cache[c];return e&&d in e?e[d]:null},c.ActiveContextCache.prototype.set=function(a,b,c){if(this.order.length===this.size){var d=this.order.shift();delete this.cache[d.activeCtx][d.localCtx]}var e=JSON.stringify(a),f=JSON.stringify(b);this.order.push({activeCtx:e,localCtx:f}),e in this.cache||(this.cache[e]={}),this.cache[e][f]=Z(c)},c.cache={activeCtx:new c.ActiveContextCache},c.documentLoaders={},c.documentLoaders.jquery=function(a,b){b=b||{};var d=new c.DocumentCache,e=function(e,f){if(b.secure&&0!==e.indexOf("https"))return f(new Cb('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:e}),{contextUrl:null,documentUrl:e,document:null});var g=d.get(e);return null!==g?f(null,g):void a.ajax({url:e,dataType:"json",crossDomain:!0,success:function(a,b,g){var h={contextUrl:null,documentUrl:e,document:a},i=g.getResponseHeader("Content-Type"),j=g.getResponseHeader("Link");if(j&&"application/ld+json"!==i){if(j=c.parseLinkHeader(j)[Ab],L(j))return f(new Cb("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:e}),h);j&&(h.contextUrl=j.target)}d.set(e,h),f(null,h)},error:function(a,b,c){f(new Cb("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:e,cause:c}),{contextUrl:null,documentUrl:e,document:null})}})},f="undefined"!=typeof Promise;return"usePromise"in b&&(f=b.usePromise),f?function(a){return c.promisify(e,a)}:e},c.documentLoaders.node=function(a){function b(h,i,j){if(a.secure&&0!==h.indexOf("https"))return j(new Cb('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:h}),{contextUrl:null,documentUrl:h,document:null});var k=g.get(h);return null!==k?j(null,k):void e({url:h,strictSSL:!0,followRedirect:!1},function(a,e,l){if(k={contextUrl:null,documentUrl:h,document:l||null},a)return j(new Cb("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:h,cause:a}),k);var m=f.STATUS_CODES[e.statusCode];if(e.statusCode>=400)return j(new Cb("URL could not be dereferenced: "+m,"jsonld.InvalidUrl",{code:"loading document failed",url:h,httpStatusCode:e.statusCode}),k);if(e.headers.link&&"application/ld+json"!==e.headers["content-type"]){var n=c.parseLinkHeader(e.headers.link)[Ab];if(L(n))return j(new Cb("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:h}),k);n&&(k.contextUrl=n.target)}if(e.statusCode>=300&&e.statusCode<400&&e.headers.location)return i.length===d?j(new Cb("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:h,httpStatusCode:e.statusCode,redirects:i}),k):-1!==i.indexOf(h)?j(new Cb("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:h,httpStatusCode:e.statusCode,redirects:i}),k):(i.push(h),b(e.headers.location,i,j));i.push(h);for(var o=0;o<i.length;++o)g.set(i[o],{contextUrl:null,documentUrl:i[o],document:l});j(a,k)})}a=a||{};var d="maxRedirects"in a?a.maxRedirects:-1,e=require("request"),f=require("http"),g=new c.DocumentCache,h=function(a,c){b(a,[],c)};return a.usePromise?function(a){return c.promisify(h,a)}:h},c.documentLoaders.xhr=function(a){var b=/(^|(\r\n))link:/i;a=a||{};var d=new c.DocumentCache,e=function(e,f){if(a.secure&&0!==e.indexOf("https"))return f(new Cb('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:e}),{contextUrl:null,documentUrl:e,document:null});var g=d.get(e);if(null!==g)return f(null,g);var h=a.xhr||XMLHttpRequest,i=new h;i.onload=function(){var a,g={contextUrl:null,documentUrl:e,document:i.response},h=i.getResponseHeader("Content-Type");if(b.test(i.getAllResponseHeaders())&&(a=i.getResponseHeader("Link")),a&&"application/ld+json"!==h){if(a=c.parseLinkHeader(a)[Ab],L(a))return f(new Cb("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:e}),g);a&&(g.contextUrl=a.target)}d.set(e,g),f(null,g)},i.onerror=function(){f(new Cb("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:e}),{contextUrl:null,documentUrl:e,document:null})},i.open("GET",e,!0),i.send()},f="undefined"!=typeof Promise;return"usePromise"in a&&(f=a.usePromise),f?function(a){return c.promisify(e,a)}:e},c.useDocumentLoader=function(a){if(!(a in c.documentLoaders))throw new Cb('Unknown document loader type: "'+a+'"',"jsonld.UnknownDocumentLoader",{type:a});c.documentLoader=c.documentLoaders[a].apply(c,Array.prototype.slice.call(arguments,1))},c.processContext=function(a,b){var d={},e=2;arguments.length>3&&(d=arguments[2]||{},e+=1);var f=arguments[e];return"base"in d||(d.base=""),"documentLoader"in d||(d.documentLoader=c.loadDocument),null===b?f(null,H(d)):(b=Z(b),(N(b)||J(b)&&!("@context"in b))&&(b={"@context":b}),void _(b,d,function(b,c){if(b)return f(b);try{c=(new Db).processContext(a,c,d)}catch(e){return f(e)}f(null,c)}))},c.hasProperty=function(a,b){var c=!1;if(b in a){var d=a[b];c=!L(d)||d.length>0}return c},c.hasValue=function(a,b,d){var e=!1;if(c.hasProperty(a,b)){var f=a[b],g=W(f);if(L(f)||g){g&&(f=f["@list"]);for(var h=0;h<f.length;++h)if(c.compareValues(d,f[h])){e=!0;break}}else L(d)||(e=c.compareValues(d,f))}return e},c.addValue=function(a,b,d,e){if(e=e||{},"propertyIsArray"in e||(e.propertyIsArray=!1),"allowDuplicate"in e||(e.allowDuplicate=!0),L(d)){0!==d.length||!e.propertyIsArray||b in a||(a[b]=[]);for(var f=0;f<d.length;++f)c.addValue(a,b,d[f],e)}else if(b in a){var g=!e.allowDuplicate&&c.hasValue(a,b,d);L(a[b])||g&&!e.propertyIsArray||(a[b]=[a[b]]),g||a[b].push(d)}else a[b]=e.propertyIsArray?[d]:d},c.getValues=function(a,b){var c=a[b]||[];return L(c)||(c=[c]),c},c.removeProperty=function(a,b){delete a[b]},c.removeValue=function(a,b,d,e){e=e||{},"propertyIsArray"in e||(e.propertyIsArray=!1);var f=c.getValues(a,b).filter(function(a){return!c.compareValues(a,d)});0===f.length?c.removeProperty(a,b):a[b]=1!==f.length||e.propertyIsArray?f:f[0]},c.compareValues=function(a,b){return a===b?!0:V(a)&&V(b)&&a["@value"]===b["@value"]&&a["@type"]===b["@type"]&&a["@language"]===b["@language"]&&a["@index"]===b["@index"]?!0:J(a)&&"@id"in a&&J(b)&&"@id"in b?a["@id"]===b["@id"]:!1},c.getContextValue=function(a,b,c){var d=null;if(null===b)return d;if("@language"===c&&c in a&&(d=a[c]),a.mappings[b]){var e=a.mappings[b];S(c)?d=e:c in e&&(d=e[c])}return d};var jb={};if(c.registerRDFParser=function(a,b){jb[a]=b},c.unregisterRDFParser=function(a){delete jb[a]},a){if("undefined"==typeof kb)var kb=null;if("undefined"==typeof lb)var lb={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var mb="http://www.w3.org/2001/XMLSchema#boolean",nb="http://www.w3.org/2001/XMLSchema#double",ob="http://www.w3.org/2001/XMLSchema#integer",pb="http://www.w3.org/2001/XMLSchema#string",qb="http://www.w3.org/1999/02/22-rdf-syntax-ns#",rb=qb+"List",sb=qb+"first",tb=qb+"rest",ub=qb+"nil",vb=qb+"type",wb=qb+"PlainLiteral",xb=qb+"XMLLiteral",yb=qb+"object",zb=qb+"langString",Ab="http://www.w3.org/ns/json-ld#context",Bb=10,Cb=function(b,c,d){a&&(Error.call(this),Error.captureStackTrace(this,this.constructor)),this.name=c||"jsonld.Error",this.message=b||"An unspecified JSON-LD error occurred.",this.details=d||{}};a&&require("util").inherits(Cb,Error);var Db=function(){};Db.prototype.compact=function(a,b,d,e){if(L(d)){for(var f=[],g=0;g<d.length;++g){var h=this.compact(a,b,d[g],e);null!==h&&f.push(h)}if(e.compactArrays&&1===f.length){var i=c.getContextValue(a,b,"@container");null===i&&(f=f[0])}return f}if(J(d)){if(V(d)||U(d))return C(a,b,d);for(var j="@reverse"===b,k=Object.keys(d).sort(),f={},l=0;l<k.length;++l){var m=k[l],n=d[m];if("@id"!==m&&"@type"!==m)if("@reverse"!==m)if("@index"!==m){if(0===n.length){var o=B(a,m,n,{vocab:!0},j);c.addValue(f,o,n,{propertyIsArray:!0})}for(var p=0;p<n.length;++p){var q=n[p],o=B(a,m,q,{vocab:!0},j),i=c.getContextValue(a,o,"@container"),r=W(q),s=null;r&&(s=q["@list"]);var t=this.compact(a,o,r?s:q,e);if(r)if(L(t)||(t=[t]),"@list"!==i){var u={};u[B(a,"@list")]=t,t=u,"@index"in q&&(t[B(a,"@index")]=q["@index"])}else if(o in f)throw new Cb('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});
if("@language"===i||"@index"===i){var v;o in f?v=f[o]:f[o]=v={},"@language"===i&&V(t)&&(t=t["@value"]),c.addValue(v,q[i],t)}else{var w=!e.compactArrays||"@set"===i||"@list"===i||L(t)&&0===t.length||"@list"===m||"@graph"===m;c.addValue(f,o,t,{propertyIsArray:w})}}}else{var i=c.getContextValue(a,b,"@container");if("@index"===i)continue;var x=B(a,m);c.addValue(f,x,n)}else{var y=this.compact(a,"@reverse",n,e);for(var z in y)if(a.mappings[z]&&a.mappings[z].reverse){var A=y[z],i=c.getContextValue(a,z,"@container"),D="@set"===i||!e.compactArrays;c.addValue(f,z,A,{propertyIsArray:D}),delete y[z]}if(Object.keys(y).length>0){var x=B(a,m);c.addValue(f,x,y)}}else{var y;if(N(n))y=B(a,n,null,{vocab:"@type"===m});else{y=[];for(var p=0;p<n.length;++p)y.push(B(a,n[p],null,{vocab:!0}))}var x=B(a,m),w=L(y)&&0===n.length;c.addValue(f,x,y,{propertyIsArray:w})}}return f}return d},Db.prototype.expand=function(a,b,d,f,h){var i=this;if(null===d||void 0===d)return null;if(!L(d)&&!J(d))return h||null!==b&&"@graph"!==E(a,b,{vocab:!0})?g(a,b,d):null;if(L(d)){var j=[],k=c.getContextValue(a,b,"@container");h=h||"@list"===k;for(var l=0;l<d.length;++l){var m=i.expand(a,b,d[l],f);if(h&&(L(m)||W(m)))throw new Cb("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==m&&(L(m)?j=j.concat(m):j.push(m))}return j}"@context"in d&&(a=i.processContext(a,d["@context"],f));for(var n=E(a,b,{vocab:!0}),j={},o=Object.keys(d).sort(),p=0;p<o.length;++p){var q,r=o[p],s=d[r];if("@context"!==r){var t=E(a,r,{vocab:!0});if(null!==t&&(Y(t)||I(t))){if(I(t)){if("@reverse"===n)throw new Cb("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:s});if(t in j)throw new Cb("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:t})}if("@id"===t&&!N(s)){if(!f.isFrame)throw new Cb('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:s});if(!J(s))throw new Cb('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:s})}if("@type"===t&&M(s),"@graph"===t&&!J(s)&&!L(s))throw new Cb('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:s});if("@value"===t&&(J(s)||L(s)))throw new Cb('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:s});if("@language"===t){if(!N(s))throw new Cb('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:s});s=s.toLowerCase()}if("@index"===t&&!N(s))throw new Cb('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:s});if("@reverse"!==t){var k=c.getContextValue(a,r,"@container");if("@language"===k&&J(s))q=e(s);else if("@index"===k&&J(s))q=function(b){for(var c=[],d=Object.keys(s).sort(),e=0;e<d.length;++e){var g=d[e],h=s[g];L(h)||(h=[h]),h=i.expand(a,b,h,f,!1);for(var j=0;j<h.length;++j){var k=h[j];"@index"in k||(k["@index"]=g),c.push(k)}}return c}(r);else{var u="@list"===t;if(u||"@set"===t){var v=b;if(u&&"@graph"===n&&(v=null),q=i.expand(a,v,s,f,u),u&&W(q))throw new Cb("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else q=i.expand(a,r,s,f,!1)}if(null!==q||"@value"===t)if("@list"===t||W(q)||"@list"!==k||(q=L(q)?q:[q],q={"@list":q}),a.mappings[r]&&a.mappings[r].reverse){var w=j["@reverse"]={};L(q)||(q=[q]);for(var x=0;x<q.length;++x){var y=q[x];if(V(y)||W(y))throw new Cb('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:q});c.addValue(w,t,y,{propertyIsArray:!0})}}else{var z=-1===["@index","@id","@type","@value","@language"].indexOf(t);c.addValue(j,t,q,{propertyIsArray:z})}}else{if(!J(s))throw new Cb('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:s});if(q=i.expand(a,"@reverse",s,f),"@reverse"in q)for(var A in q["@reverse"])c.addValue(j,A,q["@reverse"][A],{propertyIsArray:!0});var w=j["@reverse"]||null;for(var A in q)if("@reverse"!==A){null===w&&(w=j["@reverse"]={}),c.addValue(w,A,[],{propertyIsArray:!0});for(var B=q[A],x=0;x<B.length;++x){var y=B[x];if(V(y)||W(y))throw new Cb('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:q});c.addValue(w,A,y,{propertyIsArray:!0})}}}}}}o=Object.keys(j);var C=o.length;if("@value"in j){if("@type"in j&&"@language"in j)throw new Cb('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:j});var D=C-1;if("@type"in j&&(D-=1),"@index"in j&&(D-=1),"@language"in j&&(D-=1),0!==D)throw new Cb('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:j});if(null===j["@value"])j=null;else{if("@language"in j&&!N(j["@value"]))throw new Cb("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:j});if("@type"in j&&(!Y(j["@type"])||0===j["@type"].indexOf("_:")))throw new Cb('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:j})}}else if("@type"in j&&!L(j["@type"]))j["@type"]=[j["@type"]];else if("@set"in j||"@list"in j){if(C>1&&!(2===C&&"@index"in j))throw new Cb('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:j});"@set"in j&&(j=j["@set"],o=Object.keys(j),C=o.length)}else 1===C&&"@language"in j&&(j=null);return!J(j)||f.keepFreeFloatingNodes||h||null!==b&&"@graph"!==n||(0===C||"@value"in j||"@list"in j||1===C&&"@id"in j)&&(j=null),j},Db.prototype.flatten=function(a){var b=new eb("_:b"),c={"@default":{}};p(a,c,"@default",b);for(var d=c["@default"],e=Object.keys(c).sort(),f=0;f<e.length;++f){var g=e[f];if("@default"!==g){var h=c[g],i=d[g];i?"@graph"in i||(i["@graph"]=[]):d[g]=i={"@id":g,"@graph":[]};for(var j=i["@graph"],k=Object.keys(h).sort(),l=0;l<k.length;++l){var m=h[k[l]];U(m)||j.push(m)}}}for(var n=[],o=Object.keys(d).sort(),q=0;q<o.length;++q){var m=d[o[q]];U(m)||n.push(m)}return n},Db.prototype.frame=function(a,b,c){var d={options:c,graphs:{"@default":{},"@merged":{}}},e=new eb("_:b");p(a,d.graphs,"@merged",e),d.subjects=d.graphs["@merged"];var f=[];return q(d,Object.keys(d.subjects).sort(),b,f,null),f},Db.prototype.normalize=function(a,b,d){function e(a){function b(h){if(h===a.length)return f(g,e,d);var i=a[h],k=m(i,j,u);k in e?(e[k].push(i),d.push(i)):k in g?(e[k]=[g[k],i],d.push(g[k]),d.push(i),delete g[k]):g[k]=i,c.setImmediate(function(){b(h+1)})}var d=[],e={},g={};c.setImmediate(function(){b(0)})}function f(a,b,c){for(var d=!1,f=Object.keys(a).sort(),h=0;h<f.length;++h){var i=a[f[h]];u.getName(i),d=!0}d?e(c):g(b)}function g(a){function b(e){function f(a,c){if(c===a.length){i.sort(function(a,b){return a=a.hash,b=b.hash,b>a?-1:a>b?1:0});for(var g in i)for(var h in i[g].pathNamer.existing)u.getName(h);return b(e+1)}var k=a[c];if(u.isNamed(k))return f(a,c+1);var l=new eb("_:b");l.getName(k),n(k,j,u,l,function(b,e){return b?d(b):(i.push(e),void f(a,c+1))})}if(e===c.length)return h();var g=a[c[e]],i=[];f(g,0)}var c=Object.keys(a).sort();b(0)}function h(){for(var a=[],c=0;c<i.length;++c){for(var e=i[c],f=["subject","object","name"],g=0;g<f.length;++g){var h=f[g];e[h]&&"blank node"===e[h].type&&0!==e[h].value.indexOf("_:c14n")&&(e[h].value=u.getName(e[h].value))}a.push(cb(e,e.name?e.name.value:null))}return a.sort(),b.format?"application/nquads"===b.format?d(null,a.join("")):d(new Cb("Unknown output format.","jsonld.UnknownFormat",{format:b.format})):void d(null,ab(a.join("")))}var i=[],j={};for(var k in a){var l=a[k];"@default"===k&&(k=null);for(var o=0;o<l.length;++o){var p=l[o];null!==k&&(p.name=0===k.indexOf("_:")?{type:"blank node",value:k}:{type:"IRI",value:k}),i.push(p);for(var q=["subject","object","name"],r=0;r<q.length;++r){var s=q[r];if(p[s]&&"blank node"===p[s].type){var t=p[s].value;t in j?j[t].quads.push(p):j[t]={quads:[p]}}}}}var u=new eb("_:c14n");return e(Object.keys(j))},Db.prototype.fromRDF=function(a,b,d){var e={},f={"@default":e};for(var g in a){var h=a[g];g in f||(f[g]={}),"@default"===g||g in e||(e[g]={"@id":g});for(var i=f[g],j=0;j<h.length;++j){var l=h[j],m=l.subject.value,n=l.predicate.value,o=l.object;m in i||(i[m]={"@id":m});var p=i[m],q="IRI"===o.type||"blank node"===o.type;if(!q||o.value in i||(i[o.value]={"@id":o.value}),n!==vb||b.useRdfType||!q){var r=k(o,b.useNativeTypes);if(c.addValue(p,n,r,{propertyIsArray:!0}),q){var s=i[o.value];"usages"in s||(s.usages=[]),s.usages.push({node:p,property:n,value:r})}}else c.addValue(p,"@type",o.value,{propertyIsArray:!0})}}for(var g in f){var t=f[g];if(ub in t)for(var u=t[ub],v=0;v<u.usages.length;++v){for(var w=u.usages[v],p=w.node,x=w.property,y=w.value,z=[],A=[],B=Object.keys(p).length;x===tb&&1===p.usages.length&&L(p[sb])&&1===p[sb].length&&L(p[tb])&&1===p[tb].length&&(4===B||5===B&&L(p["@type"])&&1===p["@type"].length&&p["@type"][0]===rb)&&(z.push(p[sb][0]),A.push(p["@id"]),w=p.usages[0],p=w.node,x=w.property,y=w.value,B=Object.keys(p).length,0===p["@id"].indexOf("_:")););if(x===sb){if(p["@id"]===ub)continue;y=t[y["@id"]][tb][0],z.pop(),A.pop()}delete y["@id"],y["@list"]=z.reverse();for(var C=0;C<A.length;++C)delete t[A[C]]}}for(var D=[],E=Object.keys(e).sort(),v=0;v<E.length;++v){var F=E[v],p=e[F];if(F in f)for(var h=p["@graph"]=[],t=f[F],G=Object.keys(t).sort(),H=0;H<G.length;++H){var I=t[G[H]];delete I.usages,U(I)||h.push(I)}delete p.usages,U(p)||D.push(p)}d(null,D)},Db.prototype.toRDF=function(a,b){var c=new eb("_:b"),d={"@default":{}};p(a,d,"@default",c);for(var e={},f=Object.keys(d).sort(),g=0;g<f.length;++g){var i=f[g];("@default"===i||Y(i))&&(e[i]=h(d[i],c,b))}return e},Db.prototype.processContext=function(a,b,d){J(b)&&"@context"in b&&L(b["@context"])&&(b=b["@context"]);var e=L(b)?b:[b];if(0===e.length)return a.clone();for(var f=a,g=!0,h=0;h<e.length;++h){var i=e[h];if(null!==i){if(J(i)&&"@context"in i&&(i=i["@context"]),!J(i))throw new Cb("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:i});if(c.cache.activeCtx){var j=c.cache.activeCtx.get(a,i);if(j){f=j,g=!0;continue}}g&&(f=f.clone(),g=!1);var k={};if("@base"in i){var l=i["@base"];if(null===l)l=null;else{if(!N(l))throw new Cb('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:i});if(""!==l&&!Y(l))throw new Cb('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:i})}null!==l&&(l=c.url.parse(l||"")),f["@base"]=l,k["@base"]=!0}if("@vocab"in i){var m=i["@vocab"];if(null===m)delete f["@vocab"];else{if(!N(m))throw new Cb('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:i});if(!Y(m))throw new Cb('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:i});f["@vocab"]=m}k["@vocab"]=!0}if("@language"in i){var m=i["@language"];if(null===m)delete f["@language"];else{if(!N(m))throw new Cb('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:i});f["@language"]=m.toLowerCase()}k["@language"]=!0}for(var n in i)D(f,i,n,k);c.cache.activeCtx&&c.cache.activeCtx.set(a,i,f)}else f=H(d),g=!1}return f},Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}),c.registerRDFParser("application/nquads",ab),c.registerRDFParser("rdfa-api",db),eb.prototype.clone=function(){var a=new eb(this.prefix);return a.counter=this.counter,a.existing=Z(this.existing),a},eb.prototype.getName=function(a){if(a&&a in this.existing)return this.existing[a];var b=this.prefix+this.counter;return this.counter+=1,a&&(this.existing[a]=b),b},eb.prototype.isNamed=function(a){return a in this.existing};var Eb=function(a){this.list=a.sort(),this.done=!1,this.left={};for(var b=0;b<a.length;++b)this.left[a[b]]=!0};Eb.prototype.hasNext=function(){return!this.done},Eb.prototype.next=function(){for(var a=this.list.slice(),b=null,c=0,d=this.list.length,e=0;d>e;++e){var f=this.list[e],g=this.left[f];(null===b||f>b)&&(g&&e>0&&f>this.list[e-1]||!g&&d-1>e&&f>this.list[e+1])&&(b=f,c=e)}if(null===b)this.done=!0;else{var h=this.left[b]?c-1:c+1;this.list[c]=this.list[h],this.list[h]=b;for(var e=0;d>e;++e)this.list[e]>b&&(this.left[this.list[e]]=!this.left[this.list[e]])}return a};var Fb=c.sha1={};if(a){var Gb=require("crypto");Fb.create=function(){var a=Gb.createHash("sha1");return{update:function(b){a.update(b,"utf8")},digest:function(){return a.digest("hex")}}}}else Fb.create=function(){return new Fb.MessageDigest};if(Fb.hash=function(a){for(var b=Fb.create(),c=0;c<a.length;++c)b.update(a[c]);return b.digest()},!a){Fb.Buffer=function(){this.data="",this.read=0},Fb.Buffer.prototype.putInt32=function(a){this.data+=String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a)},Fb.Buffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,a},Fb.Buffer.prototype.bytes=function(){return this.data.slice(this.read)},Fb.Buffer.prototype.length=function(){return this.data.length-this.read},Fb.Buffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},Fb.Buffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);16>c&&(a+="0"),a+=c.toString(16)}return a},Fb.MessageDigest=function(){Hb.initialized||Hb.init(),this.blockLength=64,this.digestLength=20,this.messageLength=0,this.input=new Fb.Buffer,this.words=new Array(80),this.state={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520}},Fb.MessageDigest.prototype.update=function(a){a=unescape(encodeURIComponent(a)),this.messageLength+=a.length,this.input.data+=a,Hb.update(this.state,this.words,this.input),(this.input.read>2048||0===this.input.length())&&this.input.compact()},Fb.MessageDigest.prototype.digest=function(){var a=this.messageLength,b=new Fb.Buffer;b.data+=this.input.bytes(),b.data+=Hb.padding.substr(0,64-(a+8)%64),b.putInt32(a>>>29&255),b.putInt32(a<<3&4294967295),Hb.update(this.state,this.words,b);var c=new Fb.Buffer;return c.putInt32(this.state.h0),c.putInt32(this.state.h1),c.putInt32(this.state.h2),c.putInt32(this.state.h3),c.putInt32(this.state.h4),c.toHex()};var Hb={padding:null,initialized:!1};Hb.init=function(){Hb.padding=String.fromCharCode(128);for(var a=String.fromCharCode(0),b=64;b>0;)1&b&&(Hb.padding+=a),b>>>=1,b>0&&(a+=a);Hb.initialized=!0},Hb.update=function(a,b,c){for(var d,e,f,g,h,i,j,k,l=c.length();l>=64;){for(e=a.h0,f=a.h1,g=a.h2,h=a.h3,i=a.h4,k=0;16>k;++k)d=c.getInt32(),b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;20>k;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;32>k;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;40>k;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;60>k;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f&g|h&(f^g),d=(e<<5|e>>>27)+j+i+2400959708+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;80>k;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+3395469782+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;a.h0+=e,a.h1+=f,a.h2+=g,a.h3+=h,a.h4+=i,l-=64}}}if(!kb)var Ib=function(){kb=require("xmldom").XMLSerializer};if(c.url={},a){var Jb=require("url").parse;c.url.parse=function(a){var b=Jb(a);return b.pathname=b.pathname||"",fb(b),b.normalizedPath=gb(b.pathname,""!==b.authority),b}}else{var Kb={};Kb.options={key:["href","protocol","host","auth","user","password","hostname","port","relative","path","directory","file","query","hash"],parser:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/},c.url.parse=function(a){for(var b=Kb.options,c=b.parser.exec(a),d={},e=14;e--;)d[b.key[e]]=c[e]||"";return d.host&&""===d.path&&(d.path="/"),d.pathname=d.path||"",fb(d),d.normalizedPath=gb(d.pathname,""!==d.authority),d.query&&(d.path=d.path+"?"+d.query),d.protocol&&(d.protocol+=":"),d.hash&&(d.hash="#"+d.hash),d}}return a?c.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&c.useDocumentLoader("xhr"),a&&(c.use=function(a){switch(a){case"request":c.request=require("./request");break;default:throw new Cb("Unknown extension.","jsonld.UnknownExtension",{extension:a})}}),c},d=function(){return c(function(){return d()})};c(d),a?module.exports=d:"function"==typeof define&&define.amd?define([],function(){return d}):b&&("undefined"==typeof jsonld?jsonld=jsonldjs=d:jsonldjs=d)}(),function(a,b,c){"use strict";c=!!c;var d,e,f=b.MutationObserver||b.WebKitMutationObserver;if("undefined"!=typeof process&&"[object process]"==={}.toString.call(process))d=function(a,b){process.nextTick(function(){a.call(b)})};else if(f){var g=[],h=new f(function(){var a=g.slice();g=[],a.forEach(function(a){a[0].call(a[1])})}),i=document.createElement("div");h.observe(i,{attributes:!0}),window.addEventListener("unload",function(){h.disconnect(),h=null}),d=function(a,b){g.push([a,b]),i.setAttribute("drainQueue","drainQueue")}}else d=function(a,b){setTimeout(function(){a.call(b)},1)};var j=function(a){return{enumerable:!0,configurable:!1,get:a}},k=function(a,b,c,d){return{enumerable:!!b,configurable:!0,writable:!0,value:a||function(){}}},l=function(a){return k(a,0,1,0)},m=function(a){return k(a,1)},n=function(a){try{var b=a.then;if("function"==typeof b)return!0}catch(c){}return!1},o=function(a){Error.call(this,a)};o.prototype=Object.create(Error.prototype);var p=function(){var a=[];return a.pump=function(b){d(function(){for(var c=a.length,d=0;c>d;)d++,a.shift()(b)})},a},q=function(a,b,e,f,g,h){var i=!1,k=this,l=function(a){d(function(){h("fulfilled"),f(a),b.pump(a)})},m=function(a){d(function(){h("rejected"),g(a),e.pump(a)})},o=function(a){return n(a)?void a.then(o,m):void l(a)},p=function(a){return function(b){i?"undefined"!=typeof console&&console.error("Cannot resolve a Promise multiple times."):(i=!0,a(b))}};this.resolve=p(o,"resolve"),this.fulfill=p(l,"fulfill"),this.reject=p(m,"reject"),this.cancel=function(){k.reject(new Error("Cancel"))},this.timeout=function(){k.reject(new Error("Timeout"))},c&&Object.defineProperties(this,{_isResolved:j(function(){return i})}),h("pending")},e=function(a){var b,d,e=new p,f=new p,g="pending";c&&Object.defineProperties(this,{_value:j(function(){return b}),_error:j(function(){return d}),_state:j(function(){return g})}),Object.defineProperties(this,{_addAcceptCallback:l(function(a){e.push(a),"fulfilled"==g&&e.pump(b)}),_addRejectCallback:l(function(a){f.push(a),"rejected"==g&&f.pump(d)})});var h=new q(this,e,f,function(a){b=a},function(a){d=a},function(a){g=a});try{a&&a(h)}catch(i){h.reject(i)}},r=function(a){return"function"==typeof a},s=function(a,b,c){return r(a)?function(){try{var c=a.apply(null,arguments);b.resolve(c)}catch(d){b.reject(d)}}:b[c].bind(b)},t=function(a,b,c){return r(a)&&c._addAcceptCallback(a),r(b)&&c._addRejectCallback(b),c};e.prototype=Object.create(null,{then:m(function(a,b){var c=this;return new e(function(d){t(s(a,d,"resolve"),s(b,d,"reject"),c)})}),"catch":m(function(a){var b=this;return new e(function(c){t(null,s(a,c,"reject"),b)})})}),e.isThenable=n;var u=function(a){return Array.prototype.slice.call(a).map(e.resolve)};e.any=function(){var a=u(arguments);return new e(function(b){if(a.length){var c=!1,d=function(a){c||(c=!0,b.resolve(a))},e=function(a){c||(c=!0,b.reject(a))};a.forEach(function(a){a.then(d,e)})}else b.reject("No futures passed to Promise.any()")})},e.every=function(){var a=u(arguments);return new e(function(b){if(a.length){var c=new Array(a.length),d=0,e=function(e,f){d++,c[e]=f,d==a.length&&b.resolve(c)};a.forEach(function(a,c){a.then(e.bind(null,c),b.reject)})}else b.reject("No futures passed to Promise.every()")})},e.some=function(){var a=u(arguments);return new e(function(b){if(a.length){var c=0,d=function(){c++,c==a.length&&b.reject()};a.forEach(function(a){a.then(b.resolve,d)})}else b.reject("No futures passed to Promise.some()")})},e.fulfill=function(a){return new e(function(b){b.fulfill(a)})},e.resolve=function(a){return new e(function(b){b.resolve(a)})},e.reject=function(a){return new e(function(b){b.reject(a)})},a.Promise=e,"undefined"!=typeof window&&(window.DomPromise=e)}(this,"undefined"!=typeof window?window:{},this.runningUnderTest||!1);var pathvisioNS=pathvisioNS||{};pathvisioNS["src/pathvisiojs.html"]='<div id="pathvisiojs-container">\n\n  <!-- **********************************************************************\n    Pathway Container (JavaScript inserts pathway image inside this div)\n    *********************************************************************** -->\n  <div id="diagram-container">\n  </div>\n\n  <!-- **********************************************************************\n    Highlight Element by Label Control\n    *********************************************************************** -->\n  <div id="typeahead">\n    <input id="highlight-by-label-input" placeholder="Enter node name to highlight" role="textbox" aria-autocomplete="list" aria-haspopup="true">\n    <i id="clear-highlights-from-typeahead" class="control-icon icon-remove"></i>\n  </div> \n\n  <div id="viewer-toolbar">\n  </div>\n\n  <!-- **********************************************************************\n    Details Frame\n    *********************************************************************** -->\n  <div id="annotation" class="annotation ui-draggable">\n    <header class="annotation-header">\n      <span id="annotation-move" class="annotation-header-move">\n        <i class="icon-move"></i>\n      </span>\n      <span class="annotation-header-close" class="annotation-header-close">\n        <i class="icon-remove"></i>\n      </span>   \n\n      <span id="annotation-header-text" class="annotation-header-text">\n        Header\n      </span> \n      <span id="annotation-header-search" class="annotation-header-search" title="Search for pathways containing \'Header Text\'">\n        <a href="http://wikipathways.org//index.php?title=Special:SearchPathways">\n          <i class="icon-search"></i>\n        </a>\n      </span>\n      <div id="annotation-description" class="annotation-description">\n        <h2>description</h2>\n      </div>\n    </header>\n    <span class="annotation-items-container" class="annotation-items-container">\n      <ul id="annotation-items-container">\n        <!-- List items inside this ul element are generated automatically by JavaScript.\n            Each item will be composed of a title and text. The text can be set to be an href.\n            You can edit the styling of the title by editing CSS class "annotation-item-title"\n            and the styling of the text by editing CSS class "annotation-item-text.\n            -->\n      </ul>\n    </span>\n  </div>\n</div>\n',pathvisioNS["src/css/pathway-diagram.css"]="	svg {\n		color-interpolation: auto;\n		image-rendering: auto;\n		shape-rendering: auto;\n		vector-effect: non-scaling-stroke;\n                background: white;\n	/* removed fill and stroke since they override marker specs */\n	/*	fill: white;\n    		stroke: black; */\n	}\n\n	/* default color for pathway elements */\n	.default-fill-color {\n		fill: black; \n	}\n	.default-stroke-color {\n		stroke: black;\n	}\n	\n	/* default color of the background drawing board */ 	\n	.board-fill-color {\n		fill: white;\n	}\n	.board-stroke-color {\n		stroke: white;\n	}\n\n	.text-area {\n		font-family: Sans-Serif, Helvetica, Arial;\n		text-align: center;\n		vertical-align: middle;\n		font-size: 10px;\n		fill: black;\n		fill-opacity: 1;\n		stroke: none;\n	}\n\n	.citation {\n		font-family: Sans-Serif, Helvetica, Arial;\n		text-align: center;\n		vertical-align: top;\n		font-size: 7px;\n		fill: #999999;\n		fill-opacity: 1;\n		stroke: none;\n	}\n\n	.info-box {\n		font-family: Sans-Serif;\n		font-size: 10px;\n		fill: black;\n		stroke: none;\n		text-align: left;\n		vertical-align: top;\n	}\n\n	.info-box-item-property-name {\n		font-weight: bold;\n	}\n\n	.info-box-item-property-value {\n	}\n\n	.data-node {\n		text-align: right;\n		fill-opacity: 1;\n		fill: white;\n		stroke: black;\n		stroke-width: 1;\n		stroke-dasharray: 0;\n		stroke-miterlimit: 1;\n    		pointer-events:auto;\n	}\n	.data-node:hover {\n	 	cursor: pointer;\n	}\n	\n	.has-xref:hover {\n		cursor: pointer;\n	}\n\n	.data-node.gene-product {\n	}\n\n	.metabolite {\n		stroke: blue;\n	}\n\n	.data-node.metabolite > .text-area {\n		fill: blue;\n		fill-opacity: 1;\n		stroke: none;\n	}\n\n	.data-node.pathway {\n		stroke: none;\n		fill-opacity: 0;\n	}\n\n	.data-node.pathway > .text-area {\n		fill: rgb(20,150,30);\n		fill-opacity: 1;\n		font-size: 12px;\n		font-weight: bold;\n	}\n\n	.data-node.protein {\n	}\n\n	.data-node.rna {\n	}\n\n	.data-node.unknown {\n	}\n\n	.label {\n		stroke: null;\n		stroke-width: 0;\n		fill-opacity: 0;\n		stroke-dasharray: 0;\n		stroke-miterlimit: 1;\n	}\n\n	.shape {\n		fill-opacity: 0;\n		stroke: black;\n		stroke-dasharray: 0;\n		stroke-miterlimit: 1;\n	}\n\n	.shape.none {\n		fill: none;\n		fill-opacity: 0;\n		stroke: none;\n	}\n\n	g.group-node > .shape {\n		fill-opacity: 0.098;\n		stroke: gray;\n		stroke-miterlimit: 1;\n		stroke-width: 1px;\n    		pointer-events:none;\n	}\n\n	.group-node {\n		fill-opacity: 0.098;\n		stroke: gray;\n		stroke-miterlimit: 1;\n		stroke-width: 1px;\n    		pointer-events:none;\n	}\n\n	.group-node > .text-area {\n		fill-opacity: 0.4;\n		font-family: Serif, Times;\n		font-size: 32px;\n		fill: black;\n		stroke-width: 0;\n		font-weight: bold;\n  	}	\n\n	.group-node.none {\n		fill: rgb(180,180,100);\n		stroke-dasharray: 5,3;\n	}\n\n	.group-node.none > .text-area {\n		display: none;\n  	}	\n\n	/*.group-node.none:hover {\n		fill: rgb(255,180,100);\n		fill-opacity: 0.05;\n	}*/\n\n	.group-node.group {\n		fill-opacity: 0;\n		stroke: none;\n	}\n\n	.group-node.group > .text-area {\n		display: none;\n  	}\n	/*.group-node.group:hover {\n		fill: rgb(0,0,255);\n		stroke-width: 1px;\n		stroke-dasharray: 5,3;\n		stroke: gray;\n		fill-opacity: 0.1;\n	}*/\n\n	.group-node.complex {\n		fill: rgb(180,180,100);\n	}\n\n	.group-node.complex > .text-area {\n		display: none;\n  	}\n	/*.group-node.complex:hover {\n		fill: rgb(255,0,0);\n		fill-opacity: 0.05;\n	}*/	\n\n  	.group-node.pathway {\n		fill: rgb(0,255,0);\n		stroke-dasharray: 5,3;\n	}\n	/*.group-node.pathway:hover {\n		fill: rgb(0,255,0);\n		fill-opacity: 0.2;\n	}*/\n	.group-node.pathway > .text-area {\n		fill: rgb(20,150,30);\n		stroke: rgb(20,150,30);\n  }\n\n  .cellular-component {\n		fill-opacity: 0;\n		stroke: silver;\n	}\n\n  .graphical-line {\n		fill:none;\n		stroke: black; \n		stroke-width: 1px; \n	}\n\n	.interaction {\n		fill:none;\n		stroke: black; \n		stroke-width: 1px; \n	}\n\n	marker {\n		/* this is what should work per the spec\n		   stroke-dasharray: none; */\n		/* but I need to add this to make it work in Safari */\n		stroke-dasharray: 9999999999999999999999999;\n	}\n\n  .marker-end {\n    -webkit-transform: rotate(180deg);\n    -webkit-transform-origin: 50% 50%;\n\n    -o-transform: rotate(180deg); \n    -o-transform-origin: 50% 50%;\n\n    transform: rotate(180deg);\n    transform-origin: 50% 50%;\n  }\n\n	.solid-stroke {\n		/* this is what should work per the spec\n		   stroke-dasharray: none; */\n		/* but I need to add this to make it work in Safari */\n		stroke-dasharray: 9999999999999999999999999;\n	}\n\n	.dashed-stroke {\n		stroke-dasharray: 5,3;\n	}\n\n  .highlighted-node {\n		fill: yellow;\n    fill-opacity: 0.2;\n		stroke: orange; \n    stroke-width: 3px;\n  }\n",function(){window.console||(window.console={});for(var a=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"],b=0;b<a.length;b++)window.console[a[b]]||(window.console[a[b]]={})}();var pathvisiojs={load:function(a){var b=this;if(this.args=a,this.model={},this.model.elements=[],this.formatConverter.model=this.formatConverter.gpml.model=this.formatConverter.gpml.graphics.model=this.formatConverter.gpml.group.model=this.formatConverter.gpml.interaction.model=this.renderer.model=this.renderer.publicationXref.model=this.model,!a.container)throw new Error("No container selector specified to indicate where to insert the diagram.");if(!a.sourceData[0].uri)throw new Error("No sourceData uri specified.");var c=d3.map(b.config).entries(),d=function(c,d){a.hasOwnProperty(c.key)&&(b.config[c.key]=a[c.key]),d(null)};async.each(c,d,function(){b.renderer.load(a)})}};Element.prototype.getElementWidth=function(){return"undefined"!=typeof this.clip?this.clip.width:this.style.pixelWidth?this.style.pixelWidth:this.width},Element.prototype.getElementHeight=function(){return"undefined"!=typeof this.clip?this.clip.width:this.style.pixelHeight?this.style.pixelHeight:this.height},pathvisiojs.utilities={collect:function(){for(var a={},b=arguments.length,c=0;b>c;c++)for(var d in arguments[c])arguments[c].hasOwnProperty(d)&&(a[d]=arguments[c][d]);return a},clone:function(a){function b(a,b,c){var d,e,f={};for(d in b)e=b[d],d in a&&(a[d]===e||d in f&&f[d]===e)||(a[d]=c?c(e):e);return a}if(!a||"object"!=typeof a||"[object Function]"===Object.prototype.toString.call(a))return a;if(a.nodeType&&"cloneNode"in a)return a.cloneNode(!0);if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return new RegExp(a);var c,d,e;if(a instanceof Array)for(c=[],d=0,e=a.length;e>d;++d)d in a&&c.push(this.clone(a[d]));else c=a.constructor?new a.constructor:{};return b(c,a,this.clone)},cloneNode:function(a){var b=d3.select(a).node();return d3.select(b.parentNode.insertBefore(b.cloneNode(!0),b.nextSibling))},convertToArray:function(a){var b=null;return"Object"===this.getObjectType(a)?(b=[],b.push(a),b):"Array"===this.getObjectType(a)?a:"String"===this.getObjectType(a)?(b=[],b.push(a),b):void 0},getObjectType:function(a){var b;return"[object Object]"===Object.prototype.toString.call(a)?b="Object":"[object Array]"===Object.prototype.toString.call(a)?b="Array":"[object String]"===Object.prototype.toString.call(a)&&(b="String"),b},getTextDirection:function(a){var b,c=new RegExp("[\x00-]+"),d=c.test(a);return b=d?"ltr":"rtl"},getUriParam:function(a){var b=decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null;return b?b:(console.warn('Warning: URL parameter "'+a+'" is null.'),null)},getWindowDimensions:function(){var a=630,b=460;
return document.body&&document.body.width&&(a=document.body.width,b=document.body.height),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.width&&(a=document.documentElement.width,b=document.documentElement.height),window.innerWidth&&window.innerHeight&&(a=window.innerWidth,b=window.innerHeight),{width:a,height:b}},intersect:function(a,b){for(var c=[],d=0;d<a.length;d++)b.indexOf(a[d])>-1&&c.push(a[d]);return c},isIE:function(){var a=navigator.userAgent.toLowerCase();return-1!=a.indexOf("msie")?parseInt(a.split("msie")[1],10):!1},isUri:function(a){var b=/(?:(?=[\s`!()\[\]{};:'".,<>?])|\b)((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/|[a-z0-9.\-]+[.](?:com|org|net))(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))*(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]|\b))/gi;return b.test(a)},isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isOdd:function(a){return a%2},isWikiPathwaysId:function(a){return a=a.trim(),"WP"===a.substr(0,2).toUpperCase()&&this.isNumber(a.substr(a.length-1))?!0:!1},loadScripts:function(a,b){var c=function(a,b){var c=document.createElement("script");c.src=a,c.onload=c.onreadystatechange=function(){c.onreadystatechange=c.onload=null,/MSIE ([6-9]+\.\d+);/.test(navigator.userAgent)?window.setTimeout(function(){b()},8,this):b()};var d=document.getElementsByTagName("head")[0];(d||document.body).appendChild(c)};!function(){0!==a.length?c(a.shift(),this.loadScripts):b()}()},moveArrayItem:function(a,b,c){if(c>=a.length)for(var d=c-a.length;d--+1;)a.push(void 0);return a.splice(c,0,a.splice(b,1)[0]),a},splitStringByNewLine:function(a){return a.split(/\r\n|\r|\n/g)},strToHtmlId:function(a){var b=/\W/gi,c=a.replace(b,"");return c}},pathvisiojs.config={},pathvisiojs.config.gpmlSourceUriStub="/wpi/wpi.php?action=downloadFile&type=gpml&pwTitle=Pathway:",pathvisiojs.config.bridgedbLinkOutsUriStub="/wpi/extensions/bridgedb.php/",pathvisiojs.config.bridgedbDatasources="/wpi/extensions/PathwayViewer/datasources.txt",pathvisiojs.config.diagramLoadingIconUri="/wpi/extensions/PathwayViewer/img/loading.gif",pathvisiojs.config.diagramNotAvailableIconUri="/wpi/extensions/PathwayViewer/img/imageNotAvailable.jpg",pathvisiojs.config.imgDiagramUriStub="/wpi.php?action=downloadFile&type=png&pwTitle=Pathway:",pathvisiojs.config.pathwaySearchUriStub="/index.php?title=Special:SearchPathways&doSearch=1&query=",pathvisiojs.formatConverter={get:function(a,b){console.log("model in data"),console.log(this.model);var c=a.uri,d=(a.object,a.fileType);if(!c)return new Error("No uri specified.");if(!d)return new Error("No fileType specified.");if("gpml"!==d)throw new Error("Cannot get jGpml from the specified input.");this.data.gpml.get(a,function(a){this.data.gpml.toPvjson(a,c,function(a){b(a)})})}},pathvisiojs.formatConverter.bridgedb=function(){"use strict";function a(a,e,f,g,h,i){if(null===e||null===f){var j={header:g,description:h,listItems:["Missing ID and datasource"]};i(j)}else c(function(c){var j=b(f,c),k=j.systemCode;d(a,k,e,function(a){var d,j=[];"undefined"!=typeof a&&(j=a.map(function(a){var e={};return e.title=a.dataSourceName,e.text=a.xRefId,d=b(a.dataSourceName,c),e.priority=d.priority,d.hasOwnProperty("linkoutPattern")&&""!==d.linkoutPattern&&null!==d.linkoutPattern&&(e.uri=d.linkoutPattern.replace("$id",e.text)),e})),j.sort(function(a,b){if(a.priority===b.priority){var c=a.title.toLowerCase(),d=b.title.toLowerCase();return d>c?-1:c>d?1:0}return b.priority-a.priority});var k=d3.nest().key(function(a){return a.title}).entries(j);if(0===k.length){var l="",m=b(f,c);m.hasOwnProperty("linkoutPattern")&&""!==m.linkoutPattern&&null!==m.linkoutPattern&&(l=m.linkoutPattern.replace("$id",e)),k=[{key:f,values:[{priority:"1",text:e,title:f,uri:l}]}]}var n=k.filter(function(a){return a.key==f})[0],o=k.indexOf(n);k=pathvisiojs.utilities.moveArrayItem(k,o,0);var p=n.values.filter(function(a){return a.text==e})[0],q=n.values.indexOf(p);n.values=pathvisiojs.utilities.moveArrayItem(n.values,q,0);var r={header:g,description:h,listItems:k};i(r)})})}function b(a,b){var c=/[^\w]/gi,d=b.filter(function(b){return b.dataSourceName===a})[0];return d||(d=b.filter(function(b){return b.dataSourceName.replace(c,"").toLowerCase()===a.replace(c,"").toLowerCase()})[0]),d}function c(a){d3.tsv(pathvisiojs.config.bridgedbDatasources).response(function(a){return d3.tsv.parseRows(a.responseText,function(a){return{dataSourceName:a[0],systemCode:a[1],websiteUri:a[2],linkoutPattern:a[3],exampleIdentifier:a[4],entityIdentified:a[5],singleSpecies:a[6],priority:a[7],uri:a[8],regex:a[9],officialName:a[10]}})}).get(function(b,c){a(c)})}function d(a,b,c,d){var e=pathvisiojs.config.bridgedbLinkOutsUriStub+encodeURIComponent(a)+"/xrefs/"+encodeURIComponent(b)+"/"+encodeURIComponent(c);d3.tsv(e).response(function(a){return d3.tsv.parseRows(a.responseText,function(a){return{xRefId:a[0],dataSourceName:a[1]}})}).get(function(a,b){d(b)})}return{getXrefAnnotationDataByDataNode:a}}(),pathvisiojs.formatConverter.biopax=function(){"use strict";function a(a,b){try{d3.ns.prefix.bp="http://www.biopax.org/owldoc/Level3/",d3.ns.prefix.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#",d3.ns.qualify("bp:PublicationXref");var c=a.selectAll("PublicationXref"),d={};d.PublicationXref=[];var e;c.each(function(){e={},e.rdfId=d3.select(this).attr("rdf:id").toString(),d.PublicationXref.push(e)}),b(d)}catch(f){throw new Error("Error converting biopax to json: "+f.message)}}return{toPvjson:a}}(),pathvisiojs.formatConverter.pvjson=function(){"use strict";function a(a,b){var c=a.uri,d=(a.object,a.fileType);if(!c)return new Error("No uri specified.");if(!d)return new Error("No fileType specified.");if("gpml"!==d)throw new Error("Cannot get pvjson from the specified input.");pathvisiojs.formatConverter.gpml.get(a,function(a){pathvisiojs.formatConverter.gpml.toPvjson(a,c,function(a){console.log("pvjson"),console.log(a.data),b(a)})})}return{get:a}}(),pathvisiojs.formatConverter.gpml={defaults:{FontSize:{Type:"FontSize",Value:10}},addIsContainedByAttribute:function(a){return a.selectAll("Group").each(function(){var b=d3.select(this),c=b.attr("GroupId");b.attr("GroupId",null);{var d=b.attr("GraphId");a.selectAll("[GroupRef="+c+"]").each(function(){d3.select(this).attr("IsContainedBy",d).attr("GroupRef",null)})}}),a},selectByMultipleTagNames:function(a){var b,c,d=a.gpmlSelection,e=a.elementTags;return e.forEach(function(a){c=d.selectAll(a),c[0][0]&&(b?b[0]=b[0].concat(c[0]):b=c)}),b},makeExplicit:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=[],p={};p.gpmlSelection=a,p.elementTags=["DataNode","Label","Shape","State","Anchor","Interaction","GraphicalLine","Group"];var q=this.selectByMultipleTagNames(p);if(q[0][0]){q.filter(function(){return!!d3.select(this).attr("GraphId")}).each(function(){m=d3.select(this).attr("GraphId"),"id"===m.slice(0,2)&&(n=m.slice(2,m.length),o.push(n))}),o.sort(function(a,b){return parseInt(a,32)-parseInt(b,32)});var r=o[o.length-1]||0;q.filter(function(){return!d3.select(this).attr("GraphId")}).each(function(){r=(parseInt(r,32)+1).toString(32),d3.select(this).attr("GraphId","id"+r)});var s=a.selectAll("Group");s.each(function(){b=d3.select(this),h=b.append("Graphics").attr("Align","Center").attr("Valign","Middle").attr("FontWeight","Bold").attr("LineThickness",1).attr("FillOpacity",.1)});{a.selectAll("Group[Style=Group]").each(function(){c=d3.select(this),i=c.select("Graphics").attr("FontSize","1").attr("Padding","8").attr("ShapeType","None").attr("LineStyle","Broken").attr("Color","808080").attr("FillColor","Transparent")}),a.selectAll("Group[Style=None]").each(function(){d=d3.select(this),j=d.select("Graphics").attr("FontSize","1").attr("Padding","8").attr("ShapeType","Rectangle").attr("LineStyle","Broken").attr("Color","808080").attr("FillColor","B4B464")})}s[0][0]&&s.filter(function(){var a=d3.select(this).select("Graphics");return console.log(this),console.log(a.attr("ShapeType")),!a.attr("ShapeType")}).each(function(){d3.select(this).select("Graphics").attr("ShapeType","None"),d=d3.select(this),j=d.select("Graphics").attr("FontSize","1").attr("Padding","8").attr("ShapeType","Rectangle").attr("LineStyle","Broken").attr("Color","808080").attr("FillColor","B4B464")});var t=(a.selectAll("Group[Style=Complex]").each(function(){f=d3.select(this),l=f.select("Graphics").attr("FontSize","1").attr("Padding","11").attr("ShapeType","Complex").attr("Color","808080").attr("FillColor","B4B464").attr("LineStyle","Solid")}),a.selectAll("Group[Style=Pathway]").each(function(){e=d3.select(this),k=e.select("Graphics").attr("FontSize","1").attr("Padding","8").attr("ShapeType","Rectangle").attr("LineStyle","Broken").attr("Color","808080").attr("FillColor","00FF00")}),{});t.gpmlSelection=a,t.elementTags=["DataNode","Label","Shape","State"];var u=this.selectByMultipleTagNames(t);if(u[0][0]){var v=a.selectAll("Label");v[0][0]&&(v.filter(function(){return!d3.select(this).select("Graphics").attr("ShapeType")}).each(function(){d3.select(this).select("Graphics").attr("ShapeType","None")}),v.filter(function(){return!d3.select(this).select("Graphics").attr("FillColor")}).each(function(){d3.select(this).select("Graphics").attr("FillColor","Transparent")}));var w=a.selectAll("State");w[0][0]&&(w.filter(function(){return!d3.select(this).select("Graphics").attr("FillColor")}).each(function(){d3.select(this).select("Graphics").attr("FillColor","ffffff")}),w.filter(function(){return!d3.select(this).select("Graphics").attr("FontSize")}).each(function(){d3.select(this).select("Graphics").attr("FontSize",10)}),w.filter(function(){return!d3.select(this).select("Graphics").attr("Valign")}).each(function(){d3.select(this).select("Graphics").attr("Valign","Middle")}));var x=a.selectAll("Shape");if(x[0][0]){x.filter(function(){return!d3.select(this).select("Graphics").attr("FillColor")}).each(function(){d3.select(this).select("Graphics").attr("FillColor","Transparent")}),x.filter(function(){return"0.0"===d3.select(this).select("Graphics").attr("Rotation")}).each(function(){d3.select(this).select("Graphics").attr("Rotation",null)});{x.selectAll('[Key="org.pathvisio.CellularComponentProperty"]').each(function(){g=d3.select(this).attr("Value");var a=this.parentElement||this.parentNode;d3.select(a).attr("CellularComponent",g)})}}u.filter(function(){return"Oval"===d3.select(this).select("Graphics").attr("ShapeType")}).each(function(){d3.select(this).select("Graphics").attr("ShapeType","Ellipse")}),u.filter(function(){return!d3.select(this).select("Graphics").attr("Padding")}).each(function(){d3.select(this).select("Graphics").attr("Padding","0.5em")}),u.filter(function(){return!d3.select(this).select("Graphics").attr("ShapeType")}).each(function(){d3.select(this).select("Graphics").attr("ShapeType","Rectangle")}),u.filter(function(){return!d3.select(this).select("Graphics").attr("Color")}).each(function(){d3.select(this).select("Graphics").attr("Color","000000")}),u.filter(function(){return!d3.select(this).select("Graphics").attr("LineThickness")}).each(function(){d3.select(this).select("Graphics").attr("LineThickness",1)}),u.filter(function(){return!d3.select(this).select("Graphics").attr("ZOrder")}).each(function(){d3.select(this).select("Graphics").attr("ZOrder",0)}),u.filter(function(){return!d3.select(this).select("Graphics").attr("Align")}).each(function(){d3.select(this).select("Graphics").attr("Align","Center")}),u.filter(function(){return!d3.select(this).select("Graphics").attr("Valign")}).each(function(){d3.select(this).select("Graphics").attr("Valign","Top")});var y,z,A,B,C,D=.311,E=.07,F=.938,G=.868,H=x.selectAll('[ShapeType="Triangle"]');H.each(function(){C=d3.select(this),A=parseFloat(C.attr("CenterX")),B=parseFloat(C.attr("CenterY")),y=parseFloat(C.attr("Width")),z=parseFloat(C.attr("Height"));var a=y*F,b=A-y/2,c=B-z/2,d=z*G,e=C.attr("Rotation")||0,f=2*Math.PI-e,g=D*Math.cos(f)*y+E*Math.sin(f)*z,h=A+D*y-y/2+a-(A+y/2),i=-1*h*Math.sin(f)+E*Math.cos(f)*z,j=b+g,k=c+i;C.attr("CenterX",j+a/2).attr("CenterY",k+d/2).attr("Height",d).attr("Width",a)});var I,J,K,L=(x.selectAll('[ShapeType="Arc"]').each(function(){I=d3.select(this);var a=parseFloat(I.attr("Height")),b=parseFloat(I.attr("Width")),c=a/2,d=I.attr("Rotation")||0,e=2*Math.PI-d;A=parseFloat(I.attr("CenterX")),B=parseFloat(I.attr("CenterY"));var f=A-b/2,g=B-a/2,h=f+c*Math.sin(e),i=g+c*Math.cos(e),j=h+b/2,k=i+c;I.attr("CenterX",j).attr("CenterY",k)}),.904),M=.95,N=(x.selectAll('[ShapeType="Pentagon"]').each(function(){J=d3.select(this),y=parseFloat(J.attr("Width")),z=parseFloat(J.attr("Height")),A=parseFloat(J.attr("CenterX")),J.attr("CenterX",A+y*(1-L)/2).attr("Width",y*L).attr("Height",z*M)}),.88),O=(x.selectAll('[ShapeType="Hexagon"]').each(function(){K=d3.select(this),z=parseFloat(K.attr("Height")),K.attr("Height",z*N)}),a.selectAll("DataNode"));O[0][0]&&O.filter(function(){return!d3.select(this).select("Graphics").attr("FillColor")}).each(function(){d3.select(this).select("Graphics").attr("FillColor","ffffff")})}var P=(a.selectAll('[Key="org.pathvisio.DoubleLineProperty"]').each(function(){var a=this.parentElement||this.parentNode;d3.select(a).select("Graphics").attr("LineStyle","Double")}),{});P.gpmlSelection=a,P.elementTags=["Interaction","GraphicalLine"];var Q=this.selectByMultipleTagNames(P);if(Q){Q.each(function(){d3.select(this).select("Graphics").attr("FillColor","Transparent")}),Q.filter(function(){var a=d3.select(this).select("Graphics");return!a.attr("ConnectorType")}).each(function(){d3.select(this).select("Graphics").attr("ConnectorType","Straight")}),Q.filter(function(){return!d3.select(this).select("Graphics").attr("Color")}).each(function(){d3.select(this).select("Graphics").attr("Color","000000")});var R=a.selectAll("Anchor");R.each(function(){var a=this.parentElement||this.parentNode,b=d3.select(a),c=d3.select(this),d=c.append("Graphics"),e=c.attr("Shape")||"None";d.attr("ShapeType",e),c.attr("Shape",null);var f=c.attr("Position");d.attr("Position",f),c.attr("Position",null),d.attr("LineThickness",0),d.attr("FillColor",b.attr("Color"))}),R[0][0]&&(R.filter(function(){var a=d3.select(this).select("Graphics"),b=!1;return a[0][0]&&(b="Circle"===a.attr("ShapeType")),b}).each(function(){d3.select(this).select("Graphics").attr("ShapeType","Ellipse"),d3.select(this).select("Graphics").attr("Width",8),d3.select(this).select("Graphics").attr("Height",8)}),R.filter(function(){var a=d3.select(this).select("Graphics"),b=!1;return a[0][0]&&(b="None"===a.attr("ShapeType")),b}).each(function(){d3.select(this).select("Graphics").attr("Width",4),d3.select(this).select("Graphics").attr("Height",4)}))}}return a},get:function(a,b){var c=a.uri,d=a.object,e=a.fileType;if(!c&&!d)return new Error("No sourceData specified.");if(!e)return new Error("No fileType specified.");if("gpml"!==e)throw new Error("Cannot get GPML from the specified input.");9!==pathvisiojs.utilities.isIE()?d3.xml(c,function(a){var c=a.documentElement;self.myGpml=c,b(c)}):async.waterfall([function(a){$?a(null):pathvisiojs.utilities.loadScripts(["http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"],function(){a(null)})},function(a){d3.xhr(c,"application/xml",function(b,c){var d=c.responseText;a(null,d)})},function(a){var c=$.parseXML(a),d=c.documentElement;b(d)}])},gpmlColorAndShapeTypeToCss:function(a,b){var c={label:{color:null},shape:{stroke:null,fill:null}};return"none"!==b.toLowerCase()?c.label.color=this.gpmlColorToCssColorNew(a):(c.color=this.gpmlColorToCssColorNew(a),c.stroke="transparent"),c},gpmlColorToCssColorNew:function(a){var b;return"transparent"===a.toLowerCase()?"transparent":(b=new RGBColor(a),b.ok?b.toHex():(console.warn('Could not convert GPML Color value of "'+a+'" to a valid CSS color. Using "#c0c0c0" as a fallback.'),"#c0c0c0"))},gpmlColorToCssColor:function(a,b){var c;return a!==b&&a?(c=new RGBColor(a),c.ok?c.toHex():b):b},setColorAsJsonNew:function(a,b){var c=this.gpmlColorToCssColorNew(b);return a.color=c,a.borderColor=c,a.hasOwnProperty("text")&&(a.text.color=c),a},setColorAsJson:function(a,b,c){var d;return b!==c&&(d=this.gpmlColorToCssColor(b,c),a.color=d,a.borderColor=d,a.hasOwnProperty("text")&&(a.text.color=d)),a},getLineStyle:function(a){var b,c,d=a.select("Graphics");return d?(b=d.attr("LineStyle"),b?b:(c=a.selectAll("Attribute"),c.length>0?(b=c.filter(function(){return"org.pathvisiojs.DoubleLineProperty"===d3.select(this).attr("Key")&&"Double"===d3.select(this).attr("Value")}),b[0].length>0?"double":null):null)):void 0},getBorderStyleNew:function(a){var b={Solid:"solid",Double:"solid",Broken:"dashed"},c=b[a];return c?c:(console.warn('LineStyle "'+a+'" does not have a corresponding borderStyle. Using "solid"'),"solid")},getBorderStyle:function(a,b){var c,d={Solid:"solid",Double:"solid",Broken:"dashed"};return a!==b?a?(c=d[a],c?c:(console.warn('LineStyle "'+a+'" does not have a corresponding borderStyle. Using "solid"'),"solid")):"solid":"whatever the default value is"},setBorderStyleAsJsonNew:function(a,b){var c=this.getBorderStyleNew(b);return a.borderStyle=c,a},setBorderStyleAsJson:function(a,b,c){var d;return b!==c&&(d=this.getBorderStyle(b,c),a.borderStyle=d),a},toPvjson:function(a,b,c){var d={},e=this.addIsContainedByAttribute(this.makeExplicit(d3.select(a)));console.log("GPML"),console.log(a);var f=this.model;if(f.xmlns=e.attr("xmlns"),f.elements=[],-1===pathvisiojs.formatConverter.gpml.namespaces.indexOf(f.xmlns))throw alert("Pathvisiojs does not support the data format provided. Please convert to GPML and retry."),new Error("Pathvisiojs does not support the data format provided. Please convert to GPML and retry.");0!==pathvisiojs.formatConverter.gpml.namespaces.indexOf(f.xmlns)?(console.warn("GPML namespace is not one pathvisiojs can handle."),d.success=!1,d.message="GPML namespace is not one pathvisiojs can handle.",c(d)):async.parallel({"@context":function(a){f["@context"]={"@vocab":"http://vocabularies.wikipathways.org/gpml#","@base":b,gpml:"http://vocabularies.wikipathways.org/gpml#",id:"@id",xsd:"http://www.w3.org/2001/XMLSchema#",wp:"http://vocabularies.wikipathways.org/wp#",biopax:"http://www.biopax.org/release/biopax-level3.owl#",schema:"http://schema.org/",hMDB:"http://www.hmdb.ca/metabolites/HMDB",entrezGene:"http://www.ncbi.nlm.nih.gov/gene/",ChEBI:"http://www.ebi.ac.uk/chebi/searchId.do?chebiId=",media:"http://www.w3.org/TR/mediaont-10/",ex:"http://www.example.com/",pathwayIri:b,PublicationXref:"biopax:PublicationXref",gpmlFolder:"file://Users/andersriutta/Sites/pathvisiojs/test/gpml/",name:"http://xmlns.com/foaf/0.1/name",dcterms:"http://puri.org/dc/terms/",css2:"http://www.w3.org/TR/CSS2/",css3Ui:"http://www.w3.org/TR/css3-ui/#",cssTransform:"http://www.w3.org/TR/css-transforms-1/#",svg:"http://www.w3.org/TR/SVG11/",boxSizing:{"@id":"css3Ui:box-sizing","@value":"border-box"},rotate:"cssTransform:funcdef-rotate",position:"css2:visuren.html#propdef-position",color:"css2:colors.html#propdef-color",backgroundColor:"css2:colors.html#propdef-background-color",backgroundImage:"css2:colors.html#propdef-background-image",borderColor:"css2:box.html#propdef-border-color",borderWidth:"css2:box.html#propdef-border-width",borderStyle:"css2:box.html#propdef-border-style",x:{"@id":"css2:visuren.html#propdef-left","@type":"xsd:integer"},y:"css2:visuren.html#propdef-top",width:"css2:visudet.html#propdef-width",height:"css2:visudet.html#propdef-height",padding:"css2:box.html#propdef-padding",fontFamily:"css2:fonts.html#font-family-prop",fontStyle:"css2:fonts.html#propdef-font-style",textAlign:"css2:text.html#propdef-text-align",verticalAlign:"css2:visudet.html#propdef-vertical-align",fontSize:"css2:fonts.html#propdef-font-size",fontWeight:"css2:fonts.html#propdef-font-weight",zIndex:{"@id":"css2:z-index","@type":"xsd:integer"},DatasourceReference:"wp:DatasourceReference",DataSource:"gpml:Data-Source",LastModified:"gpml:Last-Modified",Pathway:"biopax:Pathway",shapeLibrary:"http://shapelibrary.example.org/",shapeName:"shapeLibrary:shapeName",image:"schema:image",dataNodeType:"gpml:Type",author:"schema:author",organism:"biopax:organism",stroke:"svg:painting.html#StrokeProperty",strokeWidth:"svg:painting.html#StrokeWidthProperty",line:{"@id":"svg:text.html#TSpanElement","@container":"@set"},Group:{"@id":"gpml:Group","@container":"@list"},pathwayElements:{"@id":"ex:pathwayElements/","@container":"@list"},contains:{"@id":"ex:contains","@type":"@id"},isContainedBy:{"@reverse":"ex:contains","@type":"@id"},edge:{"@type":"@id","@container":"@list",InteractionGraph:{"@type":"@id","@container":"@list"}},InteractionGraph:{"@type":"@id","@container":"@list"},interactsWith:{"@id":"ex:interactsWith","@type":"@id"},Interaction:{"@id":"biopax:Interaction","@type":"@id"},Point:{"@id":"gpml:Point","@container":"@list"}},a(null,f["@context"])},PublicationXref:function(a){pathvisiojs.formatConverter.gpml.biopaxRef.getAllAsPvjson(e,function(b){b?(f.PublicationXref=b,a(null,"BiopaxRefs are all converted.")):a(null,"No biopaxRefs to convert.")})},DataSource:function(a){var b=e.attr("Data-Source");b?(f.DataSource=b,a(null,"DataSource converted.")):a(null,"No DataSource to convert.")},Version:function(a){var b=e.attr("Version");b?(f.Version=b,a(null,"Version converted.")):a(null,"No Version to convert.")},Author:function(a){var b=e.attr("Author");b?(f.Author=b,a(null,"Author converted.")):a(null,"No Author to convert.")},Maintainer:function(a){var b=e.attr("Maintainer");b?(f.Maintainer=b,a(null,"Maintainer converted.")):a(null,"No Maintainer to convert.")},Email:function(a){var b=e.attr("Email");b?(f.Email=b,a(null,"Email converted.")):a(null,"No Email to convert.")},LastModified:function(a){var b=e.attr("Last-Modified");b?(f.LastModified=b,a(null,"LastModified converted.")):a(null,"No LastModified to convert.")},License:function(a){var b=e.attr("License");b?(f.License=b,a(null,"License converted.")):a(null,"No License to convert.")},Name:function(a){var b=e.attr("Name");b?(f.Name=b,a(null,"Name converted.")):a(null,"No Name to convert.")},Organism:function(a){var b=e.attr("Organism");b?(f.Organism=b,a(null,"Organism converted.")):a(null,"No Organism to convert.")},image:function(a){f.image={"@context":{"@vocab":"http://schema.org/"},width:parseFloat(e.select("Graphics").attr("BoardWidth")),height:parseFloat(e.select("Graphics").attr("BoardHeight"))},a(null,f.image)},Biopax:function(a){var b=e.selectAll("Biopax");b[0].length>0?(pathvisiojs.formatConverter.biopax.toPvjson(b,function(a){f.Biopax=a}),a(null,"Biopax all converted.")):a(null,"No Biopax to convert.")},DataNode:function(a){var b,c=e.selectAll("DataNode");c[0].length>0?(c.each(function(){b=d3.select(this),pathvisiojs.formatConverter.gpml.dataNode.toPvjson(f,e,b,function(a){f.elements=f.elements.concat(a)})}),a(null,"DataNodes are all converted.")):a(null,"No dataNodes to convert.")},Label:function(a){var b,c=e.selectAll("Label");c[0].length>0?(e.selectAll("Label").each(function(){b=d3.select(this),pathvisiojs.formatConverter.gpml.label.toPvjson(e,b,function(a){f.elements=f.elements.concat(a)})}),a(null,"Labels are all converted.")):a(null,"No labels to convert.")},Shape:function(a){var b,c=e.selectAll("Shape");c[0].length>0?(e.selectAll("Shape").each(function(){b=d3.select(this),pathvisiojs.formatConverter.gpml.shape.toPvjson(e,b,function(a){f.elements=f.elements.concat(a)})}),a(null,"Shapes are all converted.")):a(null,"No shapes to convert.")},State:function(a){var b,c=e.selectAll("State");c[0].length>0?(c.each(function(){b=d3.select(this),pathvisiojs.formatConverter.gpml.state.toPvjson(e,b,function(a){f.elements=f.elements.concat(a)})}),a(null,"States are all converted.")):a(null,"No states to convert.")},GraphicalLine:function(b){var c,d=e.selectAll("GraphicalLine");d[0].length>0?(e.selectAll("GraphicalLine").each(function(){c=d3.select(this),pathvisiojs.formatConverter.gpml.graphicalLine.toPvjson(a,c,function(a){f.elements=f.elements.concat(a)})}),b(null,"GraphicalLines are all converted.")):b(null,"No graphicalLines to convert.")},Interaction:function(b){var c,d=e.selectAll("Interaction");d[0].length>0?(e.selectAll("Interaction").each(function(){c=d3.select(this),pathvisiojs.formatConverter.gpml.interaction.toPvjson(a,c,function(a){f.elements=f.elements.concat(a)})}),b(null,"Interactions are all converted.")):b(null,"No interactions to convert.")}},function(){var a,b=e.selectAll("Group");if(b[0].length>0){e.selectAll("Group").each(function(){a=d3.select(this),pathvisiojs.formatConverter.gpml.group.toPvjson(f.elements,e,a,function(a){f.elements=f.elements.concat(a)})})}f.elements.sort(function(a,b){return a.zIndex-b.zIndex}),d.success=!0,d.data=f,c(d)})}},pathvisiojs.formatConverter.gpml.node=pathvisiojs.formatConverter.gpml.node||{},pathvisiojs.formatConverter.gpml.graphics={defaults:{FontSize:{Type:"FontSize",Value:10}},toPvjson:function(a,b,c,d){function e(a){var b;return"transparent"===a.toLowerCase()?"transparent":(b=new RGBColor(a),b.ok?b.toHex():(console.warn('Could not convert GPML Color value of "'+a+'" to a valid CSS color. Using "#c0c0c0" as a fallback.'),"#c0c0c0"))}var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=b.select("Graphics")[0][0],v="",w="",x=(this.model,["LineStyle","ShapeType","FillColor","Color","LineThickness","Width","Height","RelX","RelY","CenterX","CenterY"]),y={LineStyle:function(a){var b;return"Broken"===a?(b="5,3",c.strokeDasharray=b):"Double"===a&&(v="-double"),b},ShapeType:function(a){return w=a,l=strcase.paramCase(w)+v,c.shape=l,l},ConnectorType:function(a){var b=a;return l=strcase.paramCase("line-"+b)+v,c.shape=l,l},FillColor:function(a){var b=e(a);c.backgroundColor="none"!==w.toLowerCase()?b:"transparent"},FillOpacity:function(a){var b=parseFloat(a);c.fillOpacity=b},Color:function(a){var b=e(a);c.color=b},Padding:function(a){var b;b=pathvisiojs.utilities.isNumber(a)?parseFloat(a):a,c.padding=b},FontSize:function(a){var b;b=pathvisiojs.utilities.isNumber(a)?parseFloat(a):a,c.fontSize=b},FontName:function(a){var b=a;c.fontFamily=b},FontStyle:function(a){var b=a.toLowerCase();c.fontStyle=b},FontWeight:function(a){var b=a.toLowerCase();c.fontWeight=b},Rotation:function(a){a=parseFloat(a);var b=180*a/Math.PI;return c.rotation=b,b},LineThickness:function(a){return k=parseFloat(a),c.borderWidth=k,k},Position:function(a){var b=parseFloat(a);return c.position=b,b},Width:function(a){return a=parseFloat(a),j=a+k,c.width=j,j},Height:function(a){return a=parseFloat(a),i=a+k,c.height=i,i},CenterX:function(a){return a=parseFloat(a),p=a-j/2,c.x=p,p},CenterY:function(a){return a=parseFloat(a),q=a-i/2,c.y=q,q},RelX:function(d){var e=parseFloat(d);c.relX=e,f=a.select("[GraphId="+b.attr("GraphRef")+"]");var g=parseFloat(f.select("Graphics").attr("CenterX")),h=parseFloat(f.select("Graphics").attr("Width")),i=parseFloat(f.select("Graphics").attr("ZOrder")),k=g+d*h/2;return p=k-j/2,c.x=p,c.zIndex=i+.2,p},RelY:function(a){var b=parseFloat(a);c.relY=b;var d=parseFloat(f.select("Graphics").attr("CenterY")),e=parseFloat(f.select("Graphics").attr("Height")),g=d+b*e/2;return q=g-i/2,c.y=q,q},Align:function(a){return n=strcase.paramCase(a),c.textAlign=n,n},Valign:function(a){return o=strcase.paramCase(a),c.verticalAlign=o,o},ZOrder:function(a){return m=parseFloat(a),c.zIndex=m,m}},z=[];if(u){for(h=0;h<u.attributes.length;h++)g=u.attributes[h],r=g.name,s={name:r,value:g.value,dependencyOrder:x.indexOf(r)},z.push(s);z.sort(function(a,b){return a.dependencyOrder-b.dependencyOrder}),z.forEach(function(a){t=a.name,y.hasOwnProperty(t)?y[t](a.value):(console.warn('Pathvisiojs has no handler for attribute "'+t+'"'),t=strcase.camelCase(t),c[t]=a.value)})}d(c)}},pathvisiojs.formatConverter.gpml.element=function(){"use strict";var a=function(a,b){var c;return a!==b?a?(c=new RGBColor(a),c.ok?c.toHex():"black"):"black":null},b=function(b,c,d){var e;return c!==d&&(e=a(c,d),b.color=e,b.borderColor=e,b.hasOwnProperty("text")&&(b.text.color=e)),b},c=function(a){var b,c,d=a.select("Graphics");return d?(b=d.attr("LineStyle"),b?b:(c=a.selectAll("Attribute"),c.length>0?(b=c.filter(function(){return"org.pathvisiojs.DoubleLineProperty"===d3.select(this).attr("Key")&&"Double"===d3.select(this).attr("Value")}),b[0].length>0?"double":null):null)):void 0},d=function(a,b){var c,d={Solid:"solid",Double:"solid",Broken:"dashed"};return a!==b?a?(c=d[a],c?c:(console.warn('LineStyle "'+a+'" does not have a corresponding borderStyle. Using "solid"'),"solid")):"solid":"whatever the default value is"},e=function(a,b,c){var e;return b!==c&&(e=d(b,c),a.borderStyle=e),a},f=function(a,b,c,d){var e,f,g,h;c.gpmlType=b[0][0].tagName,c.graphicalType="path";var i=["GraphId","GraphRef","IsContainedBy","TextLabel","Type","CellularComponent"],j={GraphId:function(a){return c.id=a,a},Style:function(a){return c.groupStyle=a,a},Href:function(a){return h=encodeURI(he.decode(a)),c.href=h,h},TextLabel:function(a){return g=he.decode(a),c.textContent=g,g},Type:function(a){return c.biologicalType=a,a},CellularComponent:function(a){return c.cellularComponent=a,a},IsContainedBy:function(a){return c.isContainedBy=a,a},GraphRef:function(a){return c.isAttachedTo=a,a}};pathvisiojs.formatConverter.gpml.biopaxRef.getAllAsPvjson(b,function(a){a&&(c.publicationXrefs=a);var g,h,k,l=[];for(f=0;f<b[0][0].attributes.length;f++)e=b[0][0].attributes[f],g=e.name,h={name:g,value:e.value,dependencyOrder:i.indexOf(g)},l.push(h);l.sort(function(a,b){return a.dependencyOrder-b.dependencyOrder}),l.forEach(function(a){k=a.name,j.hasOwnProperty(k)?j[k](a.value):(console.warn('Pathvisiojs has no handler for attribute "'+k+'"'),k=strcase.camelCase(k),c[k]=a.value)}),d(c)})};return{toPvjson:f,gpmlColorToCssColor:a,setColorAsJson:b,getLineStyle:c,getBorderStyle:d,setBorderStyleAsJson:e}}(),pathvisiojs.formatConverter.gpml.text=function(){"use strict";function a(a,c,d){var e,f,g,h,i,j,k,l=pathvisiojs.utilities.collect(b.text,c),m=a.attr("TextLabel");if(m){e={},e.id="id"+uuid.v4(),e.line=m.split(/\r\n|\r|\n|&#xA;/g);var n=a.select("Graphics");n[0][0]&&(f=a.select("Graphics").attr("Align")||"center",e.textAlign=f.toLowerCase(),g=a.select("Graphics").attr("Valign")||"middle",e.verticalAlign=g.toLowerCase(),h=a.select("Graphics").attr("FontStyle"),h!==l.FontStyle&&h&&(e.fontStyle=h.toLowerCase()),i=a.select("Graphics").attr("FontWeight"),i!==l.FontWeight&&i&&(e.fontWeight=i.toLowerCase()),j=a.select("Graphics").attr("FontSize")||10,parseFloat(j)!==l.FontSize&&j&&(e.fontSize=parseFloat(j)),k=a.select("Graphics").attr("FontName"),k!==l.FontName&&k&&(e.fontFamily=k)),d(e)}else d(null)}var b={text:{Align:null,Valign:"Middle",FontStyle:null,FontName:null}};return{toPvjson:a}}(),pathvisiojs.formatConverter.gpml.namespaces=["http://pathvisio.org/GPML/2013a","http://genmapp.org/GPML/2010a","http://genmapp.org/GPML/2008a","http://genmapp.org/GPML/2007"],pathvisiojs.formatConverter.gpml.biopaxRef=function(){"use strict";function a(a,b){var c,d,e=a[0][0].tagName,f=a.selectAll(e+" > BiopaxRef");f[0].length>0?(c=[],f.each(function(){d=d3.select(this)[0][0].textContent,c.push(d)}),b(c)):b(null)}return{getAllAsPvjson:a}}(),pathvisiojs.formatConverter.gpml.group={getGroupDimensions:function(a,b){var c={};c.topLeftCorner={},c.topLeftCorner.x=1/0,c.topLeftCorner.y=1/0,c.bottomRightCorner={},c.bottomRightCorner.x=0,c.bottomRightCorner.y=0;var d=parseFloat(a.padding),e=a.borderWidth,f=a.contains;f=pathvisiojs.utilities.convertToArray(f),c.zIndex=1/0,async.each(f,function(a,b){a.hasOwnProperty("points")?(c.topLeftCorner.x=Math.min(c.topLeftCorner.x,a.points[0].x,a.points[a.points.length-1].x),c.topLeftCorner.y=Math.min(c.topLeftCorner.y,a.points[0].y,a.points[a.points.length-1].y),c.bottomRightCorner.x=Math.max(c.bottomRightCorner.x,a.points[0].x,a.points[a.points.length-1].x),c.bottomRightCorner.y=Math.max(c.bottomRightCorner.y,a.points[0].y,a.points[a.points.length-1].y)):(c.topLeftCorner.x=Math.min(c.topLeftCorner.x,a.x),c.topLeftCorner.y=Math.min(c.topLeftCorner.y,a.y),c.bottomRightCorner.x=Math.max(c.bottomRightCorner.x,a.x+a.width),c.bottomRightCorner.y=Math.max(c.bottomRightCorner.y,a.y+a.height)),c.x=c.topLeftCorner.x-d-e,c.y=c.topLeftCorner.y-d-e,c.width=c.bottomRightCorner.x-c.topLeftCorner.x+2*(d+e),c.height=c.bottomRightCorner.y-c.topLeftCorner.y+2*(d+e),c.zIndex=Math.min(c.zIndex,a.zIndex),b(null)
},function(){c.zIndex=c.zIndex-.1,b(c)})},toPvjson:function(a,b,c,d){{var e,f={},g=[];this.model}f.renderableType="GroupNode",f.networkType="node",f.nodeType="GroupNode",e=c.attr("Style")||"None",f.groupType=e,pathvisiojs.formatConverter.gpml.element.toPvjson(b,c,f,function(e){pathvisiojs.formatConverter.gpml.graphics.toPvjson(b,c,e,function(b){var c=a.filter(function(a){return a.isContainedBy===b.id});c.length>0&&(b.contains=c,pathvisiojs.formatConverter.gpml.group.getGroupDimensions(b,function(a){b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height,b.zIndex=a.zIndex}),g.push(b)),d(g)})})}},pathvisiojs.formatConverter.gpml.dataNode=function(){"use strict";var a=function(a,b,c,d){var e={},f=c.attr("Type");f||(f="Unknown"),e.networkType="node",e.nodeType="DataNode",e.dataNodeType=f,e["@type"]=e["@type"]||[],e["@type"].push("DataNode"),e["@type"].push(f),pathvisiojs.formatConverter.gpml.element.toPvjson(b,c,e,function(a){pathvisiojs.formatConverter.gpml.graphics.toPvjson(b,c,a,function(a){var e,f,g,h=c.select("Xref");h&&(e=h.attr("Database"),f=h.attr("ID"),e&&f&&(g={},g.database=e,g.id=f,g.organism=b.attr("Organism"),a.datasourceReference=g));var i=[a];d(i)})})};return{toPvjson:a}}(),pathvisiojs.formatConverter.gpml.label=function(){"use strict";var a=function(a,b,c){var d={};d.networkType="node",d.nodeType="Label",pathvisiojs.formatConverter.gpml.element.toPvjson(a,b,d,function(d){pathvisiojs.formatConverter.gpml.graphics.toPvjson(a,b,d,function(a){var b=[a];c(b)})})};return{toPvjson:a}}(),pathvisiojs.formatConverter.gpml.shape=function(){"use strict";function a(a,b,c){var d={};d.networkType="node",d.nodeType="Shape",pathvisiojs.formatConverter.gpml.element.toPvjson(a,b,d,function(d){pathvisiojs.formatConverter.gpml.graphics.toPvjson(a,b,d,function(a){var b=[a];c(b)})})}return{toPvjson:a}}(),pathvisiojs.formatConverter.gpml.state=function(){"use strict";var a=function(a,b,c){var d={};d.networkType="node",d.nodeType="State",pathvisiojs.formatConverter.gpml.element.toPvjson(a,b,d,function(d){pathvisiojs.formatConverter.gpml.graphics.toPvjson(a,b,d,function(a){var b=[a];c(b)})})};return{toPvjson:a}}(),pathvisiojs.formatConverter.gpml.anchor=function(){"use strict";function a(a,b,c,d){var e,f,g,h,i,j,k,l=[],m=c.points,n=m.length,o=m[0],p=m[n-1];b.selectAll("Anchor").each(function(){e=this,f=d3.select(this),g={},g.gpmlType="Anchor",g.isAttachedTo=c.id,g.zIndex=c.zIndex+.1,g.networkType="node",pathvisiojs.formatConverter.gpml.element.toPvjson(a,f,g,function(c){pathvisiojs.formatConverter.gpml.graphics.toPvjson(a,f,c,function(c){h=d3.select(a).select("Point[GraphRef="+c.id+"]"),j=c.width,k=c.height,h[0][0]?(c.x=parseFloat(h.attr("X"))-j/2,c.y=parseFloat(h.attr("Y"))-k/2):(i=c.position,c.x=o.x+i*(p.x-o.x)-j/2,c.y=o.y+i*(p.y-o.y)-k/2,console.warn("No cached X and Y data available for the Anchor for the edge element below. Assuming LineType of Straight for anchor position calculation."),console.log(b[0][0])),l.push(c)})})}),d(l)}function b(a){self.jsonNode=a;var b,c,d,e,f,g,h,i,j,k=[],l=[{side:"top",dx:0,dy:-1},{side:"right",dx:1,dy:0},{side:"bottom",dx:0,dy:1},{side:"left",dx:-1,dy:0}],m=[.25,.5,.75];return b=a.id,c="anchor",l.forEach(function(b){g=Math.max(b.dx,0)*a.width,h=Math.max(b.dy,0)*a.height,m.forEach(function(c){d=String(a.id)+String(b.side)+String(c),i=Math.abs(b.dy)*c*a.width,j=Math.abs(b.dx)*c*a.height,e=a.x+g+i,f=a.y+h+j,k.push({parentId:a.id,renderableType:"anchor",side:b.side,dx:b.dx,dy:b.dy,id:d,position:c,x:e,y:f})})}),k}return{toPvjson:a,getAllFromNode:b}}(),pathvisiojs.formatConverter.gpml.interaction={gpmlArrowHeadsToSemanticMappings:{Arrow:"Activity",ArrowArrow:"BidirectionalActivity",TBar:"InhibitoryActivity","mim-catalysis":"Catalysis","mim-inhibition":"Inhibition","mim-branching-left":"mim-branching-left","mim-branching-right":"mim-branching-right","mim-necessary-stimulation":"NecessaryStimulation","mim-binding":"Binding","mim-conversion":"Conversion","mim-stimulation":"Stimulation","mim-modification":"Modification","mim-cleavage":"Cleavage","mim-covalent-bond":"CovalentBond","mim-transcription-translation":"TranscriptionTranslation","mim-gap":"Gap",Line:"Unspecified"},getGpmlArrowHeadNameFromSemanticName:function(a){for(var b in this.gpmlArrowHeadsToSemanticMappings)if(this.gpmlArrowHeadsToSemanticMappings[b]===a)return b;return b||(b=a,console.warn('No GPML ArrowHead name found for semantic name "'+a+'". Returning original semantic name as GPML ArrowHead name. PathVisio-Java will delete this ArrowHead from the GPML file if it edits this file.')),b},getSemanticNameFromGpmlArrowHeadName:function(a){var b;return a?(b=this.gpmlArrowHeadsToSemanticMappings[a],b||(b=a,console.warn('No semantic name found for GPML ArrowHead name "'+a+'". Returning original GPML ArrowHead name as semantic name.'))):b="Unspecified",b},toPvjson:function(a,b,c){var d,e=(this.model,{});e.networkType="edge",e.gpmlType="Interaction",pathvisiojs.formatConverter.gpml.element.toPvjson(a,b,e,function(e){pathvisiojs.formatConverter.gpml.graphics.toPvjson(a,b,e,function(e){pathvisiojs.formatConverter.gpml.point.toPvjson(a,b,e,function(e){pathvisiojs.formatConverter.gpml.anchor.toPvjson(a,b,e,function(a){d=[e].concat(a),c(d)})})})})}},pathvisiojs.formatConverter.gpml.graphicalLine=function(){"use strict";function a(a,b,c){var d,e={};e.networkType="edge",pathvisiojs.formatConverter.gpml.element.toPvjson(a,b,e,function(e){pathvisiojs.formatConverter.gpml.graphics.toPvjson(a,b,e,function(e){pathvisiojs.formatConverter.gpml.point.toPvjson(a,b,e,function(e){pathvisiojs.formatConverter.gpml.anchor.toPvjson(a,b,e,function(a){d=[e].concat(a),c(d)})})})})}return{toPvjson:a}}(),pathvisiojs.formatConverter.gpml.point=function(){"use strict";function a(a,c,d,e){var f,g,h,i,k,l,m,n,o=[];c.selectAll("Point").each(function(b,c){f=this,g=d3.select(this),h={};for(var e,i,p,q,r=["GraphRef","RelX","RelY","X","Y"],s={X:function(a){return k=parseFloat(a),h.x=k,k},Y:function(a){return l=parseFloat(a),h.y=l,l},RelX:function(b){var c=(b.toString(),parseFloat(b));h.RelX=c;var d=j(c,"RelX",a,n);return h.anchor=h.anchor||[],h.anchor[0]=d.position,h.anchor[2]=d.orientation,d.offset&&(h.anchor[4]=d.offset),h.anchor[2]=d.orientation,c},RelY:function(b){var c=(b.toString(),parseFloat(b));h.RelY=c;var d=j(c,"RelY",a,n);return h.anchor=h.anchor||[],h.anchor[1]=d.position,h.anchor[3]=d.orientation,d.offset&&(h.anchor[5]=d.offset),c},GraphRef:function(a){return n=a,h.isAttachedTo=a,a},ArrowHead:function(a){return m=strcase.camelCase(a),0===c?d.markerStart=m:d.markerEnd=m,m}},t=[],u=0;u<f.attributes.length;u++)e=f.attributes[u],i=e.name,p={name:i,value:e.value,dependencyOrder:r.indexOf(i)},t.push(p);t.sort(function(a,b){return a.dependencyOrder-b.dependencyOrder}),t.forEach(function(a){q=a.name,s.hasOwnProperty(q)?s[q](a.value):(console.warn('Pathvisiojs has no handler for attribute "'+q+'"'),q=strcase.camelCase(q),d[q]=a.value)}),o.push(h)});var p=c.select("Graphics").attr("ConnectorType");"Straight"===p?(o.length<2&&console.warn("Too many points for a straight line!"),i=o):"Segmented"===p?i=o:"Elbow"===p?i=b(o):"Curved"===p?i=b(o):console.warn("Unknown connector type: "+p),d.points=i,e(d)}function b(a){2==a.length&&(a=c(a));var b=[];b[0]=a[0];var d,e=h(a[0]);for(d=1;d<a.length;d++){var f=a[d].y-a[d-1].y,g=a[d].x-a[d-1].x;b[d]=1==e?{x:a[d-1].x,y:a[d-1].y+f}:{x:a[d-1].x+g,y:a[d-1].y},e=(e+1)%2}return b[a.length]=a[a.length-1],b}function c(a){var b=e(a),c=20,f=a[0],g=a[1],j=[];return j[0]=f,0===b||(1==b?j[1]=d(f,g,h(f),i(g)):2==b?(j[1]=d(f,{x:g.x+c*i(g),y:g.y+c*i(g)},h(f),i(f)),j[2]=d(g,j[1],h(g),i(g))):3==b?(j[2]={x:f.x+(g.x-f.x)/2,y:f.y+(g.y-f.y)/2},j[1]=d(f,j[2],h(f),i(f)),j[3]=d(g,j[2],h(g),i(g))):console.log("Too many waypoint estimated!!!")),j[b+1]=g,j}function d(a,b,c,d){var e=20,f=0,g=0;return 1===c?(f=a.x+(b.x-a.x)/2,g=a.y+e*d):(f=a.x+e*d,g=a.y+(b.y-a.y)/2),{x:f,y:g}}function e(a){var b=a[0],c=a[1],d=f(c.x-b.x)>0,e=d?b:c,h=d?c:b,i=f(e.y-h.y)<0,j=i?1:0,k=g(d?b:c),l=g(d?c:b),m=[[[1,1],[2,2],[1,3],[0,2]],[[2,0],[1,1],[0,2],[1,1]],[[3,1],[2,2],[1,1],[2,0]],[[2,2],[3,3],[2,2],[1,1]]];return m[k][l][j]}function f(a){return a?0>a?-1:1:0}function g(a){return Math.abs(a.RelX)>Math.abs(a.RelY)?a.RelX>0?1:3:a.RelY>0?2:0}function h(a){return Math.abs(a.RelX)>Math.abs(a.RelY)?0:1}function i(a){return Math.abs(a.RelX)>Math.abs(a.RelY)?a.RelX>0?1:-1:a.RelY>0?1:-1}var j=function(a,b,c,d){var e,f,g,h={},i=(a+1)/2;return 0>i||i>1?(f=d3.select(c).select("*[GraphId="+d+"]"),g=f.attr("RelX"===b?"Width":"Height"),0>i?(e=0,h.offset=i*g):(e=1,h.offset=(i-1)*g)):e=i,h.orientation=0===e?-1:1===e?1:0,h.position=e,h};return{toPvjson:a}}(),pathvisiojs.renderer=function(){"use strict";function a(a){var b=("id-"+a).replace(/[^A-Za-z0-9-]/g,"").toLowerCase();return b}function b(a,b,c,d,e){var f=Math.min(b/d,c/e),g=f*d,h=f*e,i=b/2-g/2+10,j=c/2-h/2+20,k="matrix("+f+", 0, 0, "+f+", "+i+", "+j+") ";a.attr("transform",k)}function c(a){var b,c,e,f=d(),h=0;do b=a[h],c=g[b.fileType],e=pathvisiojs.utilities.intersect(c,f),h+=1;while(e.length<1&&h<a.length+1);return b.selectedViewMethod=e[0],b}function d(){var a=["img"];return Modernizr.inlinesvg&&9!==pathvisiojs.utilities.isIE()&&a.push("svg"),a}function e(a,b){a.html(pathvisioNS["src/pathvisiojs.html"]);var c=a.select("#pathvisiojs-container");console.log("pathvisiojsContainer"),console.log(c);var d=c[0][0].getBoundingClientRect();console.log("containerBoundingClientRect"),console.log(d.width),c.style("width",d.width+"px");var e=a.select("#diagram-container").style("height",d.height+"px");console.log("diagramContainer[0][0]"),console.log(e[0][0]),b(e,d)}function f(d,f){{var g,i,j,k,l,m,n,o=d.container,p=d.sourceData,q=d.fitToContainer,r=d.cssUri,s=(d.customMarkers,d.highlights);d.hiddenElements}f=function(){throw new Error("No valid source data specified.")};var t=!1;if(p&&p.length>0&&p[0].uri&&(t=!0,f=pathvisiojs.renderer.load),!t)throw new Error("No valid source data specified.");if(!o)throw new Error("No container selector specified as container for pathvisiojs.");if(k=d3.select(o),1!==k.length)throw new Error("Container selector must be matched by exactly one element.");async.waterfall([function(a){e(k,function(b,c){l=b,a(null,c)})},function(a,b){{var d=pathvisiojs.config.diagramLoadingIconUri;l.append("img").attr("id","loading-icon").attr("src",d).attr("width",30)}m=c(p);var e=a.width-3,f=a.height-3;b(null,e,f,m)},function(c,e,m,o){if(g=c,i=e,h[m.fileType].imageGeneratedDynamically){var p;async.waterfall([function(b){pathvisiojs.formatConverter.pvjson.get(m,function(c){if(c.success){n=a(m.uri),p=c.data,self.mypvjson=p;var e=Object.create(crossPlatformShapes);e.init({targetSelector:"#diagram-container",id:n,format:m.selectedViewMethod,width:g,height:i,backgroundColor:"white",customShapes:{golgiApparatus:{href:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PgoKPHN2ZyBpZD0iZ29sZ2ktYXBwYXJhdHVzIgoJdmVyc2lvbj0iMS4xIgoJYmFzZVByb2ZpbGU9ImZ1bGwiCgl4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCgl4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIKCXhtbG5zOmV2PSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL3htbC1ldmVudHMiCgl3aWR0aD0iOTAiCgloZWlnaHQ9IjE1MCIKCXZpZXdCb3g9IjAgMCA5MCAxNTAiCglwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIgoJc3R5bGU9ImZpbGw6dHJhbnNwYXJlbnQ7IHN0cm9rZTpsaWdodGdyYXk7IHN0cm9rZS13aWR0aDozIj4KCgoJLyo8Y2xpcFBhdGggaWQ9ImdvbGdpLWFwcGFyYXR1cy1jbGlwLXBhdGgxIj4KCTxwYXRoIGQ9Im01OC40NjcxNCwyNy43MTMzMjdjLTIyLjIwNTM0NSwtMjkuOTAwNzkgMzcuMzEwMDY2LC0zMC4yNTgzNTYgMjUuNTY3MjQ1LC00LjgyMzQ0NmMtOC44MDc2NTUsMTguNTgxMjM4IC0xNy4wNjY0MjksNTguMTM1MjM1IC0wLjk0MTY3Myw5OS4yMjA0NGMxMy4zMTQ2OSwyNy4wNjY2OTYgLTQxLjc0ODQ2MywyNy43NjA5MjUgLTI3Ljc1NTU1NCwtMS40Njk4NDljMTEuMzQ1ODI1LC0yOS40MjAyNDIgMTAuMjg2ODU4LC04MC4zMzY0MjIgMy4xMjk5ODIsLTkyLjkyNzE0NXoiIC8+CiAgIAk8L2NsaXBQYXRoPiAKCQoJPGNsaXBQYXRoIGlkPSJnb2xnaS1hcHBhcmF0dXMtY2xpcC1wYXRoMiI+CiAgIAk8cGF0aCBkPSJtMzEuMjE0MzcxLDM2LjIxNDM2M2MtMTAuNzkxNzEyLC0yMS40Mjc5MDMgMjkuODk3NTk4LC0xOS44NDgxNjQgMTguNDA3NTAxLDAuNjcwODk1Yy00LjA2NjkzMyw3LjQyMjM4NiAtNS43ODI4MDMsNjEuNTcyODAzIDEuMTYwNzEzLDc1LjAyODgwNWM4LjUyOTQzLDE4LjU5NzQyNyAtMzIuODUyOTg1LDE5LjM1NTQwOCAtMjAuNTAwMTYyLC0yLjI1MDYzM2M2Ljk1Mjc2MSwtMTcuMzU4NjA0IDEwLjQ3Mzc0MiwtNTIuMjkxMTg3IDAuOTMxOTQ4LC03My40NDkwNjZ6IiAvPgoJPC9jbGlwUGF0aD4gCgkKCTxjbGlwUGF0aCBpZD0iZ29sZ2ktYXBwYXJhdHVzLWNsaXAtcGF0aDMiPgogICAJPHBhdGggZD0ibTI5LjgwMzk1OSw1Mi4xNjA5MTJjMS41ODQxNzcsMTEuNDc0NzE2IDIuNzIzNDYxLDE2LjczNzI2NyAtMS40ODI5NzcsMzguMzYxMzY2Yy0zLjczMTk1NiwxMi45ODkwMDYgLTMuNjAwMzk5LDE2LjM0MDY5MSAtMTEuNzMyMzM0LDE5LjQxMjc4MWMtNi42ODMyOTgsMS42NTg1MzEgLTExLjg2NDgzMiwtOS43ODk0MzYgLTQuNzkzMjk5LC0xNi4xMTM3N2M0Ljg1NTcyOCwtNS42MjMyMjIgNi4xNDEwODcsLTEwLjg4MjM2MiA2LjY1ODg4OCwtMjIuOTU0NjU5Yy0wLjIzOTIxMiwtOS41MjE0MjcgMC44MTQ1MDgsLTE1LjgyMzgyNiAtNS4zNjY5MiwtMTkuOTU4NjI2Yy03LjYyNDMxNSwtMi4xOTUxNzEgLTYuMDg4MDQxLC0xNi41MzQ2MTEgNC44MjQwNTksLTEzLjg2MzgwNGM1Ljg0OTM1NCwxLjAyNzA2NSAxMC4yODI0MDgsOC41NjE1MTYgMTEuODkyNTgyLDE1LjExNjcxMXoiIC8+Cgk8L2NsaXBQYXRoPiovIAoJCgk8cGF0aCBkPSJtNTguNDY3MTQsMjcuNzEzMzI3Yy0yMi4yMDUzNDUsLTI5LjkwMDc5IDM3LjMxMDA2NiwtMzAuMjU4MzU2IDI1LjU2NzI0NSwtNC44MjM0NDZjLTguODA3NjU1LDE4LjU4MTIzOCAtMTcuMDY2NDI5LDU4LjEzNTIzNSAtMC45NDE2NzMsOTkuMjIwNDRjMTMuMzE0NjksMjcuMDY2Njk2IC00MS43NDg0NjMsMjcuNzYwOTI1IC0yNy43NTU1NTQsLTEuNDY5ODQ5YzExLjM0NTgyNSwtMjkuNDIwMjQyIDEwLjI4Njg1OCwtODAuMzM2NDIyIDMuMTI5OTgyLC05Mi45MjcxNDV6IiAvPgogICAJPHBhdGggZD0ibTMxLjIxNDM3MSwzNi4yMTQzNjNjLTEwLjc5MTcxMiwtMjEuNDI3OTAzIDI5Ljg5NzU5OCwtMTkuODQ4MTY0IDE4LjQwNzUwMSwwLjY3MDg5NWMtNC4wNjY5MzMsNy40MjIzODYgLTUuNzgyODAzLDYxLjU3MjgwMyAxLjE2MDcxMyw3NS4wMjg4MDVjOC41Mjk0MywxOC41OTc0MjcgLTMyLjg1Mjk4NSwxOS4zNTU0MDggLTIwLjUwMDE2MiwtMi4yNTA2MzNjNi45NTI3NjEsLTE3LjM1ODYwNCAxMC40NzM3NDIsLTUyLjI5MTE4NyAwLjkzMTk0OCwtNzMuNDQ5MDY2eiIgIC8+CiAgIAk8cGF0aCBkPSJtMjkuODAzOTU5LDUyLjE2MDkxMmMxLjU4NDE3NywxMS40NzQ3MTYgMi43MjM0NjEsMTYuNzM3MjY3IC0xLjQ4Mjk3NywzOC4zNjEzNjZjLTMuNzMxOTU2LDEyLjk4OTAwNiAtMy42MDAzOTksMTYuMzQwNjkxIC0xMS43MzIzMzQsMTkuNDEyNzgxYy02LjY4MzI5OCwxLjY1ODUzMSAtMTEuODY0ODMyLC05Ljc4OTQzNiAtNC43OTMyOTksLTE2LjExMzc3YzQuODU1NzI4LC01LjYyMzIyMiA2LjE0MTA4NywtMTAuODgyMzYyIDYuNjU4ODg4LC0yMi45NTQ2NTljLTAuMjM5MjEyLC05LjUyMTQyNyAwLjgxNDUwOCwtMTUuODIzODI2IC01LjM2NjkyLC0xOS45NTg2MjZjLTcuNjI0MzE1LC0yLjE5NTE3MSAtNi4wODgwNDEsLTE2LjUzNDYxMSA0LjgyNDA1OSwtMTMuODYzODA0YzUuODQ5MzU0LDEuMDI3MDY1IDEwLjI4MjQwOCw4LjU2MTUxNiAxMS44OTI1ODIsMTUuMTE2NzExeiIvPgoKPC9zdmc+Cg=="},sarcoplasmicReticulum:{href:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PgoKPHN2ZyBpZD0ic2FyY29wbGFzbWljLXJldGljdWx1bSIKCXZlcnNpb249IjEuMSIKCWJhc2VQcm9maWxlPSJmdWxsIgoJeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgoJeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiCgl4bWxuczpldj0iaHR0cDovL3d3dy53My5vcmcvMjAwMS94bWwtZXZlbnRzIgoJd2lkdGg9IjEwMCIKCWhlaWdodD0iMTAwIgoJdmlld0JveD0iMCAwIDgwIDEwMCIKCXByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiCglzdHlsZT0iZmlsbDp0cmFuc3BhcmVudDsgc3Ryb2tlOmxpZ2h0Z3JheTsgc3Ryb2tlLXdpZHRoOjMiPgoKCTxjbGlwUGF0aCBpZD0ic2FyY29wbGFzbWljLXJldGljdWx1bS1jbGlwLXBhdGgiPgoJCTxwYXRoIGQ9Im00Ni42MDE4MiwxLjQwNzI0Yy0zMi4zNzIyNCwxLjM0MTM4IC0zNi4zMjAwNCwyMi43NzAxMSAtMjYuNTAzMTgsMzguMTI3NzdjOS4zMTgyNiwxOC4zNDI1IC0xOC43NjU2LDMwLjE1MDE2IDIuNTY5NTUsNDkuMzc4MDdjMTYuODIxMjYsMTMuMTE1OTQgNDYuMzMxNzUsNi4xMDUwOCA1Mi4xMjYzOCwtOC41NjgyNmM1Ljg5OTE2LC0xNS4yNDg0NyAtMTAuOTUwOTksLTI2LjAyNzIgLTMuMjkzMTYsLTQwLjk2MTM1YzEwLjg1MzQyLC0xOS44ODQzMiAtMC43NzYxNSwtMzguMTMwNDMgLTI0Ljg5OTU5LC0zNy45NzYyNHoiIC8+CQoJPC9jbGlwUGF0aD4KCQoJPHBhdGggZD0ibTQ2LjYwMTgyLDEuNDA3MjRjLTMyLjM3MjI0LDEuMzQxMzggLTM2LjMyMDA0LDIyLjc3MDExIC0yNi41MDMxOCwzOC4xMjc3N2M5LjMxODI2LDE4LjM0MjUgLTE4Ljc2NTYsMzAuMTUwMTYgMi41Njk1NSw0OS4zNzgwN2MxNi44MjEyNiwxMy4xMTU5NCA0Ni4zMzE3NSw2LjEwNTA4IDUyLjEyNjM4LC04LjU2ODI2YzUuODk5MTYsLTE1LjI0ODQ3IC0xMC45NTA5OSwtMjYuMDI3MiAtMy4yOTMxNiwtNDAuOTYxMzVjMTAuODUzNDIsLTE5Ljg4NDMyIC0wLjc3NjE1LC0zOC4xMzA0MyAtMjQuODk5NTksLTM3Ljk3NjI0eiIgc3R5bGU9ImNsaXAtcGF0aDogdXJsKCNzYXJjb3BsYXNtaWMtcmV0aWN1bHVtLWNsaXAtcGF0aCk7ICIgLz4JCgo8L3N2Zz4K"},endoplasmicReticulum:{href:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PgoKPHN2ZyBpZD0iZW5kb3BsYXNtaWMtcmV0aWN1bHVtIgoJdmVyc2lvbj0iMS4xIgoJYmFzZVByb2ZpbGU9ImZ1bGwiCgl4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCgl4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIKCXhtbG5zOmV2PSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL3htbC1ldmVudHMiCgl3aWR0aD0iMTAwIgoJaGVpZ2h0PSIxMDAiCgl2aWV3Qm94PSIwIDAgMTAwIDEwMCIKCXByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiCglzdHlsZT0iZmlsbDp0cmFuc3BhcmVudDsgc3Ryb2tlOmxpZ2h0Z3JheTsgc3Ryb2tlLXdpZHRoOjMiPgoKCTxjbGlwUGF0aCBpZD0iZW5kb3BsYXNtaWMtcmV0aWN1bHVtLWNsaXAtcGF0aCI+CgkJPHBhdGggZD0ibTczLjUyNzU2LDU2LjYwOTY3Yy01LjYyNDU3LC0xOC42MDY3NSAyMy41MTQ2MywtMzIuNDMzNTggMjMuNDAxNzMsLTQ1LjA2NjA0Yy0wLjM0NDI2LC00Ljg2MTAyIC0xMC40ODkzNCwtOC44OTc0MyAtMTguMjg5NzQsLTUuMzMzOTVjLTE3LjA0MTE5LDcuODc1NTYgLTE1LjY0OTQ5LDI5LjMwNTAzIC0yMS4yMDUzMyw0Mi4yMzM4N2MtMC4zNTY2MSwzLjYwOTUxIC03LjM2Mjc0LDIuNDY5MjYgLTcuNzQ5NjQsLTAuNDg2OTRjLTUuODUxMiwtMTEuMzg4NzEgMTcuMTM1MzQsLTI0LjQ4NjkyIDUuOTYwNzUsLTI5LjQyNTg2Yy0xOS42MzQ2NywtOC4xNjk3OSAtMjguNzUxODQsMjEuMTUzNDYgLTIyLjA2ODIsMjguODE3ODRjNy40OTU2LDE0LjE3NjAyIC0yLjE3OTQ5LDI0LjQwNjc5IC02Ljc0Njg5LDE1LjQ5NjM3Yy0yLjQ0MjA5LC01LjMwNjEzIDYuMDY2MDUsLTExLjA4NDQ1IC0wLjgwMzUxLC0xNi4xNzY4OWMtNC4zMTk5MSwtMi43OTk5MyAtMTEuNzU1NTUsLTAuNjQ2MTggLTE2LjE1NDY4LDMuMDk0M2MtMTIuODkxMTcsMTAuNzM3OTkgNC43Mjk1Nyw0MC45ODE0NSAyMC45NjQ2NywzNi4xNDYzNWM0LjY5ODMzLC0xLjk1OTg5IC0zLjIzNjAzLC04LjcwMTUxIDMuOTA3MTcsLTkuNTk5NTFjNy4yOTc2NywtMC44MTI1NSA1LjE3NjI4LDYuMTg4ODkgNy42ODc0NSw5LjIyNjkxYzIuMzA3MSw0LjA1MDkgNC44MzIzMiw4LjM1NTM4IDEwLjc2MjYsMTEuNjIzN2M0Ljc4NjQyLDIuNTM3MjQgMTUuMjk0MzcsMi4xMTIyNSAxNi43NzE0OCwtMS45NTc5NWMyLjAzMTgsLTkuMjYyOTEgLTI2LjExMTI5LC0yOC4zNTg0OCAtMTAuNjg5MDMsLTMxLjI4MTVjMTguNTU1MjQsLTIuNzE0NzMgNC43NDg2NiwyMy44NDU3MyAyNC4zMTAwNiwyOS42OTQxOWM5LjUwMTg4LDIuMDI4MjQgMTUuNjM5MDIsLTAuNjIxOTQgMTQuODEyNTUsLTQuMDMyNzJjLTIuNzQ1ODYsLTExLjI2MzI3IC0yNS4xMzU1NywtMjIuNjgwMiAtMjQuOTY0NDEsLTMzLjE0OTY4IiAvPgoJPC9jbGlwUGF0aD4KCQoJPHBhdGggZD0ibTczLjUyNzU2LDU2LjYwOTY3Yy01LjYyNDU3LC0xOC42MDY3NSAyMy41MTQ2MywtMzIuNDMzNTggMjMuNDAxNzMsLTQ1LjA2NjA0Yy0wLjM0NDI2LC00Ljg2MTAyIC0xMC40ODkzNCwtOC44OTc0MyAtMTguMjg5NzQsLTUuMzMzOTVjLTE3LjA0MTE5LDcuODc1NTYgLTE1LjY0OTQ5LDI5LjMwNTAzIC0yMS4yMDUzMyw0Mi4yMzM4N2MtMC4zNTY2MSwzLjYwOTUxIC03LjM2Mjc0LDIuNDY5MjYgLTcuNzQ5NjQsLTAuNDg2OTRjLTUuODUxMiwtMTEuMzg4NzEgMTcuMTM1MzQsLTI0LjQ4NjkyIDUuOTYwNzUsLTI5LjQyNTg2Yy0xOS42MzQ2NywtOC4xNjk3OSAtMjguNzUxODQsMjEuMTUzNDYgLTIyLjA2ODIsMjguODE3ODRjNy40OTU2LDE0LjE3NjAyIC0yLjE3OTQ5LDI0LjQwNjc5IC02Ljc0Njg5LDE1LjQ5NjM3Yy0yLjQ0MjA5LC01LjMwNjEzIDYuMDY2MDUsLTExLjA4NDQ1IC0wLjgwMzUxLC0xNi4xNzY4OWMtNC4zMTk5MSwtMi43OTk5MyAtMTEuNzU1NTUsLTAuNjQ2MTggLTE2LjE1NDY4LDMuMDk0M2MtMTIuODkxMTcsMTAuNzM3OTkgNC43Mjk1Nyw0MC45ODE0NSAyMC45NjQ2NywzNi4xNDYzNWM0LjY5ODMzLC0xLjk1OTg5IC0zLjIzNjAzLC04LjcwMTUxIDMuOTA3MTcsLTkuNTk5NTFjNy4yOTc2NywtMC44MTI1NSA1LjE3NjI4LDYuMTg4ODkgNy42ODc0NSw5LjIyNjkxYzIuMzA3MSw0LjA1MDkgNC44MzIzMiw4LjM1NTM4IDEwLjc2MjYsMTEuNjIzN2M0Ljc4NjQyLDIuNTM3MjQgMTUuMjk0MzcsMi4xMTIyNSAxNi43NzE0OCwtMS45NTc5NWMyLjAzMTgsLTkuMjYyOTEgLTI2LjExMTI5LC0yOC4zNTg0OCAtMTAuNjg5MDMsLTMxLjI4MTVjMTguNTU1MjQsLTIuNzE0NzMgNC43NDg2NiwyMy44NDU3MyAyNC4zMTAwNiwyOS42OTQxOWM5LjUwMTg4LDIuMDI4MjQgMTUuNjM5MDIsLTAuNjIxOTQgMTQuODEyNTUsLTQuMDMyNzJjLTIuNzQ1ODYsLTExLjI2MzI3IC0yNS4xMzU1NywtMjIuNjgwMiAtMjQuOTY0NDEsLTMzLjE0OTY4IiBzdHlsZT0iY2xpcC1wYXRoOiB1cmwoI2VuZG9wbGFzbWljLXJldGljdWx1bS1jbGlwLXBhdGgpOyAiLz4KPC9zdmc+Cg=="},mitochondria:{href:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PgoKPHN2ZyBpZD0ibWl0b2Nob25kcmlhIgoJdmVyc2lvbj0iMS4xIgoJYmFzZVByb2ZpbGU9ImZ1bGwiCgl4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCgl4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIKCXhtbG5zOmV2PSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL3htbC1ldmVudHMiCgl3aWR0aD0iMTAwIgoJaGVpZ2h0PSIxMDAiCgl2aWV3Qm94PSIwIDAgMTAwIDEwMCIKCXByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiCglzdHlsZT0iZmlsbDp0cmFuc3BhcmVudDsgc3Ryb2tlOmxpZ2h0Z3JheTsgc3Ryb2tlLXdpZHRoOjMiPgoKICAgICAgICA8Y2xpcFBhdGggaWQ9Im1pdG9jaG9uZHJpYS1vdmFsLWNsaXAtcGF0aCI+CgkJPGVsbGlwc2UgY3g9IjUwIiBjeT0iNTAiIHJ4PSI1MCIgcnk9IjUwIiA+PC9lbGxpcHNlPgogICAgICAgIDwvY2xpcFBhdGg+Cgk8Y2xpcFBhdGggaWQ9Im1pdG9jaG9uZHJpYS1jbGlwLXBhdGgiPgoJCTxwYXRoIGQ9Im0xNC44OTQ4OTksMjYuMzQ3MzU3YzQuMzYzODE3LC0wLjc0MTU3MSAzLjgyNzUxOCwxNy4wMzYxNjkgOC4xODI2MzgsMTYuMTgzODI1YzguMjczNDcsMC4wMzA3NjIgMi45ODIwMDYsLTI4LjE0ODk5MSA5Ljg5OTc1NCwtMjguMzM2Njg3YzYuOTY3OTk1LC0wLjE4NzcwNCAyLjI0NjY1MSwyOS45NDc1MjcgOS4yMDQ5ODMsMjkuNDM5ODFjNy42MzI4MTMsLTAuNTYwMDI0IDAuNTA3MzA5LC0zMi45MzUzNTcgOC4xMzYyNTMsLTMzLjYyMzA4MmM3LjY5ODUyMSwtMC42ODkyNTkgMi45MTkxOTcsMzIuMDM5OTQxIDEwLjYyODM0OSwzMi4yMjQ1NTdjNi41NDY2ODQsMC4xNjAwMTEgMy4wMjY0NTEsLTI3LjY0MjgwOCA5LjU2MDU3LC0yNi45MjEyMzJjNy4xOTIxNzcsMC43OTM4OCAwLjY2NDgxOCwyOS44NDI5MDUgNy43ODE2MjQsMzEuNjY3NjA0YzQuNzQ4NDA1LDEuMjE1NDM5IDQuNDIwODIyLC0xOC4yNTc3NTcgOS4yMDQwMTgsLTE3LjQ0MDgwNGMxMS4xMjg4ODMsNy41NzcyNzggOC42MjgxMDUsMzcuNjk4NjU4IC0yLjE3OTk3Nyw0NC42NDUxMzhjLTMuMTM4NTQyLDAuNjk4NDc5IC0zLjk2NTY5OCwtMTAuNTAyMDI5IC03LjExMjkzOCwtOS45MDUwNzVjLTUuNTkwMDUsMS4wNTg1MDIgLTMuOTgyMTI0LDIyLjI4NDA4OCAtOS42MDMwOTYsMjEuNzk5NDYxYy01LjIzOTI4MSwtMC40NTY5NDcgLTIuMjI2MzY0LC0yMS42MzYzODMgLTcuNDcwNDcsLTIxLjczMDIzMmMtNi45NjEyMzUsLTAuMTE2OTI4IC0zLjM1Nzg5NSwyOC45MjQ0MDggLTEwLjMxNjIzMSwyOC40OTUxNDhjLTYuMTQwODQ2LC0wLjM3NTM5NyAtMS43MzA2NCwtMjQuOTUwMzYzIC03LjgyNTEwNCwtMjYuMTkxOTYzYy01LjY4MTg0NywtMS4xNTY5ODIgLTUuMzc4NDI5LDIyLjE3MDI0MiAtMTEuMDI3NDI2LDIwLjY4MDkzOWMtNi4yNDkwNjksLTEuNjQ0Njg0IC0wLjQ2OTYyNCwtMjYuNjczNTE5IC02Ljc1OTI3NSwtMjcuODY1ODg3Yy0zLjcyODk1NCwtMC43MDYxODggLTIuNjQ3NjY1LDE0LjQwMDY1NCAtNi40MDM2NzcsMTQuNTQ1MjkyYy0xNC4wMTYxOTgsLTUuOTM4NzM2IC0xNS43NDg3NzYsLTM5LjcwNzk4MSAtMy44OTk5OTQsLTQ3LjY2NjgxMXoiPjwvcGF0aD4KCTwvY2xpcFBhdGg+IAoJCgk8ZWxsaXBzZSBjeD0iNTAiIGN5PSI1MCIgcng9IjUwIiByeT0iNTAiIHN0eWxlPSJjbGlwLXBhdGg6IHVybCgjbWl0b2Nob25kcmlhLW92YWwtY2xpcC1wYXRoKTsgIj48L2VsbGlwc2U+Cgk8cGF0aCBkPSJtMTQuODk0ODk5LDI2LjM0NzM1N2M0LjM2MzgxNywtMC43NDE1NzEgMy44Mjc1MTgsMTcuMDM2MTY5IDguMTgyNjM4LDE2LjE4MzgyNWM4LjI3MzQ3LDAuMDMwNzYyIDIuOTgyMDA2LC0yOC4xNDg5OTEgOS44OTk3NTQsLTI4LjMzNjY4N2M2Ljk2Nzk5NSwtMC4xODc3MDQgMi4yNDY2NTEsMjkuOTQ3NTI3IDkuMjA0OTgzLDI5LjQzOTgxYzcuNjMyODEzLC0wLjU2MDAyNCAwLjUwNzMwOSwtMzIuOTM1MzU3IDguMTM2MjUzLC0zMy42MjMwODJjNy42OTg1MjEsLTAuNjg5MjU5IDIuOTE5MTk3LDMyLjAzOTk0MSAxMC42MjgzNDksMzIuMjI0NTU3YzYuNTQ2Njg0LDAuMTYwMDExIDMuMDI2NDUxLC0yNy42NDI4MDggOS41NjA1NywtMjYuOTIxMjMyYzcuMTkyMTc3LDAuNzkzODggMC42NjQ4MTgsMjkuODQyOTA1IDcuNzgxNjI0LDMxLjY2NzYwNGM0Ljc0ODQwNSwxLjIxNTQzOSA0LjQyMDgyMiwtMTguMjU3NzU3IDkuMjA0MDE4LC0xNy40NDA4MDRjMTEuMTI4ODgzLDcuNTc3Mjc4IDguNjI4MTA1LDM3LjY5ODY1OCAtMi4xNzk5NzcsNDQuNjQ1MTM4Yy0zLjEzODU0MiwwLjY5ODQ3OSAtMy45NjU2OTgsLTEwLjUwMjAyOSAtNy4xMTI5MzgsLTkuOTA1MDc1Yy01LjU5MDA1LDEuMDU4NTAyIC0zLjk4MjEyNCwyMi4yODQwODggLTkuNjAzMDk2LDIxLjc5OTQ2MWMtNS4yMzkyODEsLTAuNDU2OTQ3IC0yLjIyNjM2NCwtMjEuNjM2MzgzIC03LjQ3MDQ3LC0yMS43MzAyMzJjLTYuOTYxMjM1LC0wLjExNjkyOCAtMy4zNTc4OTUsMjguOTI0NDA4IC0xMC4zMTYyMzEsMjguNDk1MTQ4Yy02LjE0MDg0NiwtMC4zNzUzOTcgLTEuNzMwNjQsLTI0Ljk1MDM2MyAtNy44MjUxMDQsLTI2LjE5MTk2M2MtNS42ODE4NDcsLTEuMTU2OTgyIC01LjM3ODQyOSwyMi4xNzAyNDIgLTExLjAyNzQyNiwyMC42ODA5MzljLTYuMjQ5MDY5LC0xLjY0NDY4NCAtMC40Njk2MjQsLTI2LjY3MzUxOSAtNi43NTkyNzUsLTI3Ljg2NTg4N2MtMy43Mjg5NTQsLTAuNzA2MTg4IC0yLjY0NzY2NSwxNC40MDA2NTQgLTYuNDAzNjc3LDE0LjU0NTI5MmMtMTQuMDE2MTk4LC01LjkzODczNiAtMTUuNzQ4Nzc2LC0zOS43MDc5ODEgLTMuODk5OTk0LC00Ny42NjY4MTF6IiBzdHlsZT0iY2xpcC1wYXRoOiB1cmwoI21pdG9jaG9uZHJpYS1jbGlwLXBhdGgpOyAiPjwvcGF0aD4KPC9zdmc+Cg=="}}},function(a){j=a;var c=Object.create(crossPlatformText);c.init({targetSelector:"#"+n});var d;async.each(p.elements,function(a,b){var f=a;if(f.containerSelector="#viewport",d=strcase.camelCase(a.shape),"none"!==a.shape){if(!e.hasOwnProperty(d)){var g=/double$/gi;d=d.replace(g,""),e.hasOwnProperty(d)?console.warn('Requested path "'+a.shape+'" is not available with linetype of "Double". Using linetype of "Solid" instead'):(console.warn('Requested path "'+a.shape+'" is not available. Using path "rounded-rectangle" instead'),d="roundedRectangle")}e[d](f,function(b){if(a.datasourceReference){var c=d3.select(b).attr("class","has-xref"),d=!0;c.on("mousedown",function(){d=!0}).on("mousemove",function(){d=!1}).on("mouseup",function(){if(d){var b=a.datasourceReference.id,c=a.datasourceReference.database,e=a.datasourceReference.organism;pathvisiojs.renderer.annotation.xRef.render(e,b,c,a.textContent,a.dataNodeType)}})}})}a.textContent&&c.render(f,function(a){d3.select(a).attr("pointer-events","none")}),b(null)},function(){b(null)})})}else{var h=d.sourceData.indexOf(m);d.sourceData.splice(h,1),f(d)}})},function(a){var b=p.elements.filter(function(a){return!!a.publicationXrefs});b.length>0&&b.forEach(function(a){pathvisiojs.renderer.publicationXref.render(j,a)}),a(null)},function(a){var b=d3.select("#"+n);pathvisiojs.renderer.infoBox.render(j,p),a(null,b)},function(a){var c,d,e=a.select("defs");r?d3.text(r,"text/css",function(a){d=e.append("style").attr("type","text/css"),d.text(a)}):(c=pathvisioNS["src/css/pathway-diagram.css"],d=e.append("style").attr("type","text/css"),d.text(c));var f=a.select("#viewport");q&&b(f,g,i,p.image.width,p.image.height),svgPanZoom.init({selector:"#"+n,zoomEnabled:!1,controlIconsEnabled:!0,minZoom:"0.1",maxZoom:"8.0"});var h=!1;a.on("click",function(){svgPanZoom.enableZoom(),h=!0}).on("mouseenter",function(){h&&svgPanZoom.enableZoom()}).on("mouseleave",function(){h&&(svgPanZoom.disableZoom(),h=!1)}),pathvisiojs.renderer.highlighter.load(a,p),o(null,a)}])}else{var t={};t.container=l,t.renderableSourceDataElement=m,t.containerWidth=c,t.containerHeight=e,t.fitToContainer=q,t.highlights=s,k.select("#typeahead").remove(),k.select("#pan-zoom-control").remove(),pathvisiojs.renderer.img.load(t,function(){o(null,null)})}},function(a,b){l.select("#loading-icon").remove(),b(null)}])}var g={gpml:["svg"],biopax:["svg"],pdf:["pdf"],png:["img"],jpg:["img"],jpeg:["img"],jpe:["img"],jif:["img"],jfif:["img"],jfi:["img"],gif:["img"],ico:["img"],bmp:["img"],dib:["img"]},h={gpml:{supportedRendererFormats:["svg"],imageGeneratedDynamically:!0},biopax:{supportedRendererFormats:["svg"],imageGeneratedDynamically:!0},pdf:{supportedRendererFormats:["pdf"],imageGeneratedDynamically:!1},png:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},jpg:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},jpeg:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},jpe:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},jif:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},jfif:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},jfi:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},gif:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},ico:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},bmp:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1},dib:{supportedRendererFormats:["img"],imageGeneratedDynamically:!1}};return{load:f}}(),pathvisiojs.renderer.infoBox=function(){"use strict";function a(a,b){if(!a||!b)return console.warn("Error: Missing input parameters.");var c=[];b.hasOwnProperty("Name")&&c.push({key:"Title",value:b.Name}),b.hasOwnProperty("License")&&c.push({key:"Availability",value:b.License}),b.hasOwnProperty("LastModified")&&c.push({key:"Last modified",value:b.LastModified}),b.hasOwnProperty("Organism")&&c.push({key:"Organism",value:b.Organism});{var d=a.selectAll("g.info-box").data([c]).enter().append("g").attr("id",function(a,b){return"info-box-"+b}).attr("class","text-area info-box"),e=d.selectAll("text").data(function(a){return a}).enter().append("text").attr("id",function(a,b){return"info-box-text"+b}).attr("class","item").attr("x",0).attr("y",function(a,b){return 14+14*b});e.append("tspan").attr("class","info-box-item-property-name").text(function(a){return a.key+": "}),e.append("tspan").attr("class","info-box-item-property-value").text(function(a){return a.value})}}return{render:a}}(),pathvisiojs.renderer.publicationXref={getReferenceNumberForDisplay:function(a){var b,c=this,d=c.model,e=null,f=-1,g=!1;do f+=1,b=d.Biopax.PublicationXref[f],"undefined"!=typeof b&&b.rdfId===a&&(g=!0,e=f+1);while(g===!1&&f<d.Biopax.PublicationXref.length);return e},createPublicationXrefString:function(a){var b;if(1===a.length)b=a[0];else{a.sort(function(a,b){return a-b});var c=0;if(b=a[c].toString(),a.length>2)do c+=1,(a[c-1]+1!==a[c]||a[c]+1!==a[c+1])&&(b+=1!==c&&a[c-2]+2===a[c]?"-"+a[c].toString():", "+a[c].toString());while(c<a.length-2);c+=1,b+=a[c-2]+2===a[c]?"-"+a[c].toString():", "+a[c].toString()}return b},getPublicationXrefString:function(a,b){var c=this,d=(c.model,[]),e="";a=pathvisiojs.utilities.convertToArray(a),a.forEach(function(a){var b=c.getReferenceNumberForDisplay(a);b&&d.push(b)}),d.length>0&&(e=c.createPublicationXrefString(d)),b(e)},render:function(a,b){var c,d,e,f=this;f.getPublicationXrefString(b.publicationXrefs,function(f){var g=f.toString().length;if("node"===b.networkType){var h=b.width,i=h-3*g/2-2;c=b.x+i,d=b.y-4,a.append("text").attr("class","citation").attr("transform",function(){return"translate("+c+" "+d+")"}).text(f)}else{if("edge"!==b.networkType)throw new Error("Pathvisiojs cannot render a citation for targets of this type: "+b.networkType);var j=.5,k=d3.select("#"+b.id)[0][0],l=k.getTotalLength(),m=k.getPointAtLength(j*l),n=-4;c=m.x+n-3*g,d=m.y+n,e=a.append("text").attr("class","citation").attr("transform",function(){return"translate("+c+" "+d+")"}).text(f)}})}},pathvisiojs.renderer.img=function(){"use strict";function a(a,b){if(!a)throw new Error("Missing input data.");var c=a.container,d=parseFloat(a.containerWidth),e=parseFloat(a.containerHeight),f=a.fitToContainer,g=a.renderableSourceDataElement.uri;g||(console.warn("No uri specified for sourceData element."),g=a.renderableSourceDataElement.uri||pathvisiojs.config.diagramNotAvailableIconUri),loadImage(g,function(a){"error"===a.type?(console.warn("Error loading image "+g),loadImage(pathvisiojs.config.diagramNotAvailableIconUri,function(a){c[0][0].appendChild(a),b(null,a)},{maxWidth:d,maxHeight:e})):(c[0][0].appendChild(a),a.setAttribute("style","margin: auto; position: absolute; top: 0; left: 0; bottom: 0; right: 0;"),b(null,a))},{maxWidth:d,maxHeight:e,contain:f})}return{load:a}}(),pathvisiojs.renderer.annotation=function(){"use strict";function a(a){var c=d3.select("#annotation").data([a]),d=d3.behavior.drag().on("drag",function(){var a=parseInt(c.style("right"),10),b=parseInt(c.style("top"),10);a-=d3.event.dx,b+=d3.event.dy,c.style("right",a+"px"),c.style("top",b+"px")}),e=c.select("#annotation-header-text").text(function(a){return a.header}),f=e[0][0].getBoundingClientRect().width,g=22;if(f>190)do g-=1,e.style("font-size",g+"px"),f=e[0][0].getBoundingClientRect().width;while(f>190||7>g);var h=(c.select("#annotation-header-search").select("a").attr("href",function(a){return b+a.header}).attr("title",function(a){return"Search for pathways containing "+a.header}),c.select("i.icon-move").on("mousedown",function(){c.call(d)}).on("mouseup",function(){c.on("mousedown.drag",null)}),c.select("i.icon-remove").on("click",function(){c[0][0].style.visibility="hidden"}),c.select("#annotation-description").text(function(a){return a.description})),i=c.selectAll("#annotation-items-container").data(function(a){return"string"==typeof a.listItems[0]?("gif"==a.listItems[0].split(".").pop()?(h.append("br"),h.append("br"),h.append("img").attr("src",a.listItems[0]).attr("style","width: 20px")):h.append("p").html('<font color="red">'+a.listItems[0]+"</font>"),[{key:"clear",values:[{clear:"clear"}]}]):[a.listItems]}),j=i.selectAll("li").data(function(a){return a});j.enter().append("li"),j.exit().remove();var k=j.selectAll(".annotation-item-title").data(function(a){return[a.key]}).text(function(a){return a+": "});k.enter().append("span").attr("class","annotation-item-title").text(function(a){return a+": "}),k.exit().remove();var l=j.selectAll("span.annotation-item-text").data(function(a){return a.values.filter(function(a){return a.hasOwnProperty("uri")?void 0:a})}).text(function(a){return" "+a.text});l.enter().append("span").attr("class","annotation-item-text").text(function(a){return" "+a.text}),l.exit().remove();var m=j.selectAll("a.annotation-item-text").data(function(a){return a.values.filter(function(a){return a.hasOwnProperty("uri")?a:void 0
})}).attr("href",function(a){return a.uri}).attr("class","annotation-item-text").text(function(a){return" "+a.text});m.enter().append("a").attr("href",function(a){return a.uri}).attr("class","annotation-item-text").text(function(a){return" "+a.text}),m.exit().remove(),c[0][0].style.visibility="visible"}var b="/index.php?title=Special:SearchPathways&doSearch=1&query=";return{render:a,pathwaySearchUriStub:b}}(),pathvisiojs.renderer.annotation.citation=function(){"use strict";function a(){}return{render:a}}(),pathvisiojs.renderer.annotation.xRef=function(){"use strict";function a(a,d,e,f,g){var h=b(a,f,d,e);if(h)pathvisiojs.renderer.annotation.render(h);else{h={header:f,description:g,listItems:[pathvisiojs.config.diagramLoadingIconUri]},pathvisiojs.renderer.annotation.render(h);{pathvisiojs.formatConverter.bridgedb.getXrefAnnotationDataByDataNode(a,d,e,f,g,function(b){c(a,f,d,e,b),pathvisiojs.renderer.annotation.render(b)})}}}function b(a,b,c,e){return d[a+b+c+e]}function c(a,b,c,e,f){d[a+b+c+e]=f}var d={};return{render:a}}(),pathvisiojs.renderer.highlighter={load:function(a,b,c){"use strict";function d(c){if(13===c.keyCode){var d=$("#highlight-by-label-input").val();if(!d)throw new Error("No data node value entered for type-ahead node highlighter.");e.highlightByLabel(a,b,d),$("#highlight-by-label-input").typeahead("setQuery","")}}var e=this;if(!a||!b)throw new Error("Missing input data.");var f,g=[];b.elements.filter(function(a){return"DataNode"===a.gpmlType}).forEach(function(a){a.hasOwnProperty("textContent")&&(f=a.textContent,-1===g.indexOf(f)&&g.push(f))}),$("#highlight-by-label-input").typeahead({name:"Highlight node in pathway",local:g,limit:10}),$("#highlight-by-label-input").bind("typeahead:selected",function(){var c=$("#highlight-by-label-input").val();if(!c)throw new Error("No data node value entered for type-ahead node highlighter.");e.highlightByLabel(a,b,c)}),$("#highlight-by-label-input").bind("keypress",d),d3.select("#clear-highlights-from-typeahead").on("click",function(){e.clearHighlightsFromTypeahead(a)}),c&&c(null,a)},highlight:function(a){"use strict";var b,c,d,e=a.data,f={selectors:function(a){return a},label:function(a){var b=e.elements.filter(function(b){return b.textContent===a}).map(function(a){return"#"+a.id});return b},xref:function(a){var b=e.elements.filter(function(b){return b.datasourceReference.filter(function(b){return a===b.database+b.id})}).map(function(a){return"#"+a.id});return b}},g=d3.map(a).entries(),h=d3.map(f).keys(),i=0;do d=h.indexOf(g[i].key),-1!==d&&(c=h[d],b=f[c](g[i].value)),i+=1;while(!b&&i<g.length);var j,k=a.cssClass||"highlighted-node",l=a.style,m=a.svgId||"pathvisiojs-diagram",n=d3.select("#"+m),o="";l&&(j=d3.map(l).entries(),j.forEach(function(a){o+=strcase.paramCase(a.key)+":"+a.value+"; "})),b.forEach(function(a){{var b=n.select(a),c=b[0][0],d=c.getBBox().x,e=c.getBBox().y,f=c.getBBox().height,g=c.getBBox().width,h=2.5;n.select("#viewport").append("rect").attr("x",d-h).attr("y",e-h).attr("class",k).attr("style",o+" pointer-events: none").attr("width",g+2*h).attr("height",f+2*h)}})},highlightByLabel:function(a,b,c){"use strict";var d=a.attr("id")||"pathvisiojs-diagram";a.selectAll(".highlighted-from-typeahead").remove();var e={};e.data=b,e.svgId=d,e.label=c,e.cssClass="highlighted-node highlighted-from-typeahead",this.highlight(e),d3.select("#clear-highlights-from-typeahead")[0][0].style.visibility="visible"},clearHighlightsFromTypeahead:function(a){"use strict";a.selectAll(".highlighted-from-typeahead").remove();var b=d3.select("#highlight-by-label-input");b[0][0].value="",b.attr("placeholder",""),d3.select("#clear-highlights-from-typeahead")[0][0].style.visibility="hidden"}};